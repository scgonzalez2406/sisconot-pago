*
PROCEDURE errorhandlPARAMETER m.messg, m.code,  ;          m.progr, m.linSET DEVICE TO SCREENDEFINE WINDOW msgerr FROM 10, 02  ;       TO 18, 78 SHADOW TITLE  ;       'MENSAJE DE ERROR ' COLOR  ;       SCHEME 7DO CASE     CASE m.code = 125          ACTIVATE WINDOW msgerr          @ 00, 01 SAY  ;            'Programa: ' +  ;            ALLTRIM(m.progr +  ;            '.PRG')          @ 01, 01 SAY  ;            'Linea del Error : ' +  ;            LTRIM(STR(m.lin))          @ 02, 01 SAY  ;            'Mensaje: ' +  ;            m.messg          @ 03, 01 SAY 'Error : ' +  ;            LTRIM(STR(m.code))          ms = 'Active la Impresora y Pulse una Tecla ¢'          @ 03, 01 SAY  ;            SPACE((WCOLS() -  ;            LEN(ms) - 6) / 2) +  ;            SPACE(3)          @ 03, COL() SAY ms          ms = 'Presione Esc para Cancelar la Impresi¢n'          @ 04, 01 SAY  ;            SPACE((WCOLS() -  ;            LEN(ms) - 6) / 2) +  ;            SPACE(3)          @ 04, COL() SAY ms          SET ESCAPE OFF          WAIT ''          IF LASTKEY() = 27               CLOSE DATABASES               RELEASE WINDOW  ;                       msgerr,  ;                       record1,  ;                       a1, a2, a3,  ;                       _r               RELEASE WINDOW all               RELEASE WINDOW               RELEASE WINDOW               RELEASE WINDOW               RELEASE WINDOW               RELEASE WINDOW               RELEASE WINDOW               RETURN TO MASTER          ENDIF          RELEASE WINDOW msgerr          SET DEVICE TO PRINTER          RETRY     CASE m.code = 108          RETRY     CASE m.code = 1707          RETRY     CASE m.code = 109          RETRY     OTHERWISE          ACTIVATE WINDOW msgerr          @ 00, 01 SAY  ;            'Programa: ' +  ;            ALLTRIM(m.progr +  ;            '.PRG')          @ 01, 01 SAY  ;            'Linea del Error : ' +  ;            LTRIM(STR(m.lin))          @ 02, 01 SAY  ;            'Mensaje: ' +  ;            m.messg          @ 03, 01 SAY 'Error : ' +  ;            LTRIM(STR(m.code))          ms = 'Anote la Operaci¢n y Consulte con (SEGUNDO GONZALEZ)'          @ 04, 01 SAY  ;            SPACE((WCOLS() -  ;            LEN(ms) - 6) / 2) +  ;            SPACE(3)          @ 04, COL() SAY ms          @ 05, 01 SAY  ;            'Telef.: (086)-626602 '          SET ESCAPE OFF          WAIT ''ENDCASERELEASE WINDOW msgerr, record1,  ;        a1, a2, a3, _rRELEASE WINDOWRELEASE WINDOWRELEASE WINDOWRELEASE WINDOWRELEASE WINDOWRELEASE WINDOWto = 0RETURN TO MASTER*FUNCTION stringPARAMETER stristri = stri + ' 'RETURN TRANSFORM(stri, '@R' +  ;       REPLICATE('X ',  ;       LEN(stri)))*FUNCTION stringvPARAMETER striletra1 = 'ABCDEFGHIJKLMN¥OPQRSTUVWXYZ0123456789.-, 'letra2 = 'ÚÂ¿ÄÉË»ÍÕÑ¸ÖÒ·ÃÅ´³ÌÎ¹ºÆØµÇ×¶ÀÁÙÈÊ¼ÔÏ¾ÓÐ½±'stri = ALLTRIM(stri)FOR i = 1 TO LEN(stri)     x = SUBSTR(stri, i, 1)     IF i = 1          stri1 = SUBSTR(letra1,  ;                  AT(x, letra2),  ;                  1)     ELSE          stri1 = stri1 +  ;                  SUBSTR(letra1,  ;                  AT(x, letra2),  ;                  1)     ENDIFENDFORRETURN stri1*FUNCTION stringrPARAMETER striletra2 = 'ABCDEFGHIJKLMN¥OPQRSTUVWXYZ0123456789.-, 'letra1 = 'ÚÂ¿ÄÉË»ÍÕÑ¸ÖÒ·ÃÅ´³ÌÎ¹ºÆØµÇ×¶ÀÁÙÈÊ¼ÔÏ¾ÓÐ½±'stri = ALLTRIM(stri)FOR i = 1 TO LEN(stri)     x = SUBSTR(stri, i, 1)     IF i = 1          stri1 = SUBSTR(letra1,  ;                  AT(x, letra2),  ;                  1)     ELSE          stri1 = stri1 +  ;                  SUBSTR(letra1,  ;                  AT(x, letra2),  ;                  1)     ENDIFENDFORRETURN stri1*FUNCTION helpDEFINE WINDOW xhelp FROM 09, 05  ;       TO 19, 75 SHADOW COLOR  ;       SCHEME 5MOVE WINDOW xhelp CENTERACTIVATE WINDOW xhelpxz1 = ' Sistema Integral de Control Academico de Notas'xz2 = 'Copyright (C) Dise¤o de Sistemas (SISCONOT, C.A) - 1996'xz3 = 'Versi¢n 1.00'xz4 = 'Reservados todos los Derechos'xz5 = 'Licencia Autorizada a ' +  ;      l_nombrexz6 = 'Toda  Utilizaci¢n de  este sistema que no este'xz7 = 'Expresamente autorizada , est  prohibida '@ 00, 0 SAY SPACE(((WCOLS() -  ;  LEN(xz1) - 6) / 2) + 3) + xz1@ 01, 0 SAY SPACE(((WCOLS() -  ;  LEN(xz2) - 6) / 2) + 3) + xz2@ 02, 0 SAY SPACE(((WCOLS() -  ;  LEN(xz3) - 6) / 2) + 3) + xz3@ 03, 0 SAY SPACE(((WCOLS() -  ;  LEN(xz4) - 6) / 2) + 3) + xz4@ 04, 0 SAY SPACE(((WCOLS() -  ;  LEN(xz5) - 6) / 2) + 3) + xz5@ 05, 0 SAY SPACE(((WCOLS() -  ;  LEN(xz6) - 6) / 2) + 3) + xz6@ 06, 0 SAY SPACE(((WCOLS() -  ;  LEN(xz7) - 6) / 2) + 3) + xz7xr = '[   OK   ]'@ 07, 0 TO 07, WCOLS() DOUBLE@ 08, 0 SAY SPACE(((WCOLS() -  ;  LEN(xr) - 6) / 2) + 3)@ 08, COL() GET xr COLOR ,W+/B CLEAR GETSatx = INKEY(10, 'H')RELEASE WINDOW xhelpRETURN .T.*PROCEDURE phelpPARAMETER xpopupSET SYSMENU ON= help()DO CASE     CASE ALLTRIM(UPPER(xpopup)) $  ;          'TABLAS BASICAS'          HELP þ tablas     CASE ALLTRIM(UPPER(xpopup)) $  ;          'AL£MNOS/NOTAS'          HELP þ alumnos     CASE ALLTRIM(UPPER(xpopup)) $  ;          'REPORTES'          HELP þ procesosENDCASESET SYSMENU OFFRETURN*FUNCTION claveDEFINE WINDOW acceso FROM 10, 20  ;       TO 15, 60 SHADOW NONE  ;       COLOR SCHEME 5ACTIVATE WINDOW acceso@ 00, 00 TO WROWS() - 1, WCOLS()xyz = 'Clave de Acceso'lk = SPACE(((WCOLS() - LEN(xyz) -  ;     6) / 2) + 3)@ 01, LEN(lk) SAY xyz@ 02, 00 SAY 'Ã' + REPLICATE('Ä',  ;  WCOLS() - 2) + '´'SET ESCAPE OFFx_swt1 = 0x_con = 0DO WHILE .T.     x_x = 1     x_col = 25     x_clave = SPACE(1)     x_c = 1     pio = 1     DO WHILE x_x<=6          x_tecla = SPACE(1)          @ 03, 03 SAY  ;            'Introduzca la Clave: '          tecla = 0          SET CONSOLE OFF          DO WHILE tecla=0               tecla = INKEY('H')          ENDDO          SET CONSOLE ON          x_tecla = CHR(tecla)          IF LASTKEY() = 27               pio = 2               EXIT          ENDIF          IF LASTKEY() = 13               EXIT          ENDIF          @ 03, x_col SAY '*'          x_clave = x_clave +  ;                    x_tecla          x_x = x_x + 1          x_col = x_col + 1     ENDDO     IF pio = 2          EXIT     ENDIF     x_clave = ALLTRIM(x_clave)     IF UPPER(ALLTRIM(x_clave)) =  ;        'ACTMX'          x_swt1 = 1          EXIT     ELSE          ?? CHR(7)          @ 04, 02 SAY '®® '  ;            COLOR W+/RB*           @ 04, 08 SAY  ;            'Clave de Acceso Denegada'          @ 04, COL() + 4 SAY  ;            ' ¯¯' COLOR W+/RB*           SET CURSOR OFF          WAIT ''          @ 04, 02 SAY  ;            SPACE(WCOLS() - 3)          @ 03, 25 SAY SPACE(8)          x_con = x_con + 1          IF x_con > 3               x_swt1 = 0               EXIT          ELSE               SET CURSOR ON               LOOP          ENDIF     ENDIFENDDOIF pio = 2     x_swt1 = 0ENDIFRELEASE WINDOW accesoRETURN x_swt1*FUNCTION accesoDEFINE WINDOW acceso FROM 10, 20  ;       TO 15, 60 SHADOW NONE  ;       COLOR SCHEME 5ACTIVATE WINDOW acceso@ 00, 00 TO WROWS() - 1, WCOLS()  ;  COLOR GR+/W xyz = 'Clave de Acceso'lk = SPACE(((WCOLS() - LEN(xyz) -  ;     6) / 2) + 3)@ 01, LEN(lk) SAY xyz@ 02, 00 SAY 'Ã' COLOR GR+/W @ 02, COL() SAY REPLICATE('Ä',  ;  WCOLS() - 2)@ 02, COL() SAY '´' COLOR GR+/W SET ESCAPE OFFx_swt1 = 0x_con = 0x_x = 1x_col = 25x_clave = SPACE(1)x_c = 1pio = 1DO WHILE x_x<=5     x_tecla = SPACE(1)     @ 03, 03 SAY  ;       'Introduzca la Clave: '     tecla = 0     SET CONSOLE OFF     DO WHILE tecla=0          tecla = INKEY('H')     ENDDO     SET CONSOLE ON     IF LASTKEY() = 13          IF x_x = 1               LOOP          ENDIF     ENDIF     IF LASTKEY() = 27          pio = 2          EXIT     ENDIF     IF tecla < 0          pio = 2          EXIT     ENDIF     x_tecla = CHR(tecla)     @ 03, x_col SAY '*'     IF LASTKEY() = 13          EXIT     ENDIF     IF x_x = 1          x_clave = x_tecla     ELSE          x_clave = x_clave +  ;                    x_tecla     ENDIF     x_x = x_x + 1     x_col = x_col + 1ENDDOIF pio = 2     x_clave = 'FALSO'ENDIFRELEASE WINDOW accesoRETURN ALLTRIM(x_clave)*FUNCTION clave1SET ESCAPE OFF@ 03, 24 SAY '²²²²²'x_swt1 = 0x_con = 0x_x = 1x_col = 24x_clave = SPACE(1)x_c = 1pio = 1DO WHILE x_x<=5     x_tecla = SPACE(1)     tecla = 0     SET CONSOLE OFF     DO WHILE tecla=0          tecla = INKEY('H')     ENDDO     SET CONSOLE ON     IF LASTKEY() = 13          IF x_x = 1               LOOP          ENDIF     ENDIF     IF LASTKEY() = 27          LOOP     ENDIF     x_tecla = CHR(tecla)     @ 03, x_col SAY CHR(tecla)     IF LASTKEY() = 13          EXIT     ENDIF     IF x_x = 1          x_clave = x_tecla     ELSE          x_clave = x_clave +  ;                    x_tecla     ENDIF     x_x = x_x + 1     x_col = x_col + 1ENDDOm.clave = x_claveKEYBOARD CHR(13)RETURN .T.*PROCEDURE calculadorSTORE 0 TO _CALCMEMSET SYSMENU ONACTIVATE WINDOW calculatorCLEAR GETSSET SYSMENU OFFRETURN*PROCEDURE calendarioACTIVATE WINDOW calendarCLEAR GETSRETURN*FUNCTION printerDEFINE WINDOW printer FROM 16, 19  ;       TO 20, 64 SHADOW COLOR  ;       SCHEME 5ACTIVATE WINDOW printerswt = 0SET ESCAPE OFFDO WHILE .T.     msg = 'Prepare la Impresora y Coloquela en Linea'     xyz = SPACE(((WCOLS() -  ;           LEN(msg) - 6) / 2) +  ;           3)     @ 00, LEN(xyz) SAY msg     msg = 'Salida Por Impresora'     xyz = SPACE(((WCOLS() -  ;           LEN(msg) - 6) / 2) +  ;           3)     @ 01, LEN(xyz) SAY msg     msg = 'ESC = Cancelar ³ ENTER = Imprimir'     xyz = SPACE(((WCOLS() -  ;           LEN(msg) - 6) / 2) +  ;           3)     @ 02, LEN(xyz) SAY msg     te = 0     DO WHILE te<>13 .AND. te<>27          te = INKEY('H')     ENDDO     IF te = 13          x_ok = SYS(13)          IF x_ok = 'OFFLINE'               CLEAR               SET BELL TO 1700, 4               ?? CHR(7)               @ 00, 00 SAY  ;                 SPACE(((WCOLS() -  ;                 LEN('Error') -  ;                 6) / 2) + 3)               @ 00, COL() SAY  ;                 'Error'               msg = 'Impresora No Activada'               xyz = SPACE(((WCOLS() -  ;                     LEN(msg) -  ;                     6) / 2) +  ;                     3)               @ 01, LEN(xyz) SAY  ;                 msg               msg = 'Presione Cualquier Tecla Para continuar'               xyz = SPACE(((WCOLS() -  ;                     LEN(msg) -  ;                     6) / 2) +  ;                     3)               @ 02, LEN(xyz) SAY  ;                 msg               a = INKEY(7, 'h')               SET BELL OFF               CLEAR               LOOP          ELSE               swt = 1               EXIT          ENDIF     ELSE          swt = 2          EXIT     ENDIFENDDOSET ESCAPE OFFRELEASE WINDOW printerRETURN swt*PROCEDURE bbackupSAVE SCREEN TO joleDEFINE WINDOW backup FROM 09, 12  ;       TO 14, 63 SHADOW COLOR  ;       SCHEME 5ACTIVATE WINDOW backupDO WHILE .T.     unid = 'A'     jk1 = '*-------- Respaldo del Sistema ---------*'     @ 0, 0 SAY SPACE(((WCOLS() -  ;       LEN(jk1) - 6) / 2) + 3) +  ;       jk1     @ 1, 1 SAY  ;       'Unidad donde se hara el Respaldo: '  ;       GET unid PICTURE  ;       '@!M A,B,C'     READ     IF LASTKEY() = 27          RELEASE WINDOW          CLOSE DATABASES          RETURN     ENDIF     IF unid $ 'AB'          @ 2, 2 SAY  ;            'Inserte un Diskette formateado en la unidad ' +  ;            unid + ':'     ENDIF     jk2 = 'Presione Cualquier Tecla para iniciar el Respaldo'     @ 3, 0 SAY SPACE(((WCOLS() -  ;       LEN(jk2) - 6) / 2) + 3) +  ;       jk2     SAVE SCREEN TO xgf     atx = 0     SET CONSOLE OFF     DO WHILE atx=0          atx = INKEY('H')     ENDDO     SET CONSOLE ON     IF LASTKEY() = 27          p = salida()          IF p = 2               RELEASE WINDOW  ;                       backup               CLOSE DATABASES               RELEASE WINDOW          ENDIF     ENDIF     EXITENDDORELEASE WINDOW backupHIDE POPUP ALL@ 00, 00 FILL TO 24, 79 COLOR W+/ ;  B ?? CHR(7)IF unid = 'A'     RUN pkzip -ex& a:respaldo.zip *.dbfENDIFIF unid = 'B'     RUN pkzip -ex& b:respaldo.zip *.dbfENDIFIF unid = 'C'     RUN pkzip -ex& respaldo.zip *.dbfENDIFRESTORE SCREEN FROM joleRETURN*PROCEDURE brestoreSAVE SCREEN TO xbackupDEFINE WINDOW backup FROM 09, 05  ;       TO 14, 75 SHADOW COLOR  ;       SCHEME 5ACTIVATE WINDOW backupDO WHILE .T.     unid = 'A'     jk1 = '*------ Restaura desde del Respaldo-------*'     @ 0, 0 SAY SPACE(((WCOLS() -  ;       LEN(jk1) - 6) / 2) + 3) +  ;       jk1     @ 1, 1 SAY  ;       'Unidad desde donde se Restaurar : '  ;       GET unid PICTURE  ;       '@!M A,B,C'     READ     IF LASTKEY() = 27          RELEASE WINDOW          CLOSE DATABASES          RETURN     ENDIF     IF unid $ 'AB'          @ 2, 2 SAY  ;            'Inserte Diskette que continene el Respaldo en la unidad ' +  ;            unid + ':'     ENDIF     jk2 = 'Presione Cualquier Tecla para iniciar el Restore:'     @ 3, 0 SAY SPACE(((WCOLS() -  ;       LEN(jk2) - 6) / 2) + 3) +  ;       jk2     SAVE SCREEN TO xgf     atx = 0     SET CONSOLE OFF     DO WHILE atx=0          atx = INKEY('HM')     ENDDO     SET CONSOLE ON     IF LASTKEY() = 27          p = salida()          IF p = 2               RELEASE WINDOW  ;                       backup               CLOSE DATABASES               RELEASE WINDOW          ENDIF     ENDIF     EXITENDDO?? CHR(7)RELEASE WINDOW backupHIDE POPUP ALL@ 00, 00 FILL TO 24, 79 COLOR W+/ ;  B IF unid = 'A'     RUN pkunzip a:respaldo.zip  ;         c:\sistemaENDIFIF unid = 'B'     RUN pkunzip b:respaldo.zip  ;         c:\sistemaENDIFIF unid = 'C'     RUN pkunzip respaldo.zipENDIFRESTORE SCREEN FROM xbackupRETURN*FUNCTION salidaDEFINE WINDOW xsalida FROM 15, 20  ;       TO 19, 60 SHADOW COLOR  ;       SCHEME 7ACTIVATE WINDOW xsalidamsg = 'Desea Continuar con el proceso'xcont = 1ycol1 = SPACE(((WCOLS() -  ;        LEN(msg) - 6) / 2) + 3)@ 01, LEN(ycol1) SAY msg COLOR  ;  SCHEME 7@ 02, 03 GET xcont SIZE 2, 13, 8  ;  FUNCTION  ;  '*H \!\[ Si ];\!\[ No ]' COLOR  ;  SCHEME 7READ CYCLE OBJECT 2DO CASE     CASE xcont = 1          a = 1     CASE xcont = 2          a = 2     OTHERWISE          a = 1ENDCASERELEASE WINDOW xsalidaRETURN a*FUNCTION aceptaPARAMETER xmenSAVE SCREEN TO tsalvaDEFINE WINDOW acp FROM 18, 20 TO  ;       21, 60 SHADOW COLOR SCHEME  ;       7ACTIVATE WINDOW acpxcont = 1@ 00, 00 SAY SPACE(((WCOLS() -  ;  LEN(xmen) - 6) / 2) + 3) + xmen  ;  COLOR SCHEME 7@ 01, 03 GET xcont SIZE 2, 13, 8  ;  FUNCTION  ;  '*H \!\[ Si ];\!\[ No ]' COLOR  ;  SCHEME 7READ CYCLE OBJECT 1IF LASTKEY() = 27     xcont = 2ENDIFDO CASE     CASE xcont = 1          a = 1     CASE xcont = 2          a = 2     OTHERWISE          a = 1ENDCASERELEASE WINDOW acpRESTORE SCREEN FROM tsalvaRETURN a*FUNCTION acepta1PARAMETER xmenSAVE SCREEN TO tsalvaDEFINE WINDOW acp FROM 04, 05 TO  ;       07, 45 SHADOW COLOR SCHEME  ;       7ACTIVATE WINDOW acpxcont = 1@ 00, 00 SAY SPACE(((WCOLS() -  ;  LEN(xmen) - 6) / 2) + 3) + xmen  ;  COLOR SCHEME 7@ 01, 03 GET xcont SIZE 2, 13, 8  ;  FUNCTION  ;  '*H \!\[ Si ];\!\[ No ]' COLOR  ;  SCHEME 7READ CYCLE OBJECT 1IF LASTKEY() = 27     xcont = 2ENDIFDO CASE     CASE xcont = 1          a = 1     CASE xcont = 2          a = 2     OTHERWISE          a = 1ENDCASERELEASE WINDOW acpRESTORE SCREEN FROM tsalvaRETURN a*FUNCTION herrorPARAMETER msgDEFINE WINDOW xherror FROM 03, 46  ;       TO 06, 77 SHADOW COLOR  ;       SCHEME 7ACTIVATE WINDOW xherrorxyz = SPACE(((WCOLS() - LEN(msg) -  ;      6) / 2) + 3)@ 00, LEN(xyz) SAY msg COLOR GR+/ ;  R,,msg = 'Pulse una Tecla'xyz = SPACE(((WCOLS() - LEN(msg) -  ;      6) / 2) + 3)@ 01, LEN(xyz) SAY msg COLOR GR+/ ;  R,,xyz = INKEY(5, 'H')RELEASE WINDOW xherrorRETURN .T.*FUNCTION msgerroPARAMETER errmsgIF LEN(errmsg) > 30     rmes = 'Error'     xcol1 = SPACE(((80 -  ;             LEN(errmsg) - 6) /  ;             2) + 3)     xcol2 = LEN(xcol1) +  ;             LEN(errmsg)     DEFINE WINDOW msg FROM 16,  ;            LEN(xcol1) -  ;            IIF(LEN(xcol1) < 5, 3,  ;            5) TO 20, xcol2 + 4  ;            SHADOW COLOR SCHEME  ;            7     ACTIVATE WINDOW msg     @ 01, 00 SAY '®®' COLOR GR+/ ;       R*,,     @ 01, WCOLS() - 2 SAY '¯¯'  ;       COLOR GR+/R*,,     ycol1 = SPACE(((WCOLS() -  ;             LEN(rmes) - 6) / 2) +  ;             3)     ycol2 = LEN(ycol1) +  ;             LEN(rmes)     @ 00, LEN(ycol1) SAY rmes  ;       COLOR GR+/R*      xyz = SPACE(((WCOLS() -  ;           LEN(errmsg) - 6) / 2) +  ;           3)     @ 01, LEN(xyz) SAY errmsg     errmsg = 'Pulse una tecla para Continuar'     xcol1 = SPACE(((WCOLS() -  ;             LEN(errmsg) - 6) /  ;             2) + 3)     xcol2 = LEN(xcol1) +  ;             LEN(errmsg)     @ 02, LEN(xcol1) SAY errmsg  ;       COLOR GR+/R,,ELSE     rmes = 'Error'     rtu = 'Pulse cualquier tecla para continuar'     xcol1 = SPACE(((80 -  ;             LEN(rtu) - 6) / 2) +  ;             3)     xcol2 = LEN(xcol1) +  ;             LEN(rtu)     DEFINE WINDOW msg FROM 16,  ;            LEN(xcol1) -  ;            IIF(LEN(xcol1) < 5, 3,  ;            5) TO 20, xcol2 + 4  ;            SHADOW COLOR SCHEME  ;            7     ACTIVATE WINDOW msg     @ 01, 00 SAY '®®' COLOR GR+/ ;       R*,,     @ 01, WCOLS() - 2 SAY '¯¯'  ;       COLOR GR+/R*,,     ycol1 = SPACE(((WCOLS() -  ;             LEN(rmes) - 6) / 2) +  ;             3)     ycol2 = LEN(ycol1) +  ;             LEN(rmes)     @ 00, LEN(ycol1) SAY rmes  ;       COLOR GR+/R*      xcol1 = SPACE(((WCOLS() -  ;             LEN(errmsg) - 6) /  ;             2) + 3)     xcol2 = LEN(xcol1) +  ;             LEN(errmsg)     @ 01, LEN(xcol1) SAY errmsg  ;       COLOR GR+/R,,     errmsg = 'Pulse una tecla para Continuar'     xcol1 = SPACE(((WCOLS() -  ;             LEN(errmsg) - 6) /  ;             2) + 3)     xcol2 = LEN(xcol1) +  ;             LEN(errmsg)     @ 02, LEN(xcol1) SAY errmsgENDIFasd = 0DO WHILE asd=0     asd = INKEY('H')ENDDORELEASE WINDOW msgRETURN .T.*FUNCTION fechaPARAMETER xfil, xcolSET CENTURY ONno = DOW(DATE())DO CASE     CASE no = 1          fecha = 'DOM'     CASE no = 2          fecha = 'LUN'     CASE no = 3          fecha = 'MAR'     CASE no = 4          fecha = 'MIE'     CASE no = 5          fecha = 'JUE'     CASE no = 6          fecha = 'VIE'     CASE no = 7          fecha = 'SAB'ENDCASE@ xfil, xcol SAY fecha + '  ' +  ;  DTOC(DATE()) COLOR GR+/R RETURN .T.*FUNCTION mesesPARAMETER xfechaIF EMPTY(xfecha)     xfecha = DATE()ENDIFyfecha = CMONTH(xfecha)DO CASE     CASE yfecha = 'January' .OR.  ;          yfecha = 'Enero'          xfecha = 'Enero'     CASE yfecha = 'February'  ;          .OR. yfecha =  ;          'Febrero'          xfecha = 'Febrero'     CASE yfecha = 'March' .OR.  ;          yfecha = 'Marzo'          xfecha = 'Marzo'     CASE yfecha = 'April' .OR.  ;          yfecha = 'Abril'          xfecha = 'Abril'     CASE yfecha = 'May' .OR.  ;          yfecha = 'Mayo'          xfecha = 'Mayo'     CASE yfecha = 'June' .OR.  ;          yfecha = 'Junio'          xfecha = 'Junio'     CASE yfecha = 'July' .OR.  ;          yfecha = 'Julio'          xfecha = 'Julio'     CASE yfecha = 'August' .OR.  ;          yfecha = 'Agosto'          xfecha = 'Agosto'     CASE yfecha = 'September'  ;          .OR. yfecha =  ;          'Septiembre'          xfecha = 'Septiembre'     CASE yfecha = 'October' .OR.  ;          yfecha = 'Octubre'          xfecha = 'Octubre'     CASE yfecha = 'November'  ;          .OR. yfecha =  ;          'Noviembre'          xfecha = 'Noviembre'     CASE yfecha = 'December'  ;          .OR. yfecha =  ;          'Diciembre'          xfecha = 'Diciembre'     OTHERWISE          yfecha = CMONTH(xfecha)ENDCASERETURN xfecha*FUNCTION semanaPARAMETER x_fechaIF EMPTY(x_fecha)     x_fecha = DATE()ENDIFSET CENTURY ONno = DOW(x_fecha)DO CASE     CASE no = 1          fecha = 'Domingo'     CASE no = 2          fecha = 'Lunes'     CASE no = 3          fecha = 'Martes'     CASE no = 4          fecha = 'Miercoles'     CASE no = 5          fecha = 'Jueves'     CASE no = 6          fecha = 'Viernes'     CASE no = 7          fecha = 'Sabado'ENDCASERETURN fecha*FUNCTION semana1PARAMETER x_fechaIF EMPTY(x_fecha)     x_fecha = DATE()ENDIFSET CENTURY ONno = DOW(x_fecha)DO CASE     CASE no = 1          fecha = 7     CASE no = 2          fecha = 1     CASE no = 3          fecha = 2     CASE no = 4          fecha = 3     CASE no = 5          fecha = 4     CASE no = 6          fecha = 5     CASE no = 7          fecha = 6ENDCASERETURN fecha*FUNCTION fox_acpPARAMETER wzalrtmessPRIVATE alrtbtnm.alrtbtn = 2DEFINE WINDOW _qec1ij2t7 AT 0, 0  ;       SIZE 4, 50 FONT  ;       'MS Sans Serif', 10 STYLE  ;       'B' FLOAT NOCLOSE SHADOW  ;       TITLE WTITLE() NOMINIMIZE  ;       COLOR SCHEME 5MOVE WINDOW _qec1ij2t7 CENTERACTIVATE WINDOW NOSHOW _qec1ij2t7@ 1, (50 - TXTWIDTH(wzalrtmess)) /  ;  2 SAY wzalrtmess FONT  ;  'MS Sans Serif', 10 STYLE 'B'@ 2, 0 TO 2, WCOLS() DOUBLE@ 3, 14 GET m.alrtbtn FONT  ;  'MS Sans Serif', 8 STYLE 'B'  ;  SIZE 1.769 , 8.667 , 1.333   ;  PICTURE  ;  '@*HT \<Aceptar;\?\!\<Cancelar'ACTIVATE WINDOW _qec1ij2t7READ CYCLE MODALRELEASE WINDOW _qec1ij2t7RETURN m.alrtbtn*FUNCTION boxfieldPARAMETER popdbf, varnamem.savearea = SELECT()in_area = SELECT()filtro = FILTER()SELECT 0USE EXCLUSIVE (popdbf) AGAINi = 1varname = UPPER(varname)tag_found = .F.DO WHILE  .NOT. EMPTY(TAG(i))  ;   .AND.  .NOT. tag_found     tag_found = (TAG(i) ==  ;                 varname)     IF  .NOT. tag_found          i = i + 1     ENDIFENDDOIF  .NOT. tag_found     DO WHILE .T.          IF FLOCK()               index on (&varname) tag;(varname)               UNLOCK               EXIT          ENDIF     ENDDOENDIFset filter to &filtroSET ORDER TO (varname)GOTO TOPDO CASE     CASE COL() < SCOLS() / 2          s_col = SCOLS() / 2 + 1          e_col = SCOLS() - 1          s_row = 5          e_row = SROWS() - 3     CASE COL() >= SCOLS() / 2          s_col = 2          e_col = SCOLS() / 2 - 1          s_row = 5          e_row = SROWS() - 3ENDCASEDEFINE WINDOW dbfwin FROM s_row,  ;       s_col TO e_row, e_col GROW  ;       FLOAT CLOSE ZOOM SHADOW  ;       TITLE PROPER(varname) +  ;       ' BoxField' MINIMIZE COLOR  ;       W+/BG,W+/B,GR+/W,GR+/W,GR+/ ;       N,GR+/N,W+/B,W+/B ON KEY LABEL enter keyboard chr(23)BROWSE NOAPPEND NOEDIT NODELETE  ;       WINDOW dbfwinON KEY LABEL enterIF LASTKEY() <> 27     retval = &varnameELSE     retval = &varnameENDIFRELEASE WINDOW dbfwinSELECT (m.savearea)RETURN retval*FUNCTION boxfieldtPARAMETER popdbf, varnamePRIVATE ALLm.savearea = SELECT()in_area = SELECT()SELECT 0USE EXCLUSIVE (popdbf) AGAINi = 1varname = UPPER(varname)tag_found = .F.DO WHILE  .NOT. EMPTY(TAG(i))  ;   .AND.  .NOT. tag_found     tag_found = (TAG(i) ==  ;                 varname)     IF  .NOT. tag_found          i = i + 1     ENDIFENDDOIF  .NOT. tag_found     DO WHILE .T.          IF FLOCK()               index on (&varname) tag;(varname)               UNLOCK               EXIT          ENDIF     ENDDOENDIFSET ORDER TO (varname)GOTO TOPDO CASE     CASE COL() < SCOLS() / 2          s_col = SCOLS() / 2 + 1          e_col = SCOLS() - 1          s_row = 5          e_row = SROWS() - 3     CASE COL() >= SCOLS() / 2          s_col = 2          e_col = SCOLS() / 2 - 1          s_row = 5          e_row = SROWS() - 3ENDCASESET FILTER TO practica = 'ET'DEFINE WINDOW dbfwin FROM s_row,  ;       s_col TO e_row, e_col GROW  ;       FLOAT CLOSE ZOOM SHADOW  ;       TITLE PROPER(varname) +  ;       ' BoxField' MINIMIZE COLOR  ;       W+/BG,W+/B,GR+/W,GR+/W,GR+/ ;       N,GR+/N,W+/B,W+/B ON KEY LABEL enter keyboard chr(23)BROWSE NOAPPEND NOEDIT NODELETE  ;       WINDOW dbfwinON KEY LABEL enterIF LASTKEY() <> 27     retval = &varnameELSE     retval = &varnameENDIFRELEASE WINDOW dbfwinSET FILTER TOSELECT (m.savearea)RETURN retval*FUNCTION boxfield2PARAMETER popdbf, varnamePRIVATE ALLm.savearea = SELECT()in_area = SELECT()SELECT 0USE EXCLUSIVE (popdbf) AGAINi = 1varname = UPPER(varname)tag_found = .F.DO WHILE  .NOT. EMPTY(TAG(i))  ;   .AND.  .NOT. tag_found     tag_found = (TAG(i) ==  ;                 varname)     IF  .NOT. tag_found          i = i + 1     ENDIFENDDOIF  .NOT. tag_found     DO WHILE .T.          IF FLOCK()               index on (&varname) tag;(varname)               UNLOCK               EXIT          ENDIF     ENDDOENDIFSET ORDER TO (varname)GOTO TOPDO CASE     CASE COL() < SCOLS() / 2          s_col = SCOLS() / 2 + 1          e_col = SCOLS() - 1          s_row = 5          e_row = SROWS() - 3     CASE COL() >= SCOLS() / 2          s_col = 2          e_col = SCOLS() / 2 - 1          s_row = 5          e_row = SROWS() - 3ENDCASESET FILTER TO practica = 'N 'DEFINE WINDOW dbfwin FROM s_row,  ;       s_col TO e_row, e_col GROW  ;       FLOAT CLOSE ZOOM SHADOW  ;       TITLE PROPER(varname) +  ;       ' BoxField' MINIMIZE COLOR  ;       W+/BG,W+/B,GR+/W,GR+/W,GR+/ ;       N,GR+/N,W+/B,W+/B ON KEY LABEL enter keyboard chr(23)BROWSE NOAPPEND NOEDIT NODELETE  ;       WINDOW dbfwinON KEY LABEL enterIF LASTKEY() <> 27     retval = &varnameELSE     retval = &varnameENDIFRELEASE WINDOW dbfwinSET FILTER TOSELECT (m.savearea)RETURN retval*FUNCTION espereDEFINE WINDOW a5 FROM 17, 20 TO  ;       20, 60 SHADOW COLOR SCHEME  ;       5ACTIVATE WINDOW a5ex = 'Por favor espere un momento 'ey = 'Estoy Procesando'@ 0, 0 SAY SPACE((WCOLS() -  ;  LEN(ex) - 6) / 2) + SPACE(3) +  ;  ex COLOR W+/BG @ 1, 0 SAY SPACE((WCOLS() -  ;  LEN(ey) - 6) / 2) + '..' COLOR  ;  W+/BG* @ 1, COL() SAY ey COLOR W+/BG @ 1, COL() SAY '..' COLOR W+/BG* RETURN .T.*FUNCTION relock1PARAMETER m.promptPRIVATE m.therm_x1, m.therm_y1,  ;        m.therm_x2, m.therm_y2m.therm_x1 = 16m.therm_y1 = 15m.therm_x2 = 22m.therm_y2 = 64DEFINE WINDOW thermomete FROM  ;       m.therm_x1, m.therm_y1 TO  ;       m.therm_x2, m.therm_y2  ;       FLOAT SHADOW DOUBLE COLOR  ;       SCHEME 5ACTIVATE WINDOW thermometem.g_thermwid = 46@ 0, 3 SAY m.prompt@ 1, 13 SAY 'Porcentaje: '@ 2, 1 TO 4, m.g_thermwidSHOW WINDOW TOP thermometeRETURN .T.*FUNCTION relock2PARAMETER percentPRIVATE m.blocks, nblocksm.g_thermwid = 46nblocks = (percent / 100) *  ;          (m.g_thermwid - 4)@ 1, 25 SAY percent PICTURE  ;  '9999'@ 1, COL() SAY '%'@ 3, 3 SAY REPLICATE('Û',  ;  nblocks)RETURN .T.*FUNCTION relock3RELEASE WINDOW thermometeRETURN .T.*FUNCTION letraPARAMETER mnotaDO CASE     CASE EMPTY(mnota)          mletra = '*********'     CASE mnota = 'P '          mletra = 'PENDIENTE'     CASE mnota = '- '          mletra = 'EXONERADA'     CASE VAL(mnota) < 10          mletra = 'PENDIENTE'     CASE VAL(mnota) = 10          mletra = 'DIEZ'     CASE VAL(mnota) = 11          mletra = 'ONCE'     CASE VAL(mnota) = 12          mletra = 'DOCE'     CASE VAL(mnota) = 13          mletra = 'TRECE'     CASE VAL(mnota) = 14          mletra = 'CATORCE'     CASE VAL(mnota) = 15          mletra = 'QUINCE'     CASE VAL(mnota) = 16          mletra = 'DIECISEIS'     CASE VAL(mnota) = 17          mletra = 'DIECISIETE'     CASE VAL(mnota) = 18          mletra = 'DIECIOCHO'     CASE VAL(mnota) = 19          mletra = 'DIECINUEVE'     CASE VAL(mnota) = 20          mletra = 'VEINTE'ENDCASERETURN mletra*FUNCTION letrasPARAMETER xmontoPRIVATE ALLunidad0 = ' 'unidad1 = 'UN'unidad2 = 'DOS'unidad3 = 'TRES'unidad4 = 'CUATRO'unidad5 = 'CINCO'unidad6 = 'SEIS'unidad7 = 'SIETE'unidad8 = 'OCHO'unidad9 = 'NUEVE'decena00 = ' 'decena10 = 'DIEZ'decena11 = 'ONCE'decena12 = 'DOCE'decena13 = 'TRECE'decena14 = 'CATORCE'decena15 = 'QUINCE'decena16 = 'DIECISEIS'decena17 = 'DIECISIETE'decena18 = 'DIECIOCHO'decena19 = 'DIECINUEVE'decena20 = 'VEINTE'decena30 = 'TREINTA'decena40 = 'CUARENTA'decena50 = 'CINCUENTA'decena60 = 'SESENTA'decena70 = 'SETENTA'decena80 = 'OCHENTA'decena90 = 'NOVENTA'centena0 = ' 'centena1 = 'CIEN'centena2 = 'DOSCIENTOS'centena3 = 'TRECIENTOS'centena4 = 'CUATROCIENTOS'centena5 = 'QUINIENTOS'centena6 = 'SEISCIENTOS'centena7 = 'SETECIENTOS'centena8 = 'OCHOCIENTOS'centena9 = 'NOVECIENTOS'IF xmonto < 0     xmonto = xmonto * -1ENDIFxdecimal = LTRIM(STR(xmonto, 12,  ;           2))xdecimal = RIGHT(xdecimal, 2)numero = INT(xmonto)xnumero = LTRIM(STR(numero, 9))xnumero = IIF(LEN(xnumero) < 9,  ;          REPLICATE('0', 9 -  ;          LEN(xnumero)) + xnumero,  ;          xnumero)STORE ' ' TO let1FOR i = 1 TO 3     lk = LTRIM(STR(i))     b&lk=substr(xnumero,i,1)ENDFORIF b3 = '0' .AND. b2 = '0'     t = b2 + b3     let1=centena&b1ELSE     IF b1 = '1'          centena1 = 'CIENTO'     ENDIF     let1=centena&b1     IF VAL(b2 + b3) >= 20          t = b2 + '0'          let1=alltrim(let1)+' '+trim(decena&t)          let1=let1+iif(b3<>'0',' Y '+unidad&b3,unidad&b3)     ELSE          IF VAL(b2 + b3) < 10               let1=let1+' '+unidad&b3          ELSE               t = b2 + b3               let1=let1+' '+trim(decena&t)          ENDIF     ENDIFENDIFIF VAL(b1 + b2 + b3) > 0     let1 = let1 + ' MILLONES'ENDIFcentena1 = 'CIEN'xnumero = SUBSTR(xnumero, 4, 6)FOR i = 1 TO 3     lk = LTRIM(STR(i))     b&lk=substr(xnumero,i,1)ENDFORIF b3 = '0' .AND. b2 = '0'     t = b2 + b3     let1=let1+' '+centena&b1ELSE     IF b1 = '1'          centena1 = 'CIENTO'     ENDIF     let1=let1+' '+centena&b1     IF VAL(b2 + b3) >= 20          t = b2 + '0'          let1=let1+' '+trim(decena&t)          let1=let1+iif(b3<>'0',' Y '+unidad&b3,unidad&b3)     ELSE          IF VAL(b2 + b3) < 10               let1=let1+' '+unidad&b3          ELSE               t = b2 + b3               let1=let1+' '+trim(decena&t)          ENDIF     ENDIFENDIFIF VAL(b1 + b2 + b3) > 0     let1 = let1 + ' MIL'ENDIFcentena1 = 'CIEN'x = 1FOR i = 4 TO 6     lk = LTRIM(STR(x))     b&lk=substr(xnumero,i,1)     x = x + 1ENDFORIF b3 = '0' .AND. b2 = '0'     t = b2 + b3     let1=let1+' '+centena&b1ELSE     IF b1 = '1'          centena1 = 'CIENTO'     ENDIF     let1=let1+' '+centena&b1     IF VAL(b2 + b3) >= 20          t = b2 + '0'          let1=let1+' '+trim(decena&t)          let1=let1+iif(b3<>'0',' Y '+unidad&b3,unidad&b3)     ELSE          IF VAL(b2 + b3) < 10               let1=let1+' '+unidad&b3          ELSE               t = b2 + b3               let1=let1+' '+trim(decena&t)          ENDIF     ENDIFENDIFlet1 = let1 + ' BOLIVARES CON ' +  ;       xdecimal + '/100'RETURN let1*FUNCTION busquedaDEFINE WINDOW busqueda FROM 05,  ;       05 TO 10, 75 FLOAT CLOSE  ;       SHADOW TITLE  ;       'Busqueda de Alumnos'  ;       MINIMIZE COLOR SCHEME 5ACTIVATE WINDOW busquedaDEFINE WINDOW wzlocate FROM 1, 1  ;       TO 20, 60 FONT  ;       'MS Sans Serif', 8 GROW  ;       FLOAT CLOSE ZOOM SHADOW  ;       SYSTEM COLOR W+/BG,W+/B,GR+/ ;       W,GR+/W,GR+/N,GR+/N,W+/B,W+/ ;       B MOVE WINDOW wzlocate CENTERm_cedula = SPACE(12)m_nombre = SPACE(40)m.curarea = SELECT()m.arch = SYS(2015)SELECT (m.curarea)SET ORDER TO nombrescopy struc to &m.archGOTO TOPDO WHILE .T.     @ 01, 01 SAY  ;       'Apellidos/Nombres: ' GET  ;       m_nombre PICTURE '@!'     @ 02, 01 TO 02, WCOLS()  ;       DOUBLE     @ 03, 28 GET m.choice  ;       DEFAULT 1 SIZE 1, 10, 5  ;       PICTURE '@*HN \<Ok' COLOR  ;       SCHEME 5     READ     IF  .NOT. EMPTY(m_nombre)          lon = LEN(ALLTRIM(m_nombre))          bus = ALLTRIM(m_nombre)          SELECT 18          use &m.arch          SELECT (m.curarea)          SEEK bus          IF  .NOT. FOUND()               = msgerro( ;                 'No existen Datos con esta operaci¢n' ;                 )               LOOP          ENDIF          DO WHILE  .NOT. EOF()               SELECT (m.curarea)               IF  .NOT. bus $  ;                   SUBSTR(nombres,  ;                   1, lon)                    EXIT               ENDIF               SCATTER MEMO  ;                       MEMVAR               SELECT 18               DO WHILE .T.                    IF FLOCK()                         APPEND BLANK                         GATHER MEMVAR  ;                                MEMO                         UNLOCK                         EXIT                    ENDIF               ENDDO               SELECT (m.curarea)               SKIP          ENDDO          SELECT 18          GOTO TOP          ON KEY LABEL enter keyboard;chr(23)          BROWSE NOMENU NOEDIT  ;                 NODELETE WINDOW  ;                 wzlocate TITLE  ;                 'Buscar Alumnos'  ;                 NOREFRESH          ON KEY LABEL enter          m_cedula = cedula     ELSE          ON KEY LABEL enter keyboard;chr(23)          BROWSE NOMENU NOEDIT  ;                 NODELETE WINDOW  ;                 wzlocate TITLE  ;                 'Buscar Alumnos'  ;                 NOREFRESH          ON KEY LABEL enter          m_cedula = cedula     ENDIF     EXITENDDORELEASE WINDOW wzlocate, busquedaSELECT 18USESELECT (m.curarea)SET ORDER TO cedulaGOTO TOPRETURN m_cedula*FUNCTION busquedDEFINE WINDOW busqueda FROM 05,  ;       05 TO 10, 75 FLOAT CLOSE  ;       SHADOW TITLE  ;       'Busqueda de Alumnos'  ;       MINIMIZE COLOR SCHEME 5ACTIVATE WINDOW busquedaDEFINE WINDOW wzlocate FROM 1, 1  ;       TO 20, 60 FONT  ;       'MS Sans Serif', 8 GROW  ;       FLOAT CLOSE ZOOM SHADOW  ;       SYSTEM COLOR W+/BG,W+/B,GR+/ ;       W,GR+/W,GR+/N,GR+/N,W+/B,W+/ ;       B MOVE WINDOW wzlocate CENTERm_cedula = SPACE(12)m_nombre = SPACE(40)GOTO TOPDO WHILE .T.     @ 01, 01 SAY  ;       'Apellidos/Nombres: ' GET  ;       m_nombre PICTURE '@!'     @ 02, 01 TO 02, WCOLS()  ;       DOUBLE     @ 03, 28 GET m.choice  ;       DEFAULT 1 SIZE 1, 10, 5  ;       PICTURE '@*HN \<Ok' COLOR  ;       SCHEME 5     READ     IF  .NOT. EMPTY(m_nombre)          lon = LEN(ALLTRIM(m_nombre))          bus = ALLTRIM(m_nombre)          ON KEY LABEL enter keyboard;chr(23)          BROWSE FOR bus $  ;                 SUBSTR(da.nombres,  ;                 1, lon) FIELDS  ;                 ma.ced,  ;                 da.nombres  ;                 NOMENU NOEDIT  ;                 NODELETE WINDOW  ;                 wzlocate TITLE  ;                 'Buscar Alumnos'          ON KEY LABEL enter          m_cedula = ma.ced     ELSE          ON KEY LABEL enter keyboard;chr(23)          BROWSE FIELDS ma.ced,  ;                 da.nombres  ;                 NOMENU NOEDIT  ;                 NODELETE WINDOW  ;                 wzlocate TITLE  ;                 'Buscar Alumnos'          ON KEY LABEL enter          m_cedula = ma.ced     ENDIF     EXITENDDORELEASE WINDOW wzlocate, busquedaSET ORDER TO cedcurGOTO TOPRETURN m_cedula*FUNCTION tiempoPARAMETER xfechai, xfechapddias = DAY(xfechap)dmes = MONTH(xfechap)dano = YEAR(xfechap)tdias = DAY(xfechai)tmes = MONTH(xfechai)tano = YEAR(xfechai)STORE 0 TO gdias, gmes, ganoIF ddias < tdias     ddias = ddias + 30     dmes = dmes - 1ENDIFgdias = ddias - tdiasIF dmes < tmes     dmes = dmes + 12     dano = dano - 1ENDIFgmes = dmes - tmesgano = dano - tanoxmeses = (gano * 12) + gmesRETURN STR(gdias, 2) + '-' +  ;       STR(gmes, 2) + '-' +  ;       STR(gano, 2)*FUNCTION asigreptPARAMETER y_mat, y_asiy_asi = ALLTRIM(y_asi)yi = 1DO WHILE yi<=LEN(y_asi)     yyy = SUBSTR(y_asi, yi, 2)     IF yyy = y_mat          RETURN .T.     ENDIF     yi = yi + 2ENDDORETURN .F.*
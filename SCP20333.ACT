    1  *:*****************************************************************************
    2  *:
    3  *: Procedure file: Z:\SISTEMA\SCP20333.PRG
    4  *:
    5  *:         System: 
    6  *:         Author: 
    7  *:      Copyright (c) 1910, 
    8  *:  Last modified: 19/12/106     13:34
    9  *:
   10  *:         Set by: SCP20033.PRG                      
   11  *:
   12  *:          Calls: SPACE()            (function  in ?)
   13  *:               : CHR()              (function  in ?)
   14  *:               : VARREAD()          (function  in ?)
   15  *:               : VALIDAR            (procedure in SCP20033.PRG)
   16  *:               : LASTKEY()          (function  in ?)
   17  *:               : IIF()              (function  in ?)
   18  *:               : LEN()              (function  in ?)
   19  *:               : LTRIM()            (function  in ?)
   20  *:               : STR()              (function  in ?)
   21  *:               : BUSQUEDA()         (function  in ?)
   22  *:               : SUBSTR()           (function  in ?)
   23  *:               : VAL()              (function  in ?)
   24  *:               : MSGERRO()          (function  in ?)
   25  *:               : FOUND()            (function  in ?)
   26  *:               : LEFT()             (function  in ?)
   27  *:               : SEEK()             (function  in ?)
   28  *:               : DEUDA_VEN1()       (function  in SCP20033.PRG)
   29  *:               : ALLTRIM()          (function  in ?)
   30  *:               : DATE()             (function  in ?)
   31  *:               : EOF()              (function  in ?)
   32  *:               : COL()              (function  in ?)
   33  *:               : ACEPTA()           (function  in ?)
   34  *:               : SCP20033.PRG
   35  *:               : MBANCOS()          (function  in SCP20033.PRG)
   36  *:               : SALIDA()           (function  in ?)
   37  *:               : BOXFIELD()         (function  in ?)
   38  *:               : MCOBRAD()          (function  in SCP20033.PRG)
   39  *:               : ACEPTA1()          (function  in ?)
   40  *:               : PRINTER()          (function  in ?)
   41  *:               : RLOCK()            (function  in ?)
   42  *:               : PCOL()             (function  in ?)
   43  *:               : LETRAS()           (function  in ?)
   44  *:               : REPITE_RECIBO.PRG
   45  *:               : FLOCK()            (function  in ?)
   46  *:               : WCOLS()            (function  in ?)
   47  *:               : OBJNUM()           (function  in ?)
   48  *:
   49  *:           Uses: LAPSO1.DBF         
   50  *:               : DATOS.DBF          
   51  *:               : AD&LAPMAT.DBF      
   52  *:               : CONTDEUD.DBF           Alias: CONTDEUD
   53  *:               : PLANCOBR.DBF           Alias: PLANCOBR
   54  *:               : DETACOBR.DBF           Alias: DETACOBR
   55  *:               : CONCEPTO.DBF           Alias: CONCEPTO
   56  *:               : LICEO.DBF          
   57  *:               : COBRADOR.DBF           Alias: COBRADOR
   58  *:               : REGPAGOS.DBF           Alias: REGDATOS
   59  *:               : BANCOS.DBF             Alias: BANCOS
   60  *:               : MP&LAPMAT.DBF      
   61  *:
   62  *:      CDX files: DATOS.CDX
   63  *:               : CONTDEUD.CDX
   64  *:               : PLANCOBR.CDX
   65  *:               : DETACOBR.CDX
   66  *:               : CONCEPTO.CDX
   67  *:               : COBRADOR.CDX
   68  *:               : REGPAGOS.CDX
   69  *:               : BANCOS.CDX
   70  *:
   71  *:      Documented 25/04/10 at 11:21               FoxDoc  version 2.10f
   72  *:*****************************************************************************
   73      close databases
   74      set deleted on
   75      set talk off
   76      select 1
   77      use lapso1
   78      m.lapso = lapso1
   79      clear gets
   80      select 1
   81      use datos
   82      set order to cedula
   83      select 2
   84      use ad&lapmat
   85      set order to ced
   86      select 7
   87      use contdeud again alias contdeud  ;
   88          order cedula
   89      select 8
   90      use plancobr again alias plancobr  ;
   91          order lapcod
   92      select 11
   93      use detacobr again alias detacobr  ;
   94          order lapcod
   95      select 12
   96      use concepto again alias concepto  ;
   97          order codigo
   98      select 13
   99      use liceo
  100      select 14
  101      use cobrador again alias cobrador  ;
  102          order codigo
  103      select 9
  104      use regpagos again alias regdatos  ;
  105          order cedula
  106      select 10
  107      use bancos again alias bancos  ;
  108          order codigo
  109      select 15
  110      use mp&lapmat
  111      set order to ced
  112      define window record1 from 00, 00  ;
  113          to 24, 79 grow float close  ;
  114          zoom shadow title  ;
  115          'Registro de Control de Pago Materia Adicional (SCP20333)'  ;
  116          minimize system color  ;
  117          scheme 5
  118      move window record1 center
  119      activate window record1
  120      xcedula = space(12)
  121      m.nrocont = space(10)
  122      m.nromatad = space(2)
  123      m.nroconad = space(10)
  124      m.swp = 0
  125      m.control = 0
  126      m.pote = 1
  127      on key label f8 keybo chr(13)
  128      on key label f9 keybo chr(13)
  129      on key label tab do validar with varread()
  130      m.nac = 'V'
  131      m.ced = 0
  132      valida1 = 'ABCDEFGHIJKLMNOPQRSTUVXYZ'
  133      valida2 = 'ABCDEFGHIJKLMNOPQRSTUVXYZ*'
  134      mcuota = 01
  135      lin1 = 0
  136      lin2 = 0
  137      mdec1 = 0
  138      mdec2 = 0
  139      tu = 0
  140      mbandes = space(30)
  141      tdeuda = 0.00
  142      tpagad = 0.00
  143      tsaldo = 0.00
  144      tmontv = 0.00
  145    ÉÍdo while .t.
  146    º    lin1 = 0
  147    º    lin2 = 0
  148    º    lin3 = 0
  149    º    mdec1 = 0
  150    º    mdec2 = 0
  151    º    tu = 0
  152    º  ÚÄif m.pote = 1
  153    º  ³    @ 00, 00 say  ;
  154    º  ³        'ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»'
  155    º  ³    @ 01, 00 say  ;
  156    º  ³        'º C‚dula  :             Apell/Nombres :                                      º'
  157    º  ³    @ 02, 00 say  ;
  158    º  ³        'º Menci¢n :       (             )  Nro.Control:             Semestre :(  )   º'
  159    º  ³    @ 03, 00 say  ;
  160    º  ³        'º Nro.Mat.Adicionales : (  )       Nro.Control Mat.Adicional:                º'
  161    º  ³    @ 04, 00 say  ;
  162    º  ³        'ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶'
  163    º  ³    @ 05, 00 say  ;
  164    º  ³        'º C¢digo del Plan:      Descripci¢n:                                         º'
  165    º  ³    @ 06, 00 say  ;
  166    º  ³        'º       Total Plan Cobro:               Fecha de Pago    :                   º'
  167    º  ³    @ 07, 00 say  ;
  168    º  ³        'º           Monto Pagado:               Tipo Pago (E/D/C):                   º'
  169    º  ³    @ 08, 00 say  ;
  170    º  ³        'º        Saldo por Pagar:               Nro. Dep./Cheq   :                   º'
  171    º  ³    @ 09, 00 say  ;
  172    º  ³        'º    Total Deuda Vencida:               Banco :                              º'
  173    º  ³    @ 10, 00 say  ;
  174    º  ³        'º  Monto Cancelar/Abonar:               Cobrador :                           º'
  175    º  ³    @ 11, 00 say  ;
  176    º  ³        'º CONCEPTOS   ³  Cuotas  ³  Pagado  ³Tº CONCEPTOS    ³  Cuotas  ³  Pagado  ³Tº'
  177    º  ³    @ 11, 01 say  ;
  178    º  ³        ' CONCEPTOS   ³  Cuotas  ³  Pagado  ³Tº CONCEPTOS    ³  Cuotas  ³  Pagado  ³T'  ;
  179    º  ³        color n+/w
  180    º  ³    @ 12, 00 say  ;
  181    º  ³        'º             ³          ³          ³ º              ³          ³          ³ º'
  182    º  ³    @ 13, 00 say  ;
  183    º  ³        'º             ³          ³          ³ º              ³          ³          ³ º'
  184    º  ³    @ 14, 00 say  ;
  185    º  ³        'º             ³          ³          ³ º              ³          ³          ³ º'
  186    º  ³    @ 15, 00 say  ;
  187    º  ³        'º             ³          ³          ³ º              ³          ³          ³ º'
  188    º  ³    @ 16, 00 say  ;
  189    º  ³        'º             ³          ³          ³ º              ³          ³          ³ º'
  190    º  ³    @ 17, 00 say  ;
  191    º  ³        'º             ³          ³          ³ º              ³          ³          ³ º'
  192    º  ³    @ 18, 00 say  ;
  193    º  ³        'º             ³          ³          ³ º              ³          ³          ³ º'
  194    º  ³    @ 19, 00 say  ;
  195    º  ³        'º             ³          ³          ³ º              ³          ³          ³ º'
  196    º  ³    @ 20, 00 say  ;
  197    º  ³        'º             ³          ³          ³ º              ³          ³          ³ º'
  198    º  ³    @ 21, 00 say  ;
  199    º  ³        'ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÏÍÊÍÍÍÍÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÏÍ¼'
  200    º  ³    m.pote = 2
  201    º  ³    save screen to pelota
  202    º  ÀÄendif
  203    º    restore screen from pelota
  204    º    @ 01, 12 get m.nac picture  ;
  205    º        '@!M V,E,C,R' message  ;
  206    º        'ingrese la Nacionalidad del Alumno'
  207    º    @ 01, 13 say '-'
  208    º    @ 01, 14 get m.ced picture  ;
  209    º        '99999999' valid m.ced >=  ;
  210    º        0 message  ;
  211    º        'Ingrese el N£mero del Cedula del Alumno'  ;
  212    º        error  ;
  213    º        'Ingrese al N£mero de Cedula'
  214    º    read
  215    º  ÚÄif lastkey() = -8
  216    º  ³    select 1
  217    º  ³    goto top
  218    º  ³    m.ced = iif(len(ltrim(str(m.ced,  ;
  219    º  ³        10))) < 10,  ;
  220    º  ³        ltrim(str(m.ced,  ;
  221    º  ³        10)) + space(10 -  ;
  222    º  ³        len(ltrim(str(m.ced,  ;
  223    º  ³        10)))),  ;
  224    º  ³        ltrim(str(m.ced,  ;
  225    º  ³        10)))
  226    º  ³    xcedula = m.nac + '-' +  ;
  227    º  ³        m.ced
  228    º  ³    xcedula = busqueda()
  229    º  ³    m.nac = substr(xcedula,  ;
  230    º  ³        1, 1)
  231    º  ³    m.ced = val(substr(xcedula,  ;
  232    º  ³        3, 10))
  233    ^ÍÍÍÍÍÍÍloop
  234    º  ÀÄendif
  235    º  ÚÄif lastkey() = 27
  236    º  ³    entra = .f.
  237    º  ³    on key label tab
  238    º  ³    release window record1
  239    º  ³    close databases
  240  <ÍÍÍÍÍÍÍÍÍreturn
  241    º  ÀÄendif
  242    º  ÚÄif m.ced <= 0
  243    º  ³    = msgerro( ;
  244    º  ³        'Ingrese el Nro. de Cedula' ;
  245    º  ³        )
  246    ^ÍÍÍÍÍÍÍloop
  247    º  ÀÄendif
  248    º    m.ced = iif(len(ltrim(str(m.ced,  ;
  249    º        10))) < 10,  ;
  250    º        ltrim(str(m.ced,  ;
  251    º        10)) + space(10 -  ;
  252    º        len(ltrim(str(m.ced,  ;
  253    º        10)))),  ;
  254    º        ltrim(str(m.ced,  ;
  255    º        10)))
  256    º    xcedula = m.nac + '-' +  ;
  257    º        m.ced
  258    º    select 1
  259    º    set order to cedula
  260    º    seek xcedula
  261    º  ÚÄif  .not. found()
  262    º  ³    = msgerro( ;
  263    º  ³        'Este alumno no esta registrado, verifique' ;
  264    º  ³        )
  265    º  ³    m.nac = 'V'
  266    º  ³    m.ced = 0
  267    ^ÍÍÍÍÍÍÍloop
  268    º  ÀÄendif
  269    º    scatter memo memvar
  270    º    m.cedula = xcedula
  271    º    @ 01, 40 get m.nombres  ;
  272    º        picture '@!S37' message  ;
  273    º        'Ingrese Apellidos y Nombres de Alumno'
  274    º    m.nac1 = left(m.rep_legal,  ;
  275    º        1)
  276    º    m.ced1 = val(substr(m.rep_legal,  ;
  277    º        3, 10))
  278    º    select 2
  279    º  ÚÄif seek(xcedula)
  280    º  ³  ÚÄif cierre = 'S'
  281    º  ³  ³    = msgerro( ;
  282    º  ³  ³        'Esta Matricula de pago de Mat. Adicional ya fue cerrada, verifique' ;
  283    º  ³  ³        )
  284    º  ³  ³    m.nac = 'V'
  285    º  ³  ³    m.ced = 0
  286    ^ÍÍÍÍÍÍÍÍÍÍloop
  287    º  ³  ÀÄendif
  288    º  ÀÄendif
  289    º    select 7
  290    º    set order to cedula
  291    º  ÚÄif seek(xcedula)
  292    º  ³    m.saldo = total_d -  ;
  293    º  ³        monto_p
  294    º  ³  ÚÄif m.saldo > 0
  295    º  ³  ³    = msgerro( ;
  296    º  ³  ³        'Este Alumno tiene un registro de deuda vencida pendiente, verifique' ;
  297    º  ³  ³        )
  298    º  ³  ³  ÚÄif  .not.  ;
  299    º  ³  ³  ³        deuda_ven1()
  300    º  ³  ³  ³    m.nac = 'V'
  301    º  ³  ³  ³    m.ced = 0
  302    ^ÍÍÍÍÍÍÍÍÍÍÍÍÍloop
  303    º  ³  ³  ÀÄendif
  304    º  ³  ÀÄendif
  305    º  ÀÄendif
  306    º    select 2
  307    º    set order to ced
  308    º  ÚÄif  .not. seek(xcedula)
  309    º  ³    = msgerro( ;
  310    º  ³        'Este alumno no esta registrado con Materia Adicional, verifique' ;
  311    º  ³        )
  312    º  ³    m.nac = 'V'
  313    º  ³    m.ced = 0
  314    ^ÍÍÍÍÍÍÍloop
  315    º  ÀÄendif
  316    º  ÚÄif status = 'X'
  317    º  ³    = msgerro( ;
  318    º  ³        'Este Alumno fue egresado de la Matricula de Mat. Adicional, verifique' ;
  319    º  ³        )
  320    º  ³    m.nac = 'V'
  321    º  ³    m.ced = space(10)
  322    ^ÍÍÍÍÍÍÍloop
  323    º  ÀÄendif
  324    º    scatter memo memvar
  325    º    qcurso = m.cur
  326    º    m.codigo = semestre
  327    º    m.nrocont = matricula
  328    º    @ 02, 12 get qcurso picture  ;
  329    º        '@!M 32012,31022,31023'
  330    º  ÕÍdo case
  331    º  ÆÍcase alltrim(qcurso) =  ;
  332    º  ³        '32012'
  333    º  ³    @ 02, 19 say  ;
  334    º  ³        'BASICA'
  335    º  ³    mmencion = 'BASICA'
  336    º  ÆÍcase alltrim(qcurso) =  ;
  337    º  ³        '31022'
  338    º  ³    @ 02, 19 say  ;
  339    º  ³        'CIENCIAS'
  340    º  ³    mmencion = 'CIENCIAS'
  341    º  ÆÍcase alltrim(qcurso) =  ;
  342    º  ³        '31023'
  343    º  ³    @ 02, 19 say  ;
  344    º  ³        'HUMANIDADES'
  345    º  ³    mmencion = 'HUMANIDADES'
  346    º  ÔÍendcase
  347    º    @ 02, 48 get m.nrocont  ;
  348    º        picture '@!'
  349    º    @ 02, 71 get m.codigo  ;
  350    º        picture '@!'
  351    º    m.curso = qcurso
  352    º    m.cedula = xcedula
  353    º    m.ced = xcedula
  354    º    m.ultima = ultimacuot + 1
  355    º    xultimacuo = ultimacuot
  356    º    m.turno = turno
  357    º    clear gets
  358    º    select 2
  359    º    set order to ced
  360    º  ÚÄif seek(xcedula)
  361    º  ³    m.nromatad = nromatad
  362    º  ³    m.nroconad = matricula
  363    º  ³    @ 03, 25 say m.nromatad  ;
  364    º  ³        picture '@!' color w+/ ;
  365    º  ³        bg*
  366    º  ³    @ 03, 62 say m.nroconad  ;
  367    º  ³        picture '@!' color w+/ ;
  368    º  ³        bg*
  369    º  ÀÄendif
  370    º    select 8
  371    º    seek lapmat + m.plancobro
  372    º    mdes1 = alltrim(descripcio)
  373    º    mdes2 = alltrim(descripcio)
  374    º    @ 05, 18 say m.plancobro  ;
  375    º        picture '@!' color w+/w
  376    º    @ 05, 36 say mdes1 picture  ;
  377    º        '@!'
  378    º    xnro = nrocuotas
  379    º    save screen to hol
  380    º    select 2
  381    º    ii = 1
  382    º    tdeuda = 0.00
  383    º    tpagad = 0.00
  384    º    tsaldo = 0.00
  385    º    tmontv = 0.00
  386    º    m.montov = 0.00
  387    º  ÖÄfor ii = 1 to xnro
  388    º  º    lk = ltrim(str(ii))
  389    º  º    tdeuda=tdeuda+cuota&lk
  390    º  º    tpagad=tpagad+pagado&lk
  391    º  º  ÚÄif cuota&lk<=pagado&lk
  392    º  ^ÍÍÍÍÍÍÍloop
  393    º  º  ÀÄendif
  394    º  º    select 11
  395    º  º    set order to codcuota
  396    º  º    locate for lapso =  ;
  397    º  º        lapmat .and.  ;
  398    º  º        codigo =  ;
  399    º  º        m.plancobro  ;
  400    º  º        .and. cuota =  ;
  401    º  º        ii
  402    º  º  ÚÄif fecha_ven >= date()
  403    º  vÍÍÍÍÍÍÍexit
  404    º  º  ÀÄendif
  405    º  º    select 2
  406    º  º    tmontv=tmontv+(cuota&lk-pagado&lk)
  407    º  º    m.montov=m.montov+(cuota&lk-pagado&lk)
  408    º  º    m.montov1 = m.montov
  409    º  ÓÄendfor
  410    º    select 2
  411    º    tsaldo = tdeuda - tpagad
  412    º    m.montov1 = m.montov
  413    º    m.saldo_paga = m.total_deud -  ;
  414    º        m.monto_paga
  415    º    m.saldo_paga = m.saldo_paga
  416    º    m.total_deud = m.total_deud
  417    º    m.monto_paga = m.monto_paga
  418    º    @ 06, 26 say tdeuda picture  ;
  419    º        '99,999,999.99' color w+/w
  420    º    @ 07, 26 say tpagad picture  ;
  421    º        '99,999,999.99' color w+/w
  422    º    @ 08, 26 say tsaldo picture  ;
  423    º        '99,999,999.99' color w+/w
  424    º    @ 09, 26 say tmontv picture  ;
  425    º        '99,999,999.99' color w+/w
  426    º    mm = 1
  427    º    select 11
  428    º    set order to codcuota
  429    º    seek lapmat + m.plancobro +  ;
  430    º        str(1)
  431    º    swp = 0
  432    º    suma = 0
  433    º    paso = 0
  434    º    li = 12
  435    º    m.planco = m.plancobro
  436    º  ÉÍdo while  .not. eof()
  437    º  º  ÚÄif lapso <> lapmat
  438    º  º  ³    select 11
  439    º  º  ³    skip
  440    º  ^ÍÍÍÍÍÍÍloop
  441    º  º  ÀÄendif
  442    º  º  ÚÄif codigo <> m.planco
  443    º  º  ³    select 11
  444    º  º  ³    skip
  445    º  ^ÍÍÍÍÍÍÍloop
  446    º  º  ÀÄendif
  447    º  º  ÚÄif swp = 0
  448    º  º  ³    mcuota = cuota
  449    º  º  ³    swp = 1
  450    º  º  ³    mcon = concepto1
  451    º  º  ³    col1 = 02
  452    º  º  ³    select 12
  453    º  º  ³    seek mcon
  454    º  º  ³    @ li, col1 say  ;
  455    º  º  ³        left(descripcio,  ;
  456    º  º  ³        11)
  457    º  º  ³    select 11
  458    º  º  ÀÄendif
  459    º  º  ÚÄif mcuota <> cuota
  460    º  º  ³    lk = ltrim(str(mcuota))
  461    º  º  ³    @ li, col() + 2  ;
  462    º  º  ³        say suma picture  ;
  463    º  º  ³        '999,999.99'
  464    º  º  ³    m.cuota&lk=suma
  465    º  º  ³    select 2
  466    º  º  ³    @li,col()+1 say pagado&lk;
  467    º  º  ³        pict '999,999.99'
  468    º  º  ³  ÚÄif pagado&lk > 0
  469    º  º  ³  ³    marca=iif(pagado&lk>=suma,'û','í')
  470    º  º  ³  ³    @ li, col() +  ;
  471    º  º  ³  ³        1 say marca  ;
  472    º  º  ³  ³        color w+/bg*
  473    º  º  ³  ÀÄendif
  474    º  º  ³    li = li + 1
  475    º  º  ³  ÚÄif li > 20
  476    º  º  ³  ³    col1 = 41
  477    º  º  ³  ³    li = 12
  478    º  º  ³  ³    paso = 1
  479    º  º  ³  ÃÄelse
  480    º  º  ³  ³  ÚÄif paso = 0
  481    º  º  ³  ³  ³    col1 = 02
  482    º  º  ³  ³  ÃÄelse
  483    º  º  ³  ³  ³    col1 = 41
  484    º  º  ³  ³  ÀÄendif
  485    º  º  ³  ÀÄendif
  486    º  º  ³    select 11
  487    º  º  ³    mcuota = cuota
  488    º  º  ³    mcon = concepto1
  489    º  º  ³    select 12
  490    º  º  ³    seek mcon
  491    º  º  ³    @ li, col1 say  ;
  492    º  º  ³        left(descripcio,  ;
  493    º  º  ³        11)
  494    º  º  ³    select 11
  495    º  º  ³    suma = 0.00
  496    º  º  ³    mcuota = cuota
  497    º  º  ÀÄendif
  498    º  º    ii = 1
  499    º  º  ÖÄfor ii = 1 to 10
  500    º  º  º    lk = ltrim(str(ii))
  501    º  º  º  ÚÄif concepto&lk=space(2)
  502    º  º  ^ÍÍÍÍÍÍÍloop
  503    º  º  º  ÀÄendif
  504    º  º  º  ÚÄif monto&lk=0
  505    º  º  ^ÍÍÍÍÍÍÍloop
  506    º  º  º  ÀÄendif
  507    º  º  º    suma=suma+monto&lk
  508    º  º  ÓÄendfor
  509    º  º    skip
  510    º  ÈÍenddo
  511    º    lk = ltrim(str(mcuota))
  512    º    @ li, col() + 2 say suma  ;
  513    º        picture '999,999.99'
  514    º    cuota&lk=suma
  515    º    select 2
  516    º    @li,col()+1 say pagado&lk pict '999,999.99'
  517    º  ÚÄif pagado&lk > 0
  518    º  ³    marca=iif(pagado&lk>=suma,'û','í')
  519    º  ³    @ li, col() + 1 say  ;
  520    º  ³        marca color w+/bg*
  521    º  ÀÄendif
  522    º  ÚÄif tdeuda = tpagad
  523    º  ³    = msgerro( ;
  524    º  ³        'Este Alumno esta Solvente de Pagos, Verifique' ;
  525    º  ³        )
  526    º  ³    m.nac = 'V'
  527    º  ³    m.ced = 0
  528    ^ÍÍÍÍÍÍÍloop
  529    º  ÀÄendif
  530    º    select 2
  531    º  ÚÄif cierre = 'S'
  532    º  ³    = msgerro( ;
  533    º  ³        'Esta Matricula de pago de Materia Adicional ya fue cerrada, verifique' ;
  534    º  ³        )
  535    º  ³    m.nac = 'V'
  536    º  ³    m.ced = 0
  537    ^ÍÍÍÍÍÍÍloop
  538    º  ÀÄendif
  539    º    select 15
  540    º    set order to ced
  541    º  ÚÄif seek(xcedula)
  542    º  ³    iii = 1
  543    º  ³    m.montovad = 0.00
  544    º  ³  ÖÄfor iii = 1 to xnro
  545    º  ³  º    lq = ltrim(str(iii))
  546    º  ³  º  ÚÄif cuota&lq<=pagado&lq
  547    º  ³  ^ÍÍÍÍÍÍÍloop
  548    º  ³  º  ÀÄendif
  549    º  ³  º    select 11
  550    º  ³  º    set order to codcuota
  551    º  ³  º    locate for lapso =  ;
  552    º  ³  º        lapmat  ;
  553    º  ³  º        .and.  ;
  554    º  ³  º        codigo =  ;
  555    º  ³  º        m.plancobro  ;
  556    º  ³  º        .and. cuota =  ;
  557    º  ³  º        iii
  558    º  ³  º  ÚÄif fecha_ven >=  ;
  559    º  ³  º  ³        date()
  560    º  ³  vÍÍÍÍÍÍÍexit
  561    º  ³  º  ÀÄendif
  562    º  ³  º    select 15
  563    º  ³  º    m.montovad=m.montovad+(cuota&lq-pagado&lq)
  564    º  ³  ÓÄendfor
  565    º  ³  ÚÄif m.montovad > 0 .and.  ;
  566    º  ³  ³        entra = .f.
  567    º  ³  ³    = msgerro( ;
  568    º  ³  ³        'Este Alumno tiene Deuda Vencida de Pago de Mensualidad, verifique' ;
  569    º  ³  ³        )
  570    º  ³  ³    opc = acepta( ;
  571    º  ³  ³        'Ir a Proceso de Pago de Mensualidades' ;
  572    º  ³  ³        )
  573    º  ³  ³  ÚÄif opc = 1
  574    º  ³  ³  ³    entra = .t.
  575    º  ³  ³  ³    do scp20033
  576    º  ³  ³  ³    on key label tab
  577    º  ³  ³  ³    release window  ;
  578    º  ³  ³  ³        record1
  579    º  ³  ³  ³    close databases
  580  <ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍreturn
  581    º  ³  ³  ÀÄendif
  582    º  ³  ÀÄendif
  583    º  ÀÄendif
  584    º    select 2
  585    º    mfechap = date()
  586    º    mtipop = 'Efectivo'
  587    º    mnrode = space(20)
  588    º    mbanco = space(2)
  589    º    mmontop = 0.00
  590    º    mdesban = space(20)
  591    º    m.choice = 1
  592    º    mcobrador = space(2)
  593    º    swp = 0
  594    º    p = 0
  595    º    save screen to hi
  596    º  ÉÍdo while .t.
  597    º  º    restore screen from hi
  598    º  º    @ 06, 58 say mfechap  ;
  599    º  º        picture '@E'
  600    º  º    @ 07, 58 get mtipop  ;
  601    º  º        default 'Efectivo'  ;
  602    º  º        picture  ;
  603    º  º        '@!M Deposito,Cheque,Efectivo'
  604    º  º    read
  605    º  º  ÚÄif mtipop <> 'Efectivo'
  606    º  º  ³    @ 08, 58 get  ;
  607    º  º  ³        mnrode picture  ;
  608    º  º  ³        '@!S15' valid  ;
  609    º  º  ³        mnrode <>  ;
  610    º  º  ³        space(20) error  ;
  611    º  º  ³        'El N£mero de la Transacci¢n esta en blanco'
  612    º  º  ³    @ 09, 47 get  ;
  613    º  º  ³        mbanco picture  ;
  614    º  º  ³        '@!' valid  ;
  615    º  º  ³        mbancos(mbanco)
  616    º  º  ³    read
  617    º  º  ³  ÚÄif lastkey() = 27
  618    º  º  ³  ³    p = salida()
  619    º  º  ³  ³  ÚÄif p = 2
  620    º  º  ³  ³  ³    entra = .f.
  621    º  º  ³  ³  ³    on key label;
  622    º  º  ³  ³  ³        f4
  623    º  vÍÍÍÍÍÍÍÍÍÍÍÍÍexit
  624    º  º  ³  ³  ÀÄendif
  625    º  ^ÍÍÍÍÍÍÍÍÍÍloop
  626    º  º  ³  ÀÄendif
  627    º  º  ³    select 10
  628    º  º  ³  ÚÄif  .not.  ;
  629    º  º  ³  ³        seek(mbanco)
  630    º  º  ³  ³    mbanco = boxfield('bancos', ;
  631    º  º  ³  ³        'codigo')
  632    º  º  ³  ÀÄendif
  633    º  º  ³    select 9
  634    º  º  ³    set order to bandepo
  635    º  º  ³  ÚÄif seek(mbanco +  ;
  636    º  º  ³  ³        mnrode)
  637    º  º  ³  ³  ÚÄif status <>  ;
  638    º  º  ³  ³  ³        'D'
  639    º  º  ³  ³  ³    = msgerro( ;
  640    º  º  ³  ³  ³        'Ya existe un registro de pagos con este numero, verifique' ;
  641    º  º  ³  ³  ³        )
  642    º  ^ÍÍÍÍÍÍÍÍÍÍÍÍÍloop
  643    º  º  ³  ³  ÀÄendif
  644    º  º  ³  ÀÄendif
  645    º  º  ³    select 10
  646    º  º  ³    @ 09, 47 say  ;
  647    º  º  ³        mbanco picture  ;
  648    º  º  ³        '@!' color w+/w
  649    º  º  ³    @ 09, col() + 2  ;
  650    º  º  ³        say  ;
  651    º  º  ³        left(descripcio,  ;
  652    º  º  ³        25)
  653    º  º  ³    mbandes = alltrim(descripcio)
  654    º  º  ÀÄendif
  655    º  º    @ 10, 26 get mmontop  ;
  656    º  º        picture  ;
  657    º  º        '99,999,999.99'
  658    º  º    @ 10, 50 get mcobrador  ;
  659    º  º        picture '@!' valid  ;
  660    º  º        mcobrad(mcobrador)
  661    º  º    read
  662    º  º  ÚÄif lastkey() = 27
  663    º  º  ³    p = salida()
  664    º  º  ³  ÚÄif p = 2
  665    º  º  ³  ³    entra = .f.
  666    º  º  ³  ³    on key label f4
  667    º  vÍÍÍÍÍÍÍÍÍÍexit
  668    º  º  ³  ÀÄendif
  669    º  ^ÍÍÍÍÍÍÍloop
  670    º  º  ÀÄendif
  671    º  º  ÚÄif mmontop = 0 .or.  ;
  672    º  º  ³        mmontop >  ;
  673    º  º  ³        m.total_deud
  674    º  º  ³    = msgerro( ;
  675    º  º  ³        'El Monto a Pagar por Concepto de Mensualidad es invalido, verifique' ;
  676    º  º  ³        )
  677    º  ^ÍÍÍÍÍÍÍloop
  678    º  º  ÀÄendif
  679    º  º    select cobrador
  680    º  º  ÚÄif  .not.  ;
  681    º  º  ³        seek(mcobrador)
  682    º  º  ³    mcobrador = boxfield('cobrador', ;
  683    º  º  ³        'codigo')
  684    º  º  ÀÄendif
  685    º  º    select 14
  686    º  º    @ 10, 50 say mcobrador  ;
  687    º  º        picture '@!' color w+/ ;
  688    º  º        w
  689    º  º    @ 10, col() + 2 say  ;
  690    º  º        left(nombres, 20)
  691    º  º    mnomcob = alltrim(nombres)
  692    º  º    opc = acepta1( ;
  693    º  º        'Esta correcto este Monto a Cancelar' ;
  694    º  º        )
  695    º  º  ÚÄif opc = 2
  696    º  ^ÍÍÍÍÍÍÍloop
  697    º  º  ÀÄendif
  698    º  vÍÍÍÍexit
  699    º  ÈÍenddo
  700    º  ÚÄif p = 2
  701    º  ³    m.nac = 'V'
  702    º  ³    m.ced = 0
  703    ^ÍÍÍÍÍÍÍloop
  704    º  ÀÄendif
  705    º    on key label f4
  706    º    mpagado = mmontop
  707    º    np = 1
  708    º  ÖÄfor np = 1 to 12
  709    º  º    np1 = ltrim(str(np))
  710    º  º    mpagrec&np1=0
  711    º  º    mpsaldo&np1=0
  712    º  º    imp&np1=0
  713    º  ÓÄendfor
  714    º    ii = 1
  715    º    li = 12
  716    º    col1 = 26
  717    º    paso = 0
  718    º  ÖÄfor ii = 1 to xnro
  719    º  º    lk = ltrim(str(ii))
  720    º  º  ÚÄif pagado&lk>=cuota&lk
  721    º  º  ³    li = li + 1
  722    º  º  ³  ÚÄif li > 20
  723    º  º  ³  ³    col1 = 65
  724    º  º  ³  ³    li = 12
  725    º  º  ³  ÀÄendif
  726    º  ^ÍÍÍÍÍÍÍloop
  727    º  º  ÀÄendif
  728    º  º    select 2
  729    º  º  ÚÄif (mpagado+pagado&lk) >= cuota&lk
  730    º  º  ³    mpagado=mpagado-(cuota&lk-pagado&lk)
  731    º  º  ³    mpagrec&lk=cuota&lk-pagado&lk
  732    º  º  ³    mpsaldo&lk=0
  733    º  º  ³    @li,col1 say cuota&lk pict;
  734    º  º  ³        '999,999.99'
  735    º  º  ³    @ li, col() + 1  ;
  736    º  º  ³        say 'û' color w+/ ;
  737    º  º  ³        bg*
  738    º  º  ³    mdec1 = mdec1 + 1
  739    º  º  ÃÄelse
  740    º  º  ³  ÚÄif mpagado > 0
  741    º  º  ³  ³    @li,col1 say mpagado+pagado&lk;
  742    º  º  ³  ³        pict '999,999.99'
  743    º  º  ³  ³    @ li, col() +  ;
  744    º  º  ³  ³        1 say 'í'  ;
  745    º  º  ³  ³        color w+/bg*
  746    º  º  ³  ³    mpsaldo&lk=cuota&lk-mpagado-pagado&lk
  747    º  º  ³  ³    mpagrec&lk=mpagado
  748    º  º  ³  ³    mdec2 = mdec2 +  ;
  749    º  º  ³  ³        1
  750    º  º  ³  ÀÄendif
  751    º  vÍÍÍÍÍÍÍexit
  752    º  º  ÀÄendif
  753    º  º    li = li + 1
  754    º  º  ÚÄif li > 20
  755    º  º  ³    col1 = 65
  756    º  º  ³    li = 12
  757    º  º  ÀÄendif
  758    º  ÓÄendfor
  759    º    opce = acepta1( ;
  760    º        'Proceso este Pago de Mensualidad' ;
  761    º        )
  762    º  ÚÄif opce = 2
  763    º  ³    release window reg
  764    º  ³    on key label f4
  765    º  ³    m.nac = 'V'
  766    º  ³    m.ced = 0
  767    ^ÍÍÍÍÍÍÍloop
  768    º  ÀÄendif
  769    º    mrecibo = 0
  770    º    select 2
  771    º    p = printer()
  772    º  ÚÄif p = 2
  773    º  ³    select 13
  774    º  ³  ÉÍdo while .t.
  775    º  ³  º  ÚÄif rlock()
  776    º  ³  º  ³    replace recibo  ;
  777    º  ³  º  ³        with  ;
  778    º  ³  º  ³        recibo +  ;
  779    º  ³  º  ³        1
  780    º  ³  º  ³    mrecibo = recibo
  781    º  ³  º  ³    unlock
  782    º  ³  vÍÍÍÍÍÍÍexit
  783    º  ³  º  ÀÄendif
  784    º  ³  ÈÍenddo
  785    º  ³    select 2
  786    º  ³    wait window  ;
  787    º  ³        'Nro. del Recibo Generado: ' +  ;
  788    º  ³        ltrim(str(mrecibo)) +  ;
  789    º  ³        chr(13) +  ;
  790    º  ³        'Presione Cualquier Tecla para continuar..'
  791    º  ÃÄelse
  792    º  ³    select 13
  793    º  ³  ÉÍdo while .t.
  794    º  ³  º  ÚÄif rlock()
  795    º  ³  º  ³    replace recibo  ;
  796    º  ³  º  ³        with  ;
  797    º  ³  º  ³        recibo +  ;
  798    º  ³  º  ³        1
  799    º  ³  º  ³    mrecibo = recibo
  800    º  ³  º  ³    unlock
  801    º  ³  vÍÍÍÍÍÍÍexit
  802    º  ³  º  ÀÄendif
  803    º  ³  ÈÍenddo
  804    º  ³    select 2
  805    º  ³    set device to printer
  806    º  ³    @ 0, 1 say '  ' +  ;
  807    º  ³        chr(27) + chr(67) +  ;
  808    º  ³        chr(33)
  809    º  ³    @ 00, 00 say chr(18) +  ;
  810    º  ³        chr(20)
  811    º  ³    @ 00, 00 say chr(14) +  ;
  812    º  ³        chr(15) + titulo +  ;
  813    º  ³        chr(18) + chr(20) +  ;
  814    º  ³        ' '
  815    º  ³    @ 01, 00 say  ;
  816    º  ³        'RIF                                                     RECIBO Nro.:          '
  817    º  ³    @ 01, 04 say l_rif
  818    º  ³    @ 01, 68 say chr(14) +  ;
  819    º  ³        ng +  ;
  820    º  ³        ltrim(str(mrecibo)) +  ;
  821    º  ³        ngn
  822    º  ³    @ 02, 00 say chr(15) +  ;
  823    º  ³        ' '
  824    º  ³    @ 02, 00 say l_direccio
  825    º  ³    @ 02, pcol() say  ;
  826    º  ³        chr(18) + chr(20) +  ;
  827    º  ³        ' '
  828    º  ³    @ 02, 00 say  ;
  829    º  ³        '                                                        FECHA PAGO :          '
  830    º  ³    @ 02, 68 say mfechap  ;
  831    º  ³        picture '@E'
  832    º  ³    @ 03, 00 say  ;
  833    º  ³        '                                                      '
  834    º  ³    @ 03, 28 say chr(14) +  ;
  835    º  ³        chr(15) +  ;
  836    º  ³        'RECIBO DE PAGO' +  ;
  837    º  ³        chr(18) + chr(20) +  ;
  838    º  ³        ' '
  839    º  ³    @ 04, 00 say  ;
  840    º  ³        '                                                      ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ» '
  841    º  ³    @ 05, 00 say  ;
  842    º  ³        'C.I.:                                                 º Bs.                º '
  843    º  ³    @ 05, 61 say mmontop  ;
  844    º  ³        picture  ;
  845    º  ³        '9,999,999.99'
  846    º  ³    @ 05, 06 say m.cedula  ;
  847    º  ³        picture '!-99999999'
  848    º  ³    @ 06, 00 say  ;
  849    º  ³        'ALUMNO:                                               ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼ '
  850    º  ³    @ 06, 08 say m.nombres  ;
  851    º  ³        picture '@!s45'
  852    º  ³    @ 07, 00 say  ;
  853    º  ³        'SEMESTRE: ' +  ;
  854    º  ³        m.semestre
  855    º  ³    @ 08, 00 say  ;
  856    º  ³        'TURNO   : ' +  ;
  857    º  ³        m.turno
  858    º  ³    @ 09, 00 say  ;
  859    º  ³        'PLAN    : ' + mdes1
  860    º  ³    xcantidad = letras(mmontop)
  861    º  ³    xcantidad = alltrim(xcantidad)
  862    º  ³    @ 10, 00 say  ;
  863    º  ³        'Hemos recibido la cantidad de:'
  864    º  ³    @ 11, 00 say xcantidad  ;
  865    º  ³        picture '@!'
  866    º  ³    li = 12
  867    º  ³    @ li, 00 say  ;
  868    º  ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ' +  ;
  869    º  ³        ng
  870    º  ³    li = li + 1
  871    º  ³    @ li, 00 say  ;
  872    º  ³        '  C O N C E P T O S                   S A L D O              M O N T O       ' +  ;
  873    º  ³        ngn
  874    º  ³    li = li + 1
  875    º  ³    @ li, 00 say  ;
  876    º  ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ'
  877    º  ³    mpagado = mmontop
  878    º  ³    ii = 1
  879    º  ³    li = li + 1
  880    º  ³    xsaldo = 0
  881    º  ³  ÖÄfor ii = 1 to xnro
  882    º  ³  º    lk = ltrim(str(ii))
  883    º  ³  º  ÚÄif pagado&lk>=cuota&lk
  884    º  ³  ^ÍÍÍÍÍÍÍloop
  885    º  ³  º  ÀÄendif
  886    º  ³  º    select 2
  887    º  ³  º  ÚÄif (mpagado+pagado&lk);
  888    º  ³  º  ³        >= cuota&lk
  889    º  ³  º  ³    select 11
  890    º  ³  º  ³    set order to codcuota
  891    º  ³  º  ³    locate for  ;
  892    º  ³  º  ³        lapso =  ;
  893    º  ³  º  ³        lapmat  ;
  894    º  ³  º  ³        .and.  ;
  895    º  ³  º  ³        codigo =  ;
  896    º  ³  º  ³        m.plancobro  ;
  897    º  ³  º  ³        .and.  ;
  898    º  ³  º  ³        cuota =  ;
  899    º  ³  º  ³        ii
  900    º  ³  º  ³    xpagado=(cuota&lk-pagado&lk)
  901    º  ³  º  ³    mpagado=mpagado-(cuota&lk-pagado&lk)
  902    º  ³  º  ³  ÖÄfor ww = 1 to  ;
  903    º  ³  º  ³  º        10
  904    º  ³  º  ³  º    lw = ltrim(str(ww))
  905    º  ³  º  ³  º    select 11
  906    º  ³  º  ³  º  ÚÄif concepto&lw=space(2)
  907    º  ³  º  ³  ^ÍÍÍÍÍÍÍloop
  908    º  ³  º  ³  º  ÀÄendif
  909    º  ³  º  ³  º    mcon=concepto&lw
  910    º  ³  º  ³  º    mmon=monto&lw
  911    º  ³  º  ³  º    select 12
  912    º  ³  º  ³  º  ÚÄif  .not.  ;
  913    º  ³  º  ³  º  ³        seek(mcon)
  914    º  ³  º  ³  º  ³    mds =  ;
  915    º  ³  º  ³  º  ³        'SIN DESCRIPCION'
  916    º  ³  º  ³  º  ÃÄelse
  917    º  ³  º  ³  º  ³    mds =  ;
  918    º  ³  º  ³  º  ³        alltrim(descripcio)
  919    º  ³  º  ³  º  ÀÄendif
  920    º  ³  º  ³  º  ÚÄif mdec1 >=  ;
  921    º  ³  º  ³  º  ³        1  ;
  922    º  ³  º  ³  º  ³        .and.  ;
  923    º  ³  º  ³  º  ³        lin1 =  ;
  924    º  ³  º  ³  º  ³        0  ;
  925    º  ³  º  ³  º  ³        .and.  ;
  926    º  ³  º  ³  º  ³        ww =  ;
  927    º  ³  º  ³  º  ³        1
  928    º  ³  º  ³  º  ³    @ li,  ;
  929    º  ³  º  ³  º  ³        00  ;
  930    º  ³  º  ³  º  ³        say  ;
  931    º  ³  º  ³  º  ³        'CANCELACION MENSUALIDAD MATERIA ADICIONAL:'
  932    º  ³  º  ³  º  ³    lin1 =  ;
  933    º  ³  º  ³  º  ³        1
  934    º  ³  º  ³  º  ³    li =  ;
  935    º  ³  º  ³  º  ³        li +  ;
  936    º  ³  º  ³  º  ³        1
  937    º  ³  º  ³  º  ÀÄendif
  938    º  ³  º  ³  º  ÚÄif mdec1 >=  ;
  939    º  ³  º  ³  º  ³        1  ;
  940    º  ³  º  ³  º  ³        .and.  ;
  941    º  ³  º  ³  º  ³        mdec2 >=  ;
  942    º  ³  º  ³  º  ³        1  ;
  943    º  ³  º  ³  º  ³        .and.  ;
  944    º  ³  º  ³  º  ³        lin2 =  ;
  945    º  ³  º  ³  º  ³        1  ;
  946    º  ³  º  ³  º  ³        .and.  ;
  947    º  ³  º  ³  º  ³        ww =  ;
  948    º  ³  º  ³  º  ³        1
  949    º  ³  º  ³  º  ³    @ li,  ;
  950    º  ³  º  ³  º  ³        00  ;
  951    º  ³  º  ³  º  ³        say  ;
  952    º  ³  º  ³  º  ³        'ABONO MENSUALIDAD MATERIA ADICIONAL:'
  953    º  ³  º  ³  º  ³    lin2 =  ;
  954    º  ³  º  ³  º  ³        0
  955    º  ³  º  ³  º  ³    li =  ;
  956    º  ³  º  ³  º  ³        li +  ;
  957    º  ³  º  ³  º  ³        1
  958    º  ³  º  ³  º  ÀÄendif
  959    º  ³  º  ³  º  ÚÄif mdec1 =  ;
  960    º  ³  º  ³  º  ³        0  ;
  961    º  ³  º  ³  º  ³        .and.  ;
  962    º  ³  º  ³  º  ³        mdec2 >=  ;
  963    º  ³  º  ³  º  ³        1  ;
  964    º  ³  º  ³  º  ³        .and.  ;
  965    º  ³  º  ³  º  ³        lin3 =  ;
  966    º  ³  º  ³  º  ³        0  ;
  967    º  ³  º  ³  º  ³        .and.  ;
  968    º  ³  º  ³  º  ³        ww =  ;
  969    º  ³  º  ³  º  ³        1
  970    º  ³  º  ³  º  ³    @ li,  ;
  971    º  ³  º  ³  º  ³        00  ;
  972    º  ³  º  ³  º  ³        say  ;
  973    º  ³  º  ³  º  ³        'ABONO MENSUALIDAD MATERIA ADICIONAL:'
  974    º  ³  º  ³  º  ³    li =  ;
  975    º  ³  º  ³  º  ³        li +  ;
  976    º  ³  º  ³  º  ³        1
  977    º  ³  º  ³  º  ³    lin3 =  ;
  978    º  ³  º  ³  º  ³        1
  979    º  ³  º  ³  º  ÀÄendif
  980    º  ³  º  ³  º  ÚÄif ww =  ;
  981    º  ³  º  ³  º  ³        1
  982    º  ³  º  ³  º  ³    @ li,  ;
  983    º  ³  º  ³  º  ³        02  ;
  984    º  ³  º  ³  º  ³        say  ;
  985    º  ³  º  ³  º  ³        mds  ;
  986    º  ³  º  ³  º  ³        picture  ;
  987    º  ³  º  ³  º  ³        '@!S32'
  988    º  ³  º  ³  º  ³    tu =  ;
  989    º  ³  º  ³  º  ³        tu +  ;
  990    º  ³  º  ³  º  ³        1
  991    º  ³  º  ³  º  ÃÄelse
  992    º  ³  º  ³  º  ³    @ li,  ;
  993    º  ³  º  ³  º  ³        05  ;
  994    º  ³  º  ³  º  ³        say  ;
  995    º  ³  º  ³  º  ³        mds  ;
  996    º  ³  º  ³  º  ³        picture  ;
  997    º  ³  º  ³  º  ³        '@!S29'
  998    º  ³  º  ³  º  ÀÄendif
  999    º  ³  º  ³  º  ÚÄif mpsaldo&lk;
 1000    º  ³  º  ³  º  ³        > 0 and ww=1
 1001    º  ³  º  ³  º  ³    @ li,  ;
 1002    º  ³  º  ³  º  ³        36  ;
 1003    º  ³  º  ³  º  ³        say  ;
 1004    º  ³  º  ³  º  ³        '('
 1005    º  ³  º  ³  º  ³    @li,38 say;
 1006    º  ³  º  ³  º  ³        mpsaldo&lk pict '9,999,999.99'
 1007    º  ³  º  ³  º  ³    @ li,  ;
 1008    º  ³  º  ³  º  ³        51  ;
 1009    º  ³  º  ³  º  ³        say  ;
 1010    º  ³  º  ³  º  ³        ')'
 1011    º  ³  º  ³  º  ÀÄendif
 1012    º  ³  º  ³  º  ÚÄif ww =  ;
 1013    º  ³  º  ³  º  ³        1
 1014    º  ³  º  ³  º  ³    select  ;
 1015    º  ³  º  ³  º  ³        2
 1016    º  ³  º  ³  º  ³    @li,58 say;
 1017    º  ³  º  ³  º  ³        mpagrec&lk pict '9,999,999.99'
 1018    º  ³  º  ³  º  ³    imp&lk=1
 1019    º  ³  º  ³  º  ÀÄendif
 1020    º  ³  º  ³  º  ÚÄif mdec2 >=  ;
 1021    º  ³  º  ³  º  ³        1  ;
 1022    º  ³  º  ³  º  ³        .and.  ;
 1023    º  ³  º  ³  º  ³        tu =  ;
 1024    º  ³  º  ³  º  ³        mdec1  ;
 1025    º  ³  º  ³  º  ³        .and.  ;
 1026    º  ³  º  ³  º  ³        ww =  ;
 1027    º  ³  º  ³  º  ³        1
 1028    º  ³  º  ³  º  ³    lin2 =  ;
 1029    º  ³  º  ³  º  ³        1
 1030    º  ³  º  ³  º  ÀÄendif
 1031    º  ³  º  ³  º    li = li +  ;
 1032    º  ³  º  ³  º        1
 1033    º  ³  º  ³  º  ÚÄif li >  ;
 1034    º  ³  º  ³  º  ³        20
 1035    º  ³  º  ³  º  ³    @ 22,  ;
 1036    º  ³  º  ³  º  ³        00  ;
 1037    º  ³  º  ³  º  ³        say  ;
 1038    º  ³  º  ³  º  ³        'ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»'
 1039    º  ³  º  ³  º  ³    @ 23,  ;
 1040    º  ³  º  ³  º  ³        00  ;
 1041    º  ³  º  ³  º  ³        say  ;
 1042    º  ³  º  ³  º  ³        'º            N O T A            º  EFECTIVO   [ ]   CHEQ/DEPOST [ ]           º'
 1043    º  ³  º  ³  º  ³  ÚÄif mtipop <>  ;
 1044    º  ³  º  ³  º  ³  ³        'Efectivo'
 1045    º  ³  º  ³  º  ³  ³    @ 23, 65 say 'X'
 1046    º  ³  º  ³  º  ³  ÃÄelse
 1047    º  ³  º  ³  º  ³  ³    @ 23, 47 say 'X'
 1048    º  ³  º  ³  º  ³  ÀÄendif
 1049    º  ³  º  ³  º  ³    @ 24,  ;
 1050    º  ³  º  ³  º  ³        00  ;
 1051    º  ³  º  ³  º  ³        say  ;
 1052    º  ³  º  ³  º  ³        'ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶  NRO. :                                     º'
 1053    º  ³  º  ³  º  ³    @ 24,  ;
 1054    º  ³  º  ³  º  ³        41  ;
 1055    º  ³  º  ³  º  ³        say  ;
 1056    º  ³  º  ³  º  ³        mnrode  ;
 1057    º  ³  º  ³  º  ³        picture  ;
 1058    º  ³  º  ³  º  ³        '@!'
 1059    º  ³  º  ³  º  ³    @ 25,  ;
 1060    º  ³  º  ³  º  ³        00  ;
 1061    º  ³  º  ³  º  ³        say  ;
 1062    º  ³  º  ³  º  ³        'º                               º  BANCO:                                     º'
 1063    º  ³  º  ³  º  ³    @ 25,  ;
 1064    º  ³  º  ³  º  ³        41  ;
 1065    º  ³  º  ³  º  ³        say  ;
 1066    º  ³  º  ³  º  ³        mbandes
 1067    º  ³  º  ³  º  ³    @ 26,  ;
 1068    º  ³  º  ³  º  ³        00  ;
 1069    º  ³  º  ³  º  ³        say  ;
 1070    º  ³  º  ³  º  ³        'º                               º                                             º'
 1071    º  ³  º  ³  º  ³    @ 26,  ;
 1072    º  ³  º  ³  º  ³        05  ;
 1073    º  ³  º  ³  º  ³        say  ;
 1074    º  ³  º  ³  º  ³        'CONTINUA ....'
 1075    º  ³  º  ³  º  ³    @ 27,  ;
 1076    º  ³  º  ³  º  ³        00  ;
 1077    º  ³  º  ³  º  ³        say  ;
 1078    º  ³  º  ³  º  ³        'º                               º                        ___________________  º'
 1079    º  ³  º  ³  º  ³    @ 28,  ;
 1080    º  ³  º  ³  º  ³        00  ;
 1081    º  ³  º  ³  º  ³        say  ;
 1082    º  ³  º  ³  º  ³        'º                               º                           RECIBIDO POR:     º'
 1083    º  ³  º  ³  º  ³    @ 29,  ;
 1084    º  ³  º  ³  º  ³        00  ;
 1085    º  ³  º  ³  º  ³        say  ;
 1086    º  ³  º  ³  º  ³        'ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼'
 1087    º  ³  º  ³  º  ³    @ 30,  ;
 1088    º  ³  º  ³  º  ³        00  ;
 1089    º  ³  º  ³  º  ³        say  ;
 1090    º  ³  º  ³  º  ³        ' NOTA: Los Pagos Realizados no estan sujetos a devoluciones'
 1091    º  ³  º  ³  º  ³    select  ;
 1092    º  ³  º  ³  º  ³        9
 1093    º  ³  º  ³  º  ³    @ 0,  ;
 1094    º  ³  º  ³  º  ³        1  ;
 1095    º  ³  º  ³  º  ³        say  ;
 1096    º  ³  º  ³  º  ³        '  ' +  ;
 1097    º  ³  º  ³  º  ³        chr(27) +  ;
 1098    º  ³  º  ³  º  ³        chr(67) +  ;
 1099    º  ³  º  ³  º  ³        chr(33)
 1100    º  ³  º  ³  º  ³    @ 00,  ;
 1101    º  ³  º  ³  º  ³        00  ;
 1102    º  ³  º  ³  º  ³        say  ;
 1103    º  ³  º  ³  º  ³        chr(18) +  ;
 1104    º  ³  º  ³  º  ³        chr(20)
 1105    º  ³  º  ³  º  ³    @ 00,  ;
 1106    º  ³  º  ³  º  ³        00  ;
 1107    º  ³  º  ³  º  ³        say  ;
 1108    º  ³  º  ³  º  ³        chr(14) +  ;
 1109    º  ³  º  ³  º  ³        chr(15) +  ;
 1110    º  ³  º  ³  º  ³        titulo +  ;
 1111    º  ³  º  ³  º  ³        chr(18) +  ;
 1112    º  ³  º  ³  º  ³        chr(20) +  ;
 1113    º  ³  º  ³  º  ³        ' '
 1114    º  ³  º  ³  º  ³    @ 01,  ;
 1115    º  ³  º  ³  º  ³        00  ;
 1116    º  ³  º  ³  º  ³        say  ;
 1117    º  ³  º  ³  º  ³        'RIF .                                                   RECIBO Nro.:          '
 1118    º  ³  º  ³  º  ³    @ 01,  ;
 1119    º  ³  º  ³  º  ³        04  ;
 1120    º  ³  º  ³  º  ³        say  ;
 1121    º  ³  º  ³  º  ³        l_rif
 1122    º  ³  º  ³  º  ³    @ 01,  ;
 1123    º  ³  º  ³  º  ³        68  ;
 1124    º  ³  º  ³  º  ³        say  ;
 1125    º  ³  º  ³  º  ³        chr(14) +  ;
 1126    º  ³  º  ³  º  ³        ng +  ;
 1127    º  ³  º  ³  º  ³        ltrim(str(mrecibo)) +  ;
 1128    º  ³  º  ³  º  ³        ngn
 1129    º  ³  º  ³  º  ³    @ 02,  ;
 1130    º  ³  º  ³  º  ³        00  ;
 1131    º  ³  º  ³  º  ³        say  ;
 1132    º  ³  º  ³  º  ³        chr(15) +  ;
 1133    º  ³  º  ³  º  ³        ' '
 1134    º  ³  º  ³  º  ³    @ 02,  ;
 1135    º  ³  º  ³  º  ³        00  ;
 1136    º  ³  º  ³  º  ³        say  ;
 1137    º  ³  º  ³  º  ³        l_direccio
 1138    º  ³  º  ³  º  ³    @ 02,  ;
 1139    º  ³  º  ³  º  ³        pcol()  ;
 1140    º  ³  º  ³  º  ³        say  ;
 1141    º  ³  º  ³  º  ³        chr(18) +  ;
 1142    º  ³  º  ³  º  ³        chr(20) +  ;
 1143    º  ³  º  ³  º  ³        ' '
 1144    º  ³  º  ³  º  ³    @ 02,  ;
 1145    º  ³  º  ³  º  ³        00  ;
 1146    º  ³  º  ³  º  ³        say  ;
 1147    º  ³  º  ³  º  ³        '                                                        FECHA PAGO:          '
 1148    º  ³  º  ³  º  ³    @ 02,  ;
 1149    º  ³  º  ³  º  ³        68  ;
 1150    º  ³  º  ³  º  ³        say  ;
 1151    º  ³  º  ³  º  ³        mfechap  ;
 1152    º  ³  º  ³  º  ³        picture  ;
 1153    º  ³  º  ³  º  ³        '@E'
 1154    º  ³  º  ³  º  ³    @ 03,  ;
 1155    º  ³  º  ³  º  ³        00  ;
 1156    º  ³  º  ³  º  ³        say  ;
 1157    º  ³  º  ³  º  ³        '                                                      '
 1158    º  ³  º  ³  º  ³    @ 03,  ;
 1159    º  ³  º  ³  º  ³        28  ;
 1160    º  ³  º  ³  º  ³        say  ;
 1161    º  ³  º  ³  º  ³        chr(14) +  ;
 1162    º  ³  º  ³  º  ³        chr(15) +  ;
 1163    º  ³  º  ³  º  ³        'RECIBO DE PAGO' +  ;
 1164    º  ³  º  ³  º  ³        chr(18) +  ;
 1165    º  ³  º  ³  º  ³        chr(20) +  ;
 1166    º  ³  º  ³  º  ³        ' '
 1167    º  ³  º  ³  º  ³    @ 04,  ;
 1168    º  ³  º  ³  º  ³        00  ;
 1169    º  ³  º  ³  º  ³        say  ;
 1170    º  ³  º  ³  º  ³        '                                                      ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ» '
 1171    º  ³  º  ³  º  ³    @ 05,  ;
 1172    º  ³  º  ³  º  ³        00  ;
 1173    º  ³  º  ³  º  ³        say  ;
 1174    º  ³  º  ³  º  ³        'C.I.:                                                 º Bs.                º '
 1175    º  ³  º  ³  º  ³    @ 05,  ;
 1176    º  ³  º  ³  º  ³        61  ;
 1177    º  ³  º  ³  º  ³        say  ;
 1178    º  ³  º  ³  º  ³        mmontop  ;
 1179    º  ³  º  ³  º  ³        picture  ;
 1180    º  ³  º  ³  º  ³        '9,999,999.99'
 1181    º  ³  º  ³  º  ³    @ 05,  ;
 1182    º  ³  º  ³  º  ³        06  ;
 1183    º  ³  º  ³  º  ³        say  ;
 1184    º  ³  º  ³  º  ³        m.cedula  ;
 1185    º  ³  º  ³  º  ³        picture  ;
 1186    º  ³  º  ³  º  ³        '!-99999999'
 1187    º  ³  º  ³  º  ³    @ 06,  ;
 1188    º  ³  º  ³  º  ³        00  ;
 1189    º  ³  º  ³  º  ³        say  ;
 1190    º  ³  º  ³  º  ³        'ALUMNO:                                               ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼ '
 1191    º  ³  º  ³  º  ³    @ 06,  ;
 1192    º  ³  º  ³  º  ³        08  ;
 1193    º  ³  º  ³  º  ³        say  ;
 1194    º  ³  º  ³  º  ³        m.nombres  ;
 1195    º  ³  º  ³  º  ³        picture  ;
 1196    º  ³  º  ³  º  ³        '@!s45'
 1197    º  ³  º  ³  º  ³    @ 07,  ;
 1198    º  ³  º  ³  º  ³        00  ;
 1199    º  ³  º  ³  º  ³        say  ;
 1200    º  ³  º  ³  º  ³        'SEMESTRE: ' +  ;
 1201    º  ³  º  ³  º  ³        m.semestre
 1202    º  ³  º  ³  º  ³    @ 08,  ;
 1203    º  ³  º  ³  º  ³        00  ;
 1204    º  ³  º  ³  º  ³        say  ;
 1205    º  ³  º  ³  º  ³        'TURNO   : ' +  ;
 1206    º  ³  º  ³  º  ³        m.turno
 1207    º  ³  º  ³  º  ³    @ 09,  ;
 1208    º  ³  º  ³  º  ³        00  ;
 1209    º  ³  º  ³  º  ³        say  ;
 1210    º  ³  º  ³  º  ³        'PLAN    : ' +  ;
 1211    º  ³  º  ³  º  ³        mdes1
 1212    º  ³  º  ³  º  ³    xcantidad =  ;
 1213    º  ³  º  ³  º  ³        letras(mmontop)
 1214    º  ³  º  ³  º  ³    xcantidad =  ;
 1215    º  ³  º  ³  º  ³        alltrim(xcantidad)
 1216    º  ³  º  ³  º  ³    @ 10,  ;
 1217    º  ³  º  ³  º  ³        00  ;
 1218    º  ³  º  ³  º  ³        say  ;
 1219    º  ³  º  ³  º  ³        'Hemos recibido la cantidad de:'
 1220    º  ³  º  ³  º  ³    @ 11,  ;
 1221    º  ³  º  ³  º  ³        00  ;
 1222    º  ³  º  ³  º  ³        say  ;
 1223    º  ³  º  ³  º  ³        xcantidad  ;
 1224    º  ³  º  ³  º  ³        picture  ;
 1225    º  ³  º  ³  º  ³        '@!'
 1226    º  ³  º  ³  º  ³    li =  ;
 1227    º  ³  º  ³  º  ³        12
 1228    º  ³  º  ³  º  ³    @ li,  ;
 1229    º  ³  º  ³  º  ³        00  ;
 1230    º  ³  º  ³  º  ³        say  ;
 1231    º  ³  º  ³  º  ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ' +  ;
 1232    º  ³  º  ³  º  ³        ng
 1233    º  ³  º  ³  º  ³    li =  ;
 1234    º  ³  º  ³  º  ³        li +  ;
 1235    º  ³  º  ³  º  ³        1
 1236    º  ³  º  ³  º  ³    @ li,  ;
 1237    º  ³  º  ³  º  ³        00  ;
 1238    º  ³  º  ³  º  ³        say  ;
 1239    º  ³  º  ³  º  ³        '  C O N C E P T O S                   S A L D O              M O N T O       ' +  ;
 1240    º  ³  º  ³  º  ³        ngn
 1241    º  ³  º  ³  º  ³    li =  ;
 1242    º  ³  º  ³  º  ³        li +  ;
 1243    º  ³  º  ³  º  ³        1
 1244    º  ³  º  ³  º  ³    @ li,  ;
 1245    º  ³  º  ³  º  ³        00  ;
 1246    º  ³  º  ³  º  ³        say  ;
 1247    º  ³  º  ³  º  ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ'
 1248    º  ³  º  ³  º  ³    li =  ;
 1249    º  ³  º  ³  º  ³        li +  ;
 1250    º  ³  º  ³  º  ³        1
 1251    º  ³  º  ³  º  ÀÄendif
 1252    º  ³  º  ³  ÓÄendfor
 1253    º  ³  º  ÃÄelse
 1254    º  ³  º  ³  ÚÄif mpagado >  ;
 1255    º  ³  º  ³  ³        0
 1256    º  ³  º  ³  ³    select 11
 1257    º  ³  º  ³  ³    set order to;
 1258    º  ³  º  ³  ³        codcuota
 1259    º  ³  º  ³  ³    locate for  ;
 1260    º  ³  º  ³  ³        lapso =  ;
 1261    º  ³  º  ³  ³        lapmat  ;
 1262    º  ³  º  ³  ³        .and.  ;
 1263    º  ³  º  ³  ³        codigo =  ;
 1264    º  ³  º  ³  ³        m.plancobro  ;
 1265    º  ³  º  ³  ³        .and.  ;
 1266    º  ³  º  ³  ³        cuota =  ;
 1267    º  ³  º  ³  ³        ii
 1268    º  ³  º  ³  ³    xpagado=pagado&lk+mpagado
 1269    º  ³  º  ³  ³  ÖÄfor ww =  ;
 1270    º  ³  º  ³  ³  º        1 to  ;
 1271    º  ³  º  ³  ³  º        10
 1272    º  ³  º  ³  ³  º    lw =  ;
 1273    º  ³  º  ³  ³  º        ltrim(str(ww))
 1274    º  ³  º  ³  ³  º    select  ;
 1275    º  ³  º  ³  ³  º        11
 1276    º  ³  º  ³  ³  º  ÚÄif concepto&lw=space(2)
 1277    º  ³  º  ³  ³  ^ÍÍÍÍÍÍÍloop
 1278    º  ³  º  ³  ³  º  ÀÄendif
 1279    º  ³  º  ³  ³  º    mcon=concepto&lw
 1280    º  ³  º  ³  ³  º    mmon=monto&lw
 1281    º  ³  º  ³  ³  º    select  ;
 1282    º  ³  º  ³  ³  º        12
 1283    º  ³  º  ³  ³  º  ÚÄif   ;
 1284    º  ³  º  ³  ³  º  ³        .not.  ;
 1285    º  ³  º  ³  ³  º  ³        seek(mcon)
 1286    º  ³  º  ³  ³  º  ³    mds = 'SIN DESCRIPCION'
 1287    º  ³  º  ³  ³  º  ÃÄelse
 1288    º  ³  º  ³  ³  º  ³    mds = alltrim(descripcio)
 1289    º  ³  º  ³  ³  º  ÀÄendif
 1290    º  ³  º  ³  ³  º  ÚÄif mdec1 >=  ;
 1291    º  ³  º  ³  ³  º  ³        1  ;
 1292    º  ³  º  ³  ³  º  ³        .and.  ;
 1293    º  ³  º  ³  ³  º  ³        lin1 =  ;
 1294    º  ³  º  ³  ³  º  ³        0  ;
 1295    º  ³  º  ³  ³  º  ³        .and.  ;
 1296    º  ³  º  ³  ³  º  ³        ww =  ;
 1297    º  ³  º  ³  ³  º  ³        1
 1298    º  ³  º  ³  ³  º  ³    @ li, 00 say 'CANCELACION MENSUALIDAD MATERIA ADICIONAL:'
 1299    º  ³  º  ³  ³  º  ³    lin1 = 1
 1300    º  ³  º  ³  ³  º  ³    li = li + 1
 1301    º  ³  º  ³  ³  º  ÀÄendif
 1302    º  ³  º  ³  ³  º  ÚÄif mdec1 >=  ;
 1303    º  ³  º  ³  ³  º  ³        1  ;
 1304    º  ³  º  ³  ³  º  ³        .and.  ;
 1305    º  ³  º  ³  ³  º  ³        mdec2 >=  ;
 1306    º  ³  º  ³  ³  º  ³        1  ;
 1307    º  ³  º  ³  ³  º  ³        .and.  ;
 1308    º  ³  º  ³  ³  º  ³        lin2 =  ;
 1309    º  ³  º  ³  ³  º  ³        1  ;
 1310    º  ³  º  ³  ³  º  ³        .and.  ;
 1311    º  ³  º  ³  ³  º  ³        ww =  ;
 1312    º  ³  º  ³  ³  º  ³        1
 1313    º  ³  º  ³  ³  º  ³    @ li, 00 say 'ABONO MENSUALIDAD MATERIA ADICIONAL:'
 1314    º  ³  º  ³  ³  º  ³    li = li + 1
 1315    º  ³  º  ³  ³  º  ³    lin2 = 0
 1316    º  ³  º  ³  ³  º  ÀÄendif
 1317    º  ³  º  ³  ³  º  ÚÄif mdec1 =  ;
 1318    º  ³  º  ³  ³  º  ³        0  ;
 1319    º  ³  º  ³  ³  º  ³        .and.  ;
 1320    º  ³  º  ³  ³  º  ³        mdec2 >=  ;
 1321    º  ³  º  ³  ³  º  ³        1  ;
 1322    º  ³  º  ³  ³  º  ³        .and.  ;
 1323    º  ³  º  ³  ³  º  ³        lin3 =  ;
 1324    º  ³  º  ³  ³  º  ³        0  ;
 1325    º  ³  º  ³  ³  º  ³        .and.  ;
 1326    º  ³  º  ³  ³  º  ³        ww =  ;
 1327    º  ³  º  ³  ³  º  ³        1
 1328    º  ³  º  ³  ³  º  ³    @ li, 00 say 'ABONO MENSUALIDAD MATERIA ADICIONAL:'
 1329    º  ³  º  ³  ³  º  ³    li = li + 1
 1330    º  ³  º  ³  ³  º  ³    lin3 = 1
 1331    º  ³  º  ³  ³  º  ÀÄendif
 1332    º  ³  º  ³  ³  º  ÚÄif ww =  ;
 1333    º  ³  º  ³  ³  º  ³        1
 1334    º  ³  º  ³  ³  º  ³    @ li, 02 say mds picture '@!S32'
 1335    º  ³  º  ³  ³  º  ³    tu = tu + 1
 1336    º  ³  º  ³  ³  º  ÃÄelse
 1337    º  ³  º  ³  ³  º  ³    @ li, 05 say mds picture '@!S29'
 1338    º  ³  º  ³  ³  º  ÀÄendif
 1339    º  ³  º  ³  ³  º    select  ;
 1340    º  ³  º  ³  ³  º        2
 1341    º  ³  º  ³  ³  º  ÚÄif mpsaldo&lk;
 1342    º  ³  º  ³  ³  º  ³        > 0 and ww=1
 1343    º  ³  º  ³  ³  º  ³    @ li, 36 say '('
 1344    º  ³  º  ³  ³  º  ³    @li,38 say mpsaldo&lk pict '9,999,999.99'
 1345    º  ³  º  ³  ³  º  ³    @ li, 51 say ')'
 1346    º  ³  º  ³  ³  º  ÀÄendif
 1347    º  ³  º  ³  ³  º  ÚÄif ww =  ;
 1348    º  ³  º  ³  ³  º  ³        1
 1349    º  ³  º  ³  ³  º  ³    @li,58 say mpagrec&lk pict '9,999,999.99'
 1350    º  ³  º  ³  ³  º  ÀÄendif
 1351    º  ³  º  ³  ³  º  ÚÄif mdec2 >=  ;
 1352    º  ³  º  ³  ³  º  ³        1  ;
 1353    º  ³  º  ³  ³  º  ³        .and.  ;
 1354    º  ³  º  ³  ³  º  ³        tu =  ;
 1355    º  ³  º  ³  ³  º  ³        mdec1  ;
 1356    º  ³  º  ³  ³  º  ³        .and.  ;
 1357    º  ³  º  ³  ³  º  ³        ww =  ;
 1358    º  ³  º  ³  ³  º  ³        1
 1359    º  ³  º  ³  ³  º  ³    lin2 = 1
 1360    º  ³  º  ³  ³  º  ÀÄendif
 1361    º  ³  º  ³  ³  º    li =  ;
 1362    º  ³  º  ³  ³  º        li +  ;
 1363    º  ³  º  ³  ³  º        1
 1364    º  ³  º  ³  ³  º  ÚÄif li >  ;
 1365    º  ³  º  ³  ³  º  ³        20
 1366    º  ³  º  ³  ³  º  ³    @ 22, 00 say 'ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»'
 1367    º  ³  º  ³  ³  º  ³    @ 23, 00 say 'º            N O T A            º  EFECTIVO   [ ]   CHEQ/DEPOST [ ]           º'
 1368    º  ³  º  ³  ³  º  ³  ÚÄif mtipop <> 'Efectivo'
 1369    º  ³  º  ³  ³  º  ³  ³    @ 23, 65 say 'X'
 1370    º  ³  º  ³  ³  º  ³  ÃÄelse
 1371    º  ³  º  ³  ³  º  ³  ³    @ 23, 47 say 'X'
 1372    º  ³  º  ³  ³  º  ³  ÀÄendif
 1373    º  ³  º  ³  ³  º  ³    @ 24, 00 say 'ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶  NRO. :                                     º'
 1374    º  ³  º  ³  ³  º  ³    @ 24, 41 say mnrode picture '@!'
 1375    º  ³  º  ³  ³  º  ³    @ 25, 00 say 'º                               º  BANCO:                                     º'
 1376    º  ³  º  ³  ³  º  ³    @ 25, 41 say mbandes
 1377    º  ³  º  ³  ³  º  ³    @ 26, 00 say 'º                               º                                             º'
 1378    º  ³  º  ³  ³  º  ³    @ 26, 05 say 'CONTINUA ....'
 1379    º  ³  º  ³  ³  º  ³    @ 27, 00 say 'º                               º                        ___________________  º'
 1380    º  ³  º  ³  ³  º  ³    @ 28, 00 say 'º                               º                           RECIBIDO POR:     º'
 1381    º  ³  º  ³  ³  º  ³    @ 29, 00 say 'ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼'
 1382    º  ³  º  ³  ³  º  ³    @ 30, 00 say ' NOTA: Los Pagos Realizados no estan sujetos a devoluciones'
 1383    º  ³  º  ³  ³  º  ³    select 9
 1384    º  ³  º  ³  ³  º  ³    @ 0, 1 say '  ' + chr(27) + chr(67) + chr(33)
 1385    º  ³  º  ³  ³  º  ³    @ 00, 00 say chr(18) + chr(20)
 1386    º  ³  º  ³  ³  º  ³    @ 00, 00 say chr(14) + chr(15) + titulo + chr(18) + chr(20) + ' '
 1387    º  ³  º  ³  ³  º  ³    @ 01, 00 say 'RIF .                                                   RECIBO Nro.:          '
 1388    º  ³  º  ³  ³  º  ³    @ 01, 04 say l_rif
 1389    º  ³  º  ³  ³  º  ³    @ 01, 68 say chr(14) + ng + ltrim(str(mrecibo)) + ngn
 1390    º  ³  º  ³  ³  º  ³    @ 02, 00 say chr(15) + ' '
 1391    º  ³  º  ³  ³  º  ³    @ 02, 00 say l_direccio
 1392    º  ³  º  ³  ³  º  ³    @ 02, pcol() say chr(18) + chr(20) + ' '
 1393    º  ³  º  ³  ³  º  ³    @ 02, 00 say '                                                        FECHA PAGO:          '
 1394    º  ³  º  ³  ³  º  ³    @ 02, 68 say mfechap picture '@E'
 1395    º  ³  º  ³  ³  º  ³    @ 03, 00 say '                                                      '
 1396    º  ³  º  ³  ³  º  ³    @ 03, 28 say chr(14) + chr(15) + 'RECIBO DE PAGO' + chr(18) + chr(20) + ' '
 1397    º  ³  º  ³  ³  º  ³    @ 04, 00 say '                                                      ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ» '
 1398    º  ³  º  ³  ³  º  ³    @ 05, 00 say 'C.I.:                                                 º Bs.                º '
 1399    º  ³  º  ³  ³  º  ³    @ 05, 61 say mmontop picture '9,999,999.99'
 1400    º  ³  º  ³  ³  º  ³    @ 05, 06 say m.cedula picture '!-99999999'
 1401    º  ³  º  ³  ³  º  ³    @ 06, 00 say 'ALUMNO:                                               ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼ '
 1402    º  ³  º  ³  ³  º  ³    @ 06, 08 say m.nombres picture '@!s45'
 1403    º  ³  º  ³  ³  º  ³    @ 07, 00 say 'SEMESTRE: ' + m.semestre
 1404    º  ³  º  ³  ³  º  ³    @ 08, 00 say 'TURNO   : ' + m.turno
 1405    º  ³  º  ³  ³  º  ³    @ 08, pcol() + 2 say m.representa picture '@!'
 1406    º  ³  º  ³  ³  º  ³    @ 09, 00 say 'PLAN    : ' + mdes1
 1407    º  ³  º  ³  ³  º  ³    xcantidad = letras(mmontop)
 1408    º  ³  º  ³  ³  º  ³    xcantidad = alltrim(xcantidad)
 1409    º  ³  º  ³  ³  º  ³    @ 10, 00 say 'Hemos recibido la cantidad de:'
 1410    º  ³  º  ³  ³  º  ³    @ 11, 00 say xcantidad picture '@!'
 1411    º  ³  º  ³  ³  º  ³    li = 12
 1412    º  ³  º  ³  ³  º  ³    @ li, 00 say 'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ' + ng
 1413    º  ³  º  ³  ³  º  ³    li = li + 1
 1414    º  ³  º  ³  ³  º  ³    @ li, 00 say '  C O N C E P T O S                                          M O N T O       ' + ngn
 1415    º  ³  º  ³  ³  º  ³    li = li + 1
 1416    º  ³  º  ³  ³  º  ³    @ li, 00 say 'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ'
 1417    º  ³  º  ³  ³  º  ³    li = li + 1
 1418    º  ³  º  ³  ³  º  ÀÄendif
 1419    º  ³  º  ³  ³  ÓÄendfor
 1420    º  ³  º  ³  ÀÄendif
 1421    º  ³  vÍÍÍÍÍÍÍexit
 1422    º  ³  º  ÀÄendif
 1423    º  ³  ÓÄendfor
 1424    º  ³    @ 22, 00 say  ;
 1425    º  ³        'ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»'
 1426    º  ³    @ 23, 00 say  ;
 1427    º  ³        'º            N O T A            º  EFECTIVO   [ ]   CHEQ/DEPOST [ ]           º'
 1428    º  ³  ÚÄif mtipop <> 'Efectivo'
 1429    º  ³  ³    @ 23, 65 say 'X'
 1430    º  ³  ÃÄelse
 1431    º  ³  ³    @ 23, 47 say 'X'
 1432    º  ³  ÀÄendif
 1433    º  ³    @ 24, 00 say  ;
 1434    º  ³        'ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶  NRO. :                                     º'
 1435    º  ³    @ 24, 41 say mnrode  ;
 1436    º  ³        picture '@!'
 1437    º  ³    @ 25, 00 say  ;
 1438    º  ³        'º                               º  BANCO:                                     º'
 1439    º  ³    @ 25, 41 say mbandes
 1440    º  ³    @ 26, 00 say  ;
 1441    º  ³        'º                               º                                             º'
 1442    º  ³    @ 27, 00 say  ;
 1443    º  ³        'º                               º                        ___________________  º'
 1444    º  ³    @ 28, 00 say  ;
 1445    º  ³        'º                               º                           RECIBIDO POR:     º'
 1446    º  ³    @ 29, 00 say  ;
 1447    º  ³        'ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼'
 1448    º  ³    @ 30, 00 say  ;
 1449    º  ³        ' NOTA: Los Pagos Realizados no estan sujetos a devoluciones'
 1450    º  ³    eject
 1451    º  ³    set device to screen
 1452    º  ³    @ 22, 00
 1453    º  ³    @ 22, 03 say  ;
 1454    º  ³        'F1 = HELP'
 1455    º  ³    @ 22, 25 say  ;
 1456    º  ³        'F3 = REIMPRIMIR RECIBO'
 1457    º  ³    @ 22, 58 say  ;
 1458    º  ³        'ENTER = CONTINUAR'
 1459    º  ³    on key label f3 do repite_recibo
 1460    º  ³    read
 1461    º  ³    set device to screen
 1462    º  ÀÄendif
 1463    º    select 2
 1464    º    mpagado = mmontop
 1465    º    ii = 1
 1466    º  ÖÄfor ii = 1 to xnro
 1467    º  º    lk = ltrim(str(ii))
 1468    º  º  ÚÄif pagado&lk=cuota&lk
 1469    º  ^ÍÍÍÍÍÍÍloop
 1470    º  º  ÀÄendif
 1471    º  º  ÚÄif (mpagado+pagado&lk) >= cuota&lk
 1472    º  º  ³    xpagado=(cuota&lk-pagado&lk)
 1473    º  º  ³    select 9
 1474    º  º  ³  ÉÍdo while .t.
 1475    º  º  ³  º  ÚÄif flock()
 1476    º  º  ³  º  ³    append blank
 1477    º  º  ³  º  ³    replace recibo  ;
 1478    º  º  ³  º  ³        with  ;
 1479    º  º  ³  º  ³        mrecibo,  ;
 1480    º  º  ³  º  ³        cedula  ;
 1481    º  º  ³  º  ³        with  ;
 1482    º  º  ³  º  ³        m.cedula
 1483    º  º  ³  º  ³    replace curso  ;
 1484    º  º  ³  º  ³        with  ;
 1485    º  º  ³  º  ³        m.cur,  ;
 1486    º  º  ³  º  ³        plancobro  ;
 1487    º  º  ³  º  ³        with  ;
 1488    º  º  ³  º  ³        m.plancobro
 1489    º  º  ³  º  ³    replace seccion  ;
 1490    º  º  ³  º  ³        with  ;
 1491    º  º  ³  º  ³        m.semestre,  ;
 1492    º  º  ³  º  ³        fecha_pago  ;
 1493    º  º  ³  º  ³        with  ;
 1494    º  º  ³  º  ³        mfechap
 1495    º  º  ³  º  ³    replace nrocuota  ;
 1496    º  º  ³  º  ³        with  ;
 1497    º  º  ³  º  ³        ii,  ;
 1498    º  º  ³  º  ³        tipo_pago  ;
 1499    º  º  ³  º  ³        with  ;
 1500    º  º  ³  º  ³        mtipop,  ;
 1501    º  º  ³  º  ³        nro_depo  ;
 1502    º  º  ³  º  ³        with  ;
 1503    º  º  ³  º  ³        mnrode
 1504    º  º  ³  º  ³    replace cod_banco  ;
 1505    º  º  ³  º  ³        with  ;
 1506    º  º  ³  º  ³        mbanco,  ;
 1507    º  º  ³  º  ³        monto  ;
 1508    º  º  ³  º  ³        with  ;
 1509    º  º  ³  º  ³        xpagado,  ;
 1510    º  º  ³  º  ³        transa  ;
 1511    º  º  ³  º  ³        with  ;
 1512    º  º  ³  º  ³        'AD'
 1513    º  º  ³  º  ³    replace cobrador  ;
 1514    º  º  ³  º  ³        with  ;
 1515    º  º  ³  º  ³        mcobrador
 1516    º  º  ³  º  ³    replace lapso  ;
 1517    º  º  ³  º  ³        with  ;
 1518    º  º  ³  º  ³        lapmat
 1519    º  º  ³  º  ³    unlock
 1520    º  º  ³  vÍÍÍÍÍÍÍexit
 1521    º  º  ³  º  ÀÄendif
 1522    º  º  ³  ÈÍenddo
 1523    º  º  ³    select 2
 1524    º  º  ³    mpagado=mpagado-(cuota&lk-pagado&lk)
 1525    º  º  ÃÄelse
 1526    º  º  ³  ÚÄif mpagado > 0
 1527    º  º  ³  ³    select 9
 1528    º  º  ³  ³  ÉÍdo while .t.
 1529    º  º  ³  ³  º  ÚÄif flock()
 1530    º  º  ³  ³  º  ³    append  ;
 1531    º  º  ³  ³  º  ³        blank
 1532    º  º  ³  ³  º  ³    replace  ;
 1533    º  º  ³  ³  º  ³        recibo  ;
 1534    º  º  ³  ³  º  ³        with  ;
 1535    º  º  ³  ³  º  ³        mrecibo,  ;
 1536    º  º  ³  ³  º  ³        cedula  ;
 1537    º  º  ³  ³  º  ³        with  ;
 1538    º  º  ³  ³  º  ³        m.cedula
 1539    º  º  ³  ³  º  ³    replace  ;
 1540    º  º  ³  ³  º  ³        curso  ;
 1541    º  º  ³  ³  º  ³        with  ;
 1542    º  º  ³  ³  º  ³        m.cur,  ;
 1543    º  º  ³  ³  º  ³        plancobro  ;
 1544    º  º  ³  ³  º  ³        with  ;
 1545    º  º  ³  ³  º  ³        m.plancobro
 1546    º  º  ³  ³  º  ³    replace  ;
 1547    º  º  ³  ³  º  ³        seccion  ;
 1548    º  º  ³  ³  º  ³        with  ;
 1549    º  º  ³  ³  º  ³        m.semestre,  ;
 1550    º  º  ³  ³  º  ³        fecha_pago  ;
 1551    º  º  ³  ³  º  ³        with  ;
 1552    º  º  ³  ³  º  ³        mfechap
 1553    º  º  ³  ³  º  ³    replace  ;
 1554    º  º  ³  ³  º  ³        tipo_pago  ;
 1555    º  º  ³  ³  º  ³        with  ;
 1556    º  º  ³  ³  º  ³        mtipop,  ;
 1557    º  º  ³  ³  º  ³        nro_depo  ;
 1558    º  º  ³  ³  º  ³        with  ;
 1559    º  º  ³  ³  º  ³        mnrode
 1560    º  º  ³  ³  º  ³    replace  ;
 1561    º  º  ³  ³  º  ³        cod_banco  ;
 1562    º  º  ³  ³  º  ³        with  ;
 1563    º  º  ³  ³  º  ³        mbanco,  ;
 1564    º  º  ³  ³  º  ³        monto  ;
 1565    º  º  ³  ³  º  ³        with  ;
 1566    º  º  ³  ³  º  ³        mpagado
 1567    º  º  ³  ³  º  ³    replace  ;
 1568    º  º  ³  ³  º  ³        nrocuota  ;
 1569    º  º  ³  ³  º  ³        with  ;
 1570    º  º  ³  ³  º  ³        ii,  ;
 1571    º  º  ³  ³  º  ³        transa  ;
 1572    º  º  ³  ³  º  ³        with  ;
 1573    º  º  ³  ³  º  ³        'BD'
 1574    º  º  ³  ³  º  ³    replace  ;
 1575    º  º  ³  ³  º  ³        cobrador  ;
 1576    º  º  ³  ³  º  ³        with  ;
 1577    º  º  ³  ³  º  ³        mcobrador
 1578    º  º  ³  ³  º  ³    replace  ;
 1579    º  º  ³  ³  º  ³        lapso  ;
 1580    º  º  ³  ³  º  ³        with  ;
 1581    º  º  ³  ³  º  ³        lapmat
 1582    º  º  ³  ³  º  ³    unlock
 1583    º  º  ³  ³  vÍÍÍÍÍÍÍexit
 1584    º  º  ³  ³  º  ÀÄendif
 1585    º  º  ³  ³  ÈÍenddo
 1586    º  º  ³  ÀÄendif
 1587    º  º  ³    select 2
 1588    º  vÍÍÍÍÍÍÍexit
 1589    º  º  ÀÄendif
 1590    º  ÓÄendfor
 1591    º    select 2
 1592    º  ÉÍdo while .t.
 1593    º  º  ÚÄif rlock()
 1594    º  º  ³    mpagado = mmontop
 1595    º  º  ³    ii = 1
 1596    º  º  ³  ÖÄfor ii = 1 to xnro
 1597    º  º  ³  º    lk = ltrim(str(ii))
 1598    º  º  ³  º  ÚÄif pagado&lk>=cuota&lk
 1599    º  º  ³  º  ³    li = li +  ;
 1600    º  º  ³  º  ³        1
 1601    º  º  ³  ^ÍÍÍÍÍÍÍloop
 1602    º  º  ³  º  ÀÄendif
 1603    º  º  ³  º  ÚÄif (mpagado+pagado&lk);
 1604    º  º  ³  º  ³        >= cuota&lk
 1605    º  º  ³  º  ³    mpagado=mpagado-(cuota&lk-pagado&lk)
 1606    º  º  ³  º  ³    replace ultimacuot  ;
 1607    º  º  ³  º  ³        with  ;
 1608    º  º  ³  º  ³        ultimacuot +  ;
 1609    º  º  ³  º  ³        1
 1610    º  º  ³  º  ³    x=(cuota&lk-pagado&lk)
 1611    º  º  ³  º  ³    replace monto_paga  ;
 1612    º  º  ³  º  ³        with  ;
 1613    º  º  ³  º  ³        monto_paga +  ;
 1614    º  º  ³  º  ³        x
 1615    º  º  ³  º  ³    repla pagado&lk;
 1616    º  º  ³  º  ³        with cuota&lk
 1617    º  º  ³  º  ³    replace nrorecibo  ;
 1618    º  º  ³  º  ³        with  ;
 1619    º  º  ³  º  ³        mrecibo
 1620    º  º  ³  º  ³    replace fecha_ultp  ;
 1621    º  º  ³  º  ³        with  ;
 1622    º  º  ³  º  ³        mfechap
 1623    º  º  ³  º  ³    replace total_deud  ;
 1624    º  º  ³  º  ³        with  ;
 1625    º  º  ³  º  ³        tdeuda
 1626    º  º  ³  º  ÃÄelse
 1627    º  º  ³  º  ³    repla pagado&lk;
 1628    º  º  ³  º  ³        with pagado&lk+mpagado
 1629    º  º  ³  º  ³    replace monto_paga  ;
 1630    º  º  ³  º  ³        with  ;
 1631    º  º  ³  º  ³        monto_paga +  ;
 1632    º  º  ³  º  ³        mpagado
 1633    º  º  ³  º  ³    replace nrorecibo  ;
 1634    º  º  ³  º  ³        with  ;
 1635    º  º  ³  º  ³        mrecibo
 1636    º  º  ³  º  ³    replace fecha_ultp  ;
 1637    º  º  ³  º  ³        with  ;
 1638    º  º  ³  º  ³        mfechap
 1639    º  º  ³  º  ³    replace total_deud  ;
 1640    º  º  ³  º  ³        with  ;
 1641    º  º  ³  º  ³        tdeuda
 1642    º  º  ³  vÍÍÍÍÍÍÍexit
 1643    º  º  ³  º  ÀÄendif
 1644    º  º  ³  ÓÄendfor
 1645    º  º  ³    unlock
 1646    º  vÍÍÍÍÍÍÍexit
 1647    º  º  ÀÄendif
 1648    º  ÈÍenddo
 1649    º    xcedula = space(12)
 1650    º    m.swp = 0
 1651    º    @ 06, 00 clear to 19,  ;
 1652    º        wcols()
 1653    º    _curobj = objnum(xcedula)
 1654    º    show gets
 1655    º    m.control = 0
 1656    º    m.nac = 'V'
 1657    º    m.ced = 0
 1658    º    entra = .f.
 1659    ÈÍenddo
 1660      *
 1682  *!*****************************************************************************
 1683  *!
 1684  *!      Procedure: VALIDAR
 1685  *!
 1686  *!      Called by: SCP20033.PRG                      
 1687  *!               : VALIDAR            (procedure in SCP20033.PRG)
 1688  *!               : SCP20333.PRG                      
 1689  *!
 1690  *!          Calls: IIF()              (function  in ?)
 1691  *!               : LEN()              (function  in ?)
 1692  *!               : LTRIM()            (function  in ?)
 1693  *!               : STR()              (function  in ?)
 1694  *!               : SPACE()            (function  in ?)
 1695  *!               : BUSQUEDA()         (function  in ?)
 1696  *!               : SUBSTR()           (function  in ?)
 1697  *!               : VAL()              (function  in ?)
 1698  *!               : BOXFIELD()         (function  in ?)
 1699  *!               : VARREAD()          (function  in ?)
 1700  *!               : VALIDAR            (procedure in SCP20033.PRG)
 1701  *!
 1702  *!*****************************************************************************
 1682      procedure validar
 1683      parameter xvar
 1684    ÕÍdo case
 1685    ÆÍcase xvar = 'NAC' .or. xvar =  ;
 1686    ³        'CED'
 1687    ³    on key label tab
 1688    ³    m.ced = iif(len(ltrim(str(m.ced,  ;
 1689    ³        10))) < 10,  ;
 1690    ³        ltrim(str(m.ced,  ;
 1691    ³        10)) + space(10 -  ;
 1692    ³        len(ltrim(str(m.ced,  ;
 1693    ³        10)))),  ;
 1694    ³        ltrim(str(m.ced,  ;
 1695    ³        10)))
 1696    ³    xcedula = m.nac + '-' +  ;
 1697    ³        m.ced
 1698    ³    select 1
 1699    ³    xcedula = busqueda()
 1700    ³    m.nac = substr(xcedula,  ;
 1701    ³        1, 1)
 1702    ³    m.ced = val(substr(xcedula,  ;
 1703    ³        3, 10))
 1704    ³    show get m.nac
 1705    ³    show get m.ced
 1706    ÆÍcase xvar = 'PLANCOBRO'
 1707    ³    on key label tab
 1708    ³    m.planco = boxfield('PLANCOBR', ;
 1709    ³        'CODIGO')
 1710    ³    show get m.planco
 1711    ÆÍcase xvar = 'MBANCO'
 1712    ³    on key label tab
 1713    ³    mbanco = boxfield('BANCOS', ;
 1714    ³        'CODIGO')
 1715    ³    show get mbanco
 1716    ÆÍcase xvar = 'MCOBRADOR'
 1717    ³    on key label tab
 1718    ³    mcobrador = boxfield('COBRADOR', ;
 1719    ³        'CODIGO')
 1720    ³    show get mcobrador
 1721    ÔÍendcase
 1722      on key label tab do validar with varread()
 1723      return
 1724      *
 1739  *!*****************************************************************************
 1740  *!
 1741  *!       Function: MBANCOS()
 1742  *!
 1743  *!      Called by: SCP20033.PRG                      
 1744  *!               : DEUDA_VEN3()       (function  in SCP20033.PRG)
 1745  *!               : DEUDA_VEN1()       (function  in SCP20033.PRG)
 1746  *!               : DEUDA_VEN2()       (function  in SCP20033.PRG)
 1747  *!               : SCP20333.PRG                      
 1748  *!
 1749  *!          Calls: SEEK()             (function  in ?)
 1750  *!               : BOXFIELD()         (function  in ?)
 1751  *!
 1752  *!*****************************************************************************
 1739      function mbancos
 1740      parameter xban
 1741      select bancos
 1742    ÚÄif  .not. seek(xban)
 1743    ³    mbanco = boxfield('BANCOS', ;
 1744    ³        'CODIGO')
 1745    ÀÄendif
 1746      show get mbanco
 1747      return .t.
 1748      *
 1763  *!*****************************************************************************
 1764  *!
 1765  *!       Function: MCOBRAD()
 1766  *!
 1767  *!      Called by: SCP20033.PRG                      
 1768  *!               : DEUDA_VEN3()       (function  in SCP20033.PRG)
 1769  *!               : DEUDA_VEN1()       (function  in SCP20033.PRG)
 1770  *!               : DEUDA_VEN2()       (function  in SCP20033.PRG)
 1771  *!               : SCP20333.PRG                      
 1772  *!
 1773  *!          Calls: SEEK()             (function  in ?)
 1774  *!               : BOXFIELD()         (function  in ?)
 1775  *!
 1776  *!*****************************************************************************
 1763      function mcobrad
 1764      parameter xban
 1765      select cobrador
 1766    ÚÄif  .not. seek(xban)
 1767    ³    mcobrador = boxfield('COBRADOR', ;
 1768    ³        'CODIGO')
 1769    ÀÄendif
 1770      show get mcobrador
 1771      return .t.
 1772      *
 1810  *!*****************************************************************************
 1811  *!
 1812  *!       Function: DEUDA_VEN1()
 1813  *!
 1814  *!      Called by: SCP20033.PRG                      
 1815  *!               : SCP20333.PRG                      
 1816  *!
 1817  *!          Calls: LEFT()             (function  in ?)
 1818  *!               : ALLTRIM()          (function  in ?)
 1819  *!               : STR()              (function  in ?)
 1820  *!               : YEAR()             (function  in ?)
 1821  *!               : CTOD()             (function  in ?)
 1822  *!               : SUBSTR()           (function  in ?)
 1823  *!               : SPACE()            (function  in ?)
 1824  *!               : LTRIM()            (function  in ?)
 1825  *!               : SEEK()             (function  in ?)
 1826  *!               : DATE()             (function  in ?)
 1827  *!               : LASTKEY()          (function  in ?)
 1828  *!               : SALIDA()           (function  in ?)
 1829  *!               : MBANCOS()          (function  in SCP20033.PRG)
 1830  *!               : BOXFIELD()         (function  in ?)
 1831  *!               : MSGERRO()          (function  in ?)
 1832  *!               : COL()              (function  in ?)
 1833  *!               : MCOBRAD()          (function  in SCP20033.PRG)
 1834  *!               : ACEPTA()           (function  in ?)
 1835  *!               : PRINTER()          (function  in ?)
 1836  *!               : RLOCK()            (function  in ?)
 1837  *!               : CHR()              (function  in ?)
 1838  *!               : PCOL()             (function  in ?)
 1839  *!               : LETRAS()           (function  in ?)
 1840  *!               : FLOCK()            (function  in ?)
 1841  *!               : IIF()              (function  in ?)
 1842  *!               : RIGHT()            (function  in ?)
 1843  *!
 1844  *!           Uses: MP&XLAP.DBF            Alias: NUEVO
 1845  *!
 1846  *!*****************************************************************************
 1810      function deuda_ven1
 1811      define window deuda from 00, 00  ;
 1812          to 24, 79 shadow title  ;
 1813          'Registro de Control de Deuda Anterior'  ;
 1814          color scheme 5
 1815      activate window deuda
 1816      @ 00, 00 say  ;
 1817          'ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»'
 1818      @ 01, 00 say  ;
 1819          'º C.I. :            Alumno:                                                  º'
 1820      @ 02, 00 say  ;
 1821          'º Menci¢n :                   Semestre    Plan de Cobro:       Lapso:        º'
 1822      @ 03, 00 say  ;
 1823          'ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶'
 1824      @ 04, 00 say  ;
 1825          'º    Total Deuda Vencida:               Fecha de Pago    :                   º'
 1826      @ 05, 00 say  ;
 1827          'º   Monto Pagado/Abonado:               Tipo Pago (E/D/C):                   º'
 1828      @ 06, 00 say  ;
 1829          'º  Saldo Pendiente Pagar:               Nro. Dep./Cheq   :                   º'
 1830      @ 07, 00 say  ;
 1831          'º            % Descuento:               Banco :                              º'
 1832      @ 08, 00 say  ;
 1833          'º  Monto Cancelar/Abonar:               Cobrador :                           º'
 1834      @ 09, 00 say  ;
 1835          'º  Nro. ³  Descripci¢n de Conceptos           ³ Fecha Vencmto. ³ Monto Cuota º'  ;
 1836          color n/w
 1837      @ 10, 00 say  ;
 1838          'º       ³                                     ³                ³             º'
 1839      @ 11, 00 say  ;
 1840          'º       ³                                     ³                ³             º'
 1841      @ 12, 00 say  ;
 1842          'º       ³                                     ³                ³             º'
 1843      @ 13, 00 say  ;
 1844          'º       ³                                     ³                ³             º'
 1845      @ 14, 00 say  ;
 1846          'º       ³                                     ³                ³             º'
 1847      @ 15, 00 say  ;
 1848          'º       ³                                     ³                ³             º'
 1849      @ 16, 00 say  ;
 1850          'º       ³                                     ³                ³             º'
 1851      @ 17, 00 say  ;
 1852          'º       ³                                     ³                ³             º'
 1853      @ 18, 00 say  ;
 1854          'º       ³                                     ³                ³             º'
 1855      @ 19, 00 say  ;
 1856          'º       ³                                     ³                ³             º'
 1857      @ 20, 00 say  ;
 1858          'º       ³                                     ³                ³             º'
 1859      @ 21, 00 say  ;
 1860          'ÇÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄ¶'
 1861      @ 22, 00 say  ;
 1862          'º                                                              ³             º'
 1863      select 7
 1864      m.saldo = total_d - monto_p
 1865      select 18
 1866      xlap = lapmat
 1867      ch1 = left(xlap, 2)
 1868      ch2 = alltrim(str(year(ctod( ;
 1869          '01/01/' + right(xlap,  ;
 1870          2)))))
 1871      use mp&xlap again alias nuevo order ced
 1872      seek xcedula
 1873      scatter memo memvar
 1874      m.curso = cur
 1875    ÕÍdo case
 1876    ÆÍcase m.curso = '32012'
 1877    ³    m.mencion = 'BASICA'
 1878    ÆÍcase m.curso = '31022'
 1879    ³    m.mencion = 'CIENCIAS'
 1880    ÆÍcase m.curso = '31023'
 1881    ³    m.mencion = 'HUMANIDADES'
 1882    ÔÍendcase
 1883      select 1
 1884      @ 01, 08 get m.cedula picture  ;
 1885          '@!'
 1886      @ 01, 27 get m.nombres picture  ;
 1887          '@!'
 1888      @ 02, 38 get m.semestre picture  ;
 1889          '@!'
 1890      @ 02, 56 get m.plancobro picture  ;
 1891          '@!'
 1892      @ 02, 70 get ch1 picture '@!'
 1893      @ 02, 72 say '-'
 1894      @ 02, 73 get ch2 picture '@!'
 1895      @ 04, 26 get m.total_d picture  ;
 1896          '99,999,999.99'
 1897      @ 05, 26 get m.monto_p picture  ;
 1898          '99,999,999.99'
 1899      @ 06, 26 get m.saldo picture  ;
 1900          '99,999,999.99'
 1901      clear gets
 1902      select 18
 1903      release datos
 1904      dimension datos( 7, 4)
 1905      external array datos
 1906    ÖÄfor q = 1 to 7
 1907    º    datos( q, 1) = space(30)
 1908    º    datos( q, 2) = 0.00
 1909    º    datos( q, 3) = space(30)
 1910    º    datos( q, 4) = 0.00
 1911    ÓÄendfor
 1912      li = 10
 1913      w = 1
 1914      z = 1
 1915    ÖÄfor q = 1 to 12
 1916    º    lq = ltrim(str(q))
 1917    º  ÚÄif pagado&lq >= cuota&lq
 1918    ^ÍÍÍÍÍÍÍloop
 1919    º  ÀÄendif
 1920    º    mcuota = q
 1921    º    select 11
 1922    º    locate for lapso = xlap  ;
 1923    º        .and. codigo =  ;
 1924    º        m.plancobro .and.  ;
 1925    º        cuota = q
 1926    º    xfec = fecha_ven
 1927    º    xcon = concepto1
 1928    º    select 12
 1929    º  ÚÄif  .not. seek(xcon)
 1930    º  ³    xdes = 'SIN DESCRIPCION'
 1931    º  ÃÄelse
 1932    º  ³    xdes = alltrim(descripcio)
 1933    º  ÀÄendif
 1934    º    select 18
 1935    º    @ li, 02 say ltrim(str(q))  ;
 1936    º        picture '99'
 1937    º    @ li, 11 say xdes
 1938    º    @ li, 51 say xfec picture  ;
 1939    º        '@E'
 1940    º    @li,65 say cuota&lq pict '99,999,999.99'
 1941    º    li = li + 1
 1942    º  ÚÄif w > 7
 1943    º  ³    datos( z, 3) = xdes
 1944    º  ³    datos(z,4)=cuota&lq
 1945    º  ³    z = z + 1
 1946    º  ÃÄelse
 1947    º  ³    datos( w, 1) = xdes
 1948    º  ³    datos(w,2)=cuota&lq
 1949    º  ÀÄendif
 1950    º    w = w + 1
 1951    ÓÄendfor
 1952      @ 22, 65 say m.saldo picture  ;
 1953          '99,999,999.99'
 1954      m.fechap = date()
 1955      m.tipop = 'Efectivo'
 1956      m.nrode = space(20)
 1957      m.banco = space(2)
 1958      m.montop = 0.00
 1959      m.desban = space(20)
 1960      m.choice = 1
 1961      m.cobrador = space(2)
 1962      m.descuento = 0.00
 1963      save screen to ven
 1964    ÉÍdo while .t.
 1965    º    restore screen from ven
 1966    º    @ 04, 58 get m.fechap  ;
 1967    º        picture '@E'
 1968    º    @ 05, 58 get m.tipop default  ;
 1969    º        'Efectivo' picture  ;
 1970    º        '@!M Deposito,Cheque,Efectivo'
 1971    º    read
 1972    º  ÚÄif lastkey() = 27
 1973    º  ³    p = salida()
 1974    º  ³  ÚÄif p = 2
 1975    º  ³  ³    entra = .f.
 1976    º  ³  ³    release window  ;
 1977    º  ³  ³        deuda
 1978  <ÍÍÍÍÍÍÍÍÍÍÍÍreturn .f.
 1979    º  ³  ÀÄendif
 1980    ^ÍÍÍÍÍÍÍloop
 1981    º  ÀÄendif
 1982    º  ÚÄif m.tipop <> 'Efectivo'
 1983    º  ³    @ 06, 58 get m.nrode  ;
 1984    º  ³        picture '@!S15' valid  ;
 1985    º  ³        m.nrode <> space(20)  ;
 1986    º  ³        error  ;
 1987    º  ³        'El N£mero de la Transacci¢n esta en blanco'
 1988    º  ³    @ 07, 47 get m.banco  ;
 1989    º  ³        picture '@!' valid  ;
 1990    º  ³        mbancos(m.banco)
 1991    º  ³    read
 1992    º  ³    select 10
 1993    º  ³  ÚÄif  .not. seek(m.banco)
 1994    º  ³  ³    m.banco = boxfield('bancos', ;
 1995    º  ³  ³        'codigo')
 1996    º  ³  ÀÄendif
 1997    º  ³    select 9
 1998    º  ³    set order to bandepo
 1999    º  ³  ÚÄif seek(m.banco +  ;
 2000    º  ³  ³        m.nrode)
 2001    º  ³  ³  ÚÄif status <> 'D'
 2002    º  ³  ³  ³    = msgerro( ;
 2003    º  ³  ³  ³        'Ya existe un registro de pagos con este numero, verifique' ;
 2004    º  ³  ³  ³        )
 2005    ^ÍÍÍÍÍÍÍÍÍÍÍÍÍloop
 2006    º  ³  ³  ÀÄendif
 2007    º  ³  ÀÄendif
 2008    º  ³    select 10
 2009    º  ³    @ 07, 47 say m.banco  ;
 2010    º  ³        picture '@!' color w+/ ;
 2011    º  ³        w
 2012    º  ³    @ 07, col() + 2 say  ;
 2013    º  ³        left(descripcio, 25)
 2014    º  ÀÄendif
 2015    º  ÚÄif m.monto_p = 0
 2016    º  ³    @ 07, 26 get  ;
 2017    º  ³        m.descuento picture  ;
 2018    º  ³        '999' valid  ;
 2019    º  ³        m.descuento <= 100  ;
 2020    º  ³        error  ;
 2021    º  ³        'El Porcentaje de Descuento es invalido, verifique'
 2022    º  ³    read
 2023    º  ³  ÚÄif lastkey() = 27
 2024    º  ³  ³    p = salida()
 2025    º  ³  ³  ÚÄif p = 2
 2026    º  ³  ³  ³    entra = .f.
 2027    º  ³  ³  ³    release window  ;
 2028    º  ³  ³  ³        deuda
 2029  <ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍreturn .f.
 2030    º  ³  ³  ÀÄendif
 2031    ^ÍÍÍÍÍÍÍÍÍÍloop
 2032    º  ³  ÀÄendif
 2033    º  ³    m.porc = m.descuento /  ;
 2034    º  ³        100
 2035    º  ³    m.montop = m.saldo *  ;
 2036    º  ³        m.porc
 2037    º  ÀÄendif
 2038    º    @ 08, 26 get m.montop  ;
 2039    º        picture '99,999,999.99'
 2040    º    @ 08, 50 get m.cobrador  ;
 2041    º        picture '@!' valid  ;
 2042    º        mcobrad(m.cobrador)
 2043    º    read
 2044    º  ÚÄif lastkey() = 27
 2045    º  ³    p = salida()
 2046    º  ³  ÚÄif p = 2
 2047    º  ³  ³    entra = .f.
 2048    º  ³  ³    release window  ;
 2049    º  ³  ³        deuda
 2050  <ÍÍÍÍÍÍÍÍÍÍÍÍreturn .f.
 2051    º  ³  ÀÄendif
 2052    ^ÍÍÍÍÍÍÍloop
 2053    º  ÀÄendif
 2054    º  ÚÄif m.descuento > 0
 2055    º  ³    m.porc = m.descuento /  ;
 2056    º  ³        100
 2057    º  ³    nuevosaldo = m.saldo *  ;
 2058    º  ³        m.porc
 2059    º  ³  ÚÄif m.montop <= 0 .or.  ;
 2060    º  ³  ³        m.montop >  ;
 2061    º  ³  ³        nuevosaldo
 2062    º  ³  ³    = msgerro( ;
 2063    º  ³  ³        'El Monto a Pagar por Concepto de Mensualidad es invalido, verifique' ;
 2064    º  ³  ³        )
 2065    ^ÍÍÍÍÍÍÍÍÍÍloop
 2066    º  ³  ÀÄendif
 2067    º  ³  ÚÄif nuevosaldo >  ;
 2068    º  ³  ³        m.montop
 2069    º  ³  ³    = msgerro( ;
 2070    º  ³  ³        'El Monto a cancelar es invalido, no se permite abonos para esta modalidad' ;
 2071    º  ³  ³        )
 2072    ^ÍÍÍÍÍÍÍÍÍÍloop
 2073    º  ³  ÀÄendif
 2074    º  ÃÄelse
 2075    º  ³  ÚÄif m.montop = 0 .or.  ;
 2076    º  ³  ³        m.montop > m.saldo
 2077    º  ³  ³    = msgerro( ;
 2078    º  ³  ³        'El Monto a Pagar por Concepto de Mensualidad es invalido, verifique' ;
 2079    º  ³  ³        )
 2080    ^ÍÍÍÍÍÍÍÍÍÍloop
 2081    º  ³  ÀÄendif
 2082    º  ÀÄendif
 2083    º    select cobrador
 2084    º  ÚÄif  .not. seek(m.cobrador)
 2085    º  ³    m.cobrador = boxfield('cobrador', ;
 2086    º  ³        'codigo')
 2087    º  ÀÄendif
 2088    º    select 14
 2089    º    @ 08, 50 say m.cobrador  ;
 2090    º        picture '@!' color w+/w
 2091    º    @ 08, col() + 2 say  ;
 2092    º        left(nombres, 20)
 2093    º    mnomcob = alltrim(nombres)
 2094    º    opc = acepta( ;
 2095    º        'Esta correcto este Monto a Cancelar' ;
 2096    º        )
 2097    º  ÚÄif opc = 2
 2098    ^ÍÍÍÍÍÍÍloop
 2099    º  ÀÄendif
 2100    vÍÍÍÍexit
 2101    ÈÍenddo
 2102    ÚÄif m.descuento > 0
 2103    ³    m.porc = m.descuento / 100
 2104    ³    nuevosaldo = (m.saldo *  ;
 2105    ³        m.porc) -  ;
 2106    ³        m.montop
 2107    ÃÄelse
 2108    ³    nuevosaldo = m.saldo -  ;
 2109    ³        m.montop
 2110    ÀÄendif
 2111      opce = acepta( ;
 2112          'Proceso este Pago de Mensualidad' ;
 2113          )
 2114    ÚÄif opce = 2
 2115    ³    release window deuda
 2116  <ÍÍÍÍÍÍreturn .f.
 2117    ÀÄendif
 2118      mrecibo = 0
 2119      select 18
 2120      p = printer()
 2121    ÚÄif p = 2
 2122    ³    select 13
 2123    ³  ÉÍdo while .t.
 2124    ³  º  ÚÄif rlock()
 2125    ³  º  ³    replace recibo  ;
 2126    ³  º  ³        with  ;
 2127    ³  º  ³        recibo +  ;
 2128    ³  º  ³        1
 2129    ³  º  ³    mrecibo = recibo
 2130    ³  º  ³    unlock
 2131    ³  vÍÍÍÍÍÍÍexit
 2132    ³  º  ÀÄendif
 2133    ³  ÈÍenddo
 2134    ³    select 18
 2135    ³    wait window  ;
 2136    ³        'Nro. del Recibo Generado: ' +  ;
 2137    ³        ltrim(str(mrecibo)) +  ;
 2138    ³        chr(13) +  ;
 2139    ³        'Presione Cualquier Tecla para continuar..'
 2140    ÃÄelse
 2141    ³    select 13
 2142    ³  ÉÍdo while .t.
 2143    ³  º  ÚÄif rlock()
 2144    ³  º  ³    replace recibo  ;
 2145    ³  º  ³        with  ;
 2146    ³  º  ³        recibo +  ;
 2147    ³  º  ³        1
 2148    ³  º  ³    mrecibo = recibo
 2149    ³  º  ³    unlock
 2150    ³  vÍÍÍÍÍÍÍexit
 2151    ³  º  ÀÄendif
 2152    ³  ÈÍenddo
 2153    ³    select 18
 2154    ³    set device to printer
 2155    ³    @ 0, 1 say '  ' + chr(27) +  ;
 2156    ³        chr(67) + chr(33)
 2157    ³    @ 00, 00 say chr(18) +  ;
 2158    ³        chr(20)
 2159    ³    @ 00, 00 say chr(14) +  ;
 2160    ³        chr(15) + titulo + chr(18) +  ;
 2161    ³        chr(20) + ' '
 2162    ³    @ 01, 00 say  ;
 2163    ³        'RIF .                                                   RECIBO Nro.:          '
 2164    ³    @ 01, 04 say l_rif
 2165    ³    @ 01, 68 say chr(14) + ng +  ;
 2166    ³        ltrim(str(mrecibo)) + ngn
 2167    ³    @ 02, 00 say chr(15) + ' '
 2168    ³    @ 02, 00 say l_direccio
 2169    ³    @ 02, pcol() say chr(18) +  ;
 2170    ³        chr(20) + ' '
 2171    ³    @ 02, 00 say  ;
 2172    ³        '                                                        FECHA PAGO:          '
 2173    ³    @ 02, 68 say m.fechap  ;
 2174    ³        picture '@E'
 2175    ³    @ 03, 00 say  ;
 2176    ³        '                                                      '
 2177    ³    @ 03, 28 say chr(14) +  ;
 2178    ³        chr(15) + 'RECIBO DE PAGO' +  ;
 2179    ³        chr(18) + chr(20) + ' '
 2180    ³    @ 04, 00 say  ;
 2181    ³        '                                                      ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ» '
 2182    ³    @ 05, 00 say  ;
 2183    ³        'C.I.:                                                 º Bs.                º '
 2184    ³    @ 05, 61 say m.montop  ;
 2185    ³        picture '9,999,999.99'
 2186    ³    @ 05, 06 say m.cedula  ;
 2187    ³        picture '!-99999999'
 2188    ³    @ 06, 00 say  ;
 2189    ³        'ALUMNO:                                               ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼ '
 2190    ³    @ 06, 08 say m.nombres  ;
 2191    ³        picture '@!s45'
 2192    ³    @ 07, 00 say 'SEMESTRE: ' +  ;
 2193    ³        m.semestre
 2194    ³    @ 08, 00 say 'TURNO   : ' +  ;
 2195    ³        m.turno
 2196    ³    xcantidad = letras(m.montop)
 2197    ³    xcantidad = alltrim(xcantidad)
 2198    ³    @ 09, 00 say  ;
 2199    ³        'Hemos recibido la cantidad de:'
 2200    ³    @ 10, 00 say xcantidad  ;
 2201    ³        picture '@!'
 2202    ³    li = 11
 2203    ³    @ li, 00 say  ;
 2204    ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ' +  ;
 2205    ³        ng
 2206    ³    li = li + 1
 2207    ³    @ li, 00 say  ;
 2208    ³        '  C O N C E P T O S                                          M O N T O       ' +  ;
 2209    ³        ngn
 2210    ³    li = li + 1
 2211    ³    @ li, 00 say  ;
 2212    ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ'
 2213    ³    li = li + 1
 2214    ³    @ li, 00 say chr(15) + ' '
 2215    ³  ÖÄfor s = 1 to 7
 2216    ³  º    ls = ltrim(str(s))
 2217    ³  º  ÚÄif datos(s,1) =  ;
 2218    ³  º  ³        space(30)
 2219    ³  ^ÍÍÍÍÍÍÍloop
 2220    ³  º  ÀÄendif
 2221    ³  º    @ li, 01 say datos(s,1)  ;
 2222    ³  º        picture '@!s22'
 2223    ³  º    @ li, 24 say '('
 2224    ³  º    @ li, 25 say datos(s,2)  ;
 2225    ³  º        picture '999,999.99'
 2226    ³  º    @ li, 35 say ')'
 2227    ³  º  ÚÄif s <= 4
 2228    ³  º  ³  ÚÄif datos(s,3) <>  ;
 2229    ³  º  ³  ³        space(30)
 2230    ³  º  ³  ³    @ li, 39 say  ;
 2231    ³  º  ³  ³        datos(s,3)  ;
 2232    ³  º  ³  ³        picture  ;
 2233    ³  º  ³  ³        '@!s22'
 2234    ³  º  ³  ³    @ li, 60 say  ;
 2235    ³  º  ³  ³        '('
 2236    ³  º  ³  ³    @ li, 61 say  ;
 2237    ³  º  ³  ³        datos(s,4)  ;
 2238    ³  º  ³  ³        picture  ;
 2239    ³  º  ³  ³        '999,999.99'
 2240    ³  º  ³  ³    @ li, 71 say  ;
 2241    ³  º  ³  ³        ')'
 2242    ³  º  ³  ÀÄendif
 2243    ³  º  ³  ÚÄif s = 1
 2244    ³  º  ³  ³    @ li, 105 say  ;
 2245    ³  º  ³  ³        'Deuda Pendiente ->'
 2246    ³  º  ³  ³    @ li, 124 say  ;
 2247    ³  º  ³  ³        m.total_d  ;
 2248    ³  º  ³  ³        picture  ;
 2249    ³  º  ³  ³        '999,999.99'
 2250    ³  º  ³  ÀÄendif
 2251    ³  º  ³  ÚÄif s = 2
 2252    ³  º  ³  ³  ÚÄif m.descuento >  ;
 2253    ³  º  ³  ³  ³        0
 2254    ³  º  ³  ³  ³    @ li,  ;
 2255    ³  º  ³  ³  ³        102  ;
 2256    ³  º  ³  ³  ³        say  ;
 2257    ³  º  ³  ³  ³        m.descuento  ;
 2258    ³  º  ³  ³  ³        picture  ;
 2259    ³  º  ³  ³  ³        '999.99'
 2260    ³  º  ³  ³  ³    @ li,  ;
 2261    ³  º  ³  ³  ³        111  ;
 2262    ³  º  ³  ³  ³        say  ;
 2263    ³  º  ³  ³  ³        '% Descuento ->'
 2264    ³  º  ³  ³  ³    @ li,  ;
 2265    ³  º  ³  ³  ³        124  ;
 2266    ³  º  ³  ³  ³        say  ;
 2267    ³  º  ³  ³  ³        (m.saldo *  ;
 2268    ³  º  ³  ³  ³        m.porc)  ;
 2269    ³  º  ³  ³  ³        picture  ;
 2270    ³  º  ³  ³  ³        '999,999.99'
 2271    ³  º  ³  ³  ÃÄelse
 2272    ³  º  ³  ³  ³    @ li,  ;
 2273    ³  º  ³  ³  ³        100  ;
 2274    ³  º  ³  ³  ³        say  ;
 2275    ³  º  ³  ³  ³        'Monto Pagado/Abonado ->'
 2276    ³  º  ³  ³  ³    @ li,  ;
 2277    ³  º  ³  ³  ³        124  ;
 2278    ³  º  ³  ³  ³        say  ;
 2279    ³  º  ³  ³  ³        m.montop  ;
 2280    ³  º  ³  ³  ³        picture  ;
 2281    ³  º  ³  ³  ³        '999,999.99'
 2282    ³  º  ³  ³  ÀÄendif
 2283    ³  º  ³  ÀÄendif
 2284    ³  º  ³  ÚÄif s = 3 .and.  ;
 2285    ³  º  ³  ³        m.descuento >  ;
 2286    ³  º  ³  ³        0
 2287    ³  º  ³  ³    @ li, 100 say  ;
 2288    ³  º  ³  ³        'Monto Pagado/Abonado ->'
 2289    ³  º  ³  ³    @ li, 124 say  ;
 2290    ³  º  ³  ³        m.montop  ;
 2291    ³  º  ³  ³        picture  ;
 2292    ³  º  ³  ³        '999,999.99'
 2293    ³  º  ³  ÀÄendif
 2294    ³  º  ÀÄendif
 2295    ³  º    li = li + 1
 2296    ³  ÓÄendfor
 2297    ³    @ li, 00 say chr(18) + ' '
 2298    ³    @ 21, 00 say  ;
 2299    ³        'ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»'
 2300    ³    @ 22, 00 say  ;
 2301    ³        'º            N O T A            º  EFECTIVO   [ ]   CHEQ/DEPOST [ ]           º'
 2302    ³  ÚÄif m.tipop <> 'Efectivo'
 2303    ³  ³    @ 22, 65 say 'X'
 2304    ³  ÃÄelse
 2305    ³  ³    @ 22, 47 say 'X'
 2306    ³  ÀÄendif
 2307    ³    @ 23, 00 say  ;
 2308    ³        'ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶  NRO. :                                     º'
 2309    ³    @ 23, 41 say m.nrode picture  ;
 2310    ³        '@!'
 2311    ³    @ 24, 00 say  ;
 2312    ³        'º                               º  BANCO:                                     º'
 2313    ³    @ 24, 41 say m.desban
 2314    ³    @ 25, 00 say  ;
 2315    ³        'º                               º                                             º'
 2316    ³    @ 26, 00 say  ;
 2317    ³        'º                               º                        ___________________  º'
 2318    ³    @ 27, 00 say  ;
 2319    ³        'º                               º                           RECIBIDO POR:     º'
 2320    ³    @ 28, 00 say  ;
 2321    ³        'ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼'
 2322    ³    @ 29, 00 say  ;
 2323    ³        ' NOTA: Los Pagos Realizados no estan sujetos a devoluciones'
 2324    ³    @ 30, 00 say ' '
 2325    ³    eject
 2326    ³    set device to screen
 2327    ÀÄendif
 2328      select 9
 2329    ÉÍdo while .t.
 2330    º  ÚÄif flock()
 2331    º  ³    append blank
 2332    º  ³    replace recibo with  ;
 2333    º  ³        mrecibo, cedula  ;
 2334    º  ³        with m.cedula
 2335    º  ³    replace curso with  ;
 2336    º  ³        m.curso,  ;
 2337    º  ³        plancobro with  ;
 2338    º  ³        m.plancobro
 2339    º  ³    replace seccion with  ;
 2340    º  ³        m.semestre,  ;
 2341    º  ³        fecha_pago with  ;
 2342    º  ³        m.fechap
 2343    º  ³    replace nrocuota with 0,  ;
 2344    º  ³        tipo_pago with  ;
 2345    º  ³        m.tipop,  ;
 2346    º  ³        nro_depo with  ;
 2347    º  ³        m.nrode
 2348    º  ³    replace cod_banco with  ;
 2349    º  ³        m.banco, monto  ;
 2350    º  ³        with m.montop,  ;
 2351    º  ³        transa with  ;
 2352    º  ³        'AT'
 2353    º  ³    replace cobrador with  ;
 2354    º  ³        m.cobrador
 2355    º  ³    replace lapso with  ;
 2356    º  ³        lapmat
 2357    º  ³    unlock
 2358    vÍÍÍÍÍÍÍexit
 2359    º  ÀÄendif
 2360    ÈÍenddo
 2361      select 7
 2362    ÉÍdo while .t.
 2363    º  ÚÄif rlock()
 2364    º  ³    replace monto_p with  ;
 2365    º  ³        monto_p +  ;
 2366    º  ³        m.montop
 2367    º  ³    replace descto with  ;
 2368    º  ³        m.descuento
 2369    º  ³    unlock
 2370    vÍÍÍÍÍÍÍexit
 2371    º  ÀÄendif
 2372    ÈÍenddo
 2373      release window deuda
 2374      return iif(nuevosaldo = 0, .t.,  ;
 2375          .f.)
 2376      *
 2393  *!*****************************************************************************
 2394  *!
 2395  *!      Procedure: REPITE_REC
 2396  *!
 2397  *!          Calls: PRINTER()          (function  in ?)
 2398  *!               : RLOCK()            (function  in ?)
 2399  *!               : LTRIM()            (function  in ?)
 2400  *!               : STR()              (function  in ?)
 2401  *!               : CHR()              (function  in ?)
 2402  *!               : PCOL()             (function  in ?)
 2403  *!               : LETRAS()           (function  in ?)
 2404  *!               : ALLTRIM()          (function  in ?)
 2405  *!               : SPACE()            (function  in ?)
 2406  *!               : SEEK()             (function  in ?)
 2407  *!
 2408  *!*****************************************************************************
 2393      procedure repite_rec
 2394      set device to screen
 2395      mrecibo = 0
 2396      lin1 = 0
 2397      lin2 = 0
 2398      lin3 = 0
 2399      tu = 0
 2400      select 2
 2401      p = printer()
 2402    ÚÄif p = 2
 2403    ³    select 13
 2404    ³  ÉÍdo while .t.
 2405    ³  º  ÚÄif rlock()
 2406    ³  º  ³    mrecibo = recibo
 2407    ³  º  ³    unlock
 2408    ³  vÍÍÍÍÍÍÍexit
 2409    ³  º  ÀÄendif
 2410    ³  ÈÍenddo
 2411    ³    select 2
 2412    ³    wait window  ;
 2413    ³        'Nro. del Recibo Generado: ' +  ;
 2414    ³        ltrim(str(mrecibo)) +  ;
 2415    ³        chr(13) +  ;
 2416    ³        'Presione Cualquier Tecla para continuar..'
 2417    ÃÄelse
 2418    ³    select 13
 2419    ³  ÉÍdo while .t.
 2420    ³  º  ÚÄif rlock()
 2421    ³  º  ³    mrecibo = recibo
 2422    ³  º  ³    unlock
 2423    ³  vÍÍÍÍÍÍÍexit
 2424    ³  º  ÀÄendif
 2425    ³  ÈÍenddo
 2426    ³    select 2
 2427    ³    set device to printer
 2428    ³    @ 0, 1 say '  ' + chr(27) +  ;
 2429    ³        chr(67) + chr(33)
 2430    ³    @ 00, 00 say chr(18) +  ;
 2431    ³        chr(20)
 2432    ³    @ 00, 00 say chr(14) +  ;
 2433    ³        chr(15) + titulo + chr(18) +  ;
 2434    ³        chr(20) + ' '
 2435    ³    @ 01, 00 say  ;
 2436    ³        'RIF                                                     RECIBO Nro.:          '
 2437    ³    @ 01, 04 say l_rif
 2438    ³    @ 01, 68 say chr(14) + ng +  ;
 2439    ³        ltrim(str(mrecibo)) + ngn
 2440    ³    @ 02, 00 say chr(15) + ' '
 2441    ³    @ 02, 00 say l_direccio
 2442    ³    @ 02, pcol() say chr(18) +  ;
 2443    ³        chr(20) + ' '
 2444    ³    @ 02, 00 say  ;
 2445    ³        '                                                        FECHA PAGO :          '
 2446    ³    @ 02, 68 say mfechap picture  ;
 2447    ³        '@E'
 2448    ³    @ 03, 00 say  ;
 2449    ³        '                                                      '
 2450    ³    @ 03, 28 say chr(14) +  ;
 2451    ³        chr(15) + 'RECIBO DE PAGO' +  ;
 2452    ³        chr(18) + chr(20) + ' '
 2453    ³    @ 04, 00 say  ;
 2454    ³        '                                                      ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ» '
 2455    ³    @ 05, 00 say  ;
 2456    ³        'C.I.:                                                 º Bs.                º '
 2457    ³    @ 05, 61 say mmontop picture  ;
 2458    ³        '9,999,999.99'
 2459    ³    @ 05, 06 say m.cedula  ;
 2460    ³        picture '!-99999999'
 2461    ³    @ 06, 00 say  ;
 2462    ³        'ALUMNO:                                               ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼ '
 2463    ³    @ 06, 08 say m.nombres  ;
 2464    ³        picture '@!s45'
 2465    ³    @ 07, 00 say 'SEMESTRE: ' +  ;
 2466    ³        m.semestre
 2467    ³    @ 08, 00 say 'TURNO   : ' +  ;
 2468    ³        m.turno
 2469    ³    @ 09, 00 say 'PLAN    : ' +  ;
 2470    ³        mdes1
 2471    ³    xcantidad = letras(mmontop)
 2472    ³    xcantidad = alltrim(xcantidad)
 2473    ³    @ 10, 00 say  ;
 2474    ³        'Hemos recibido la cantidad de:'
 2475    ³    @ 11, 00 say xcantidad  ;
 2476    ³        picture '@!'
 2477    ³    li = 12
 2478    ³    @ li, 00 say  ;
 2479    ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ' +  ;
 2480    ³        ng
 2481    ³    li = li + 1
 2482    ³    @ li, 00 say  ;
 2483    ³        '  C O N C E P T O S                   S A L D O              M O N T O       ' +  ;
 2484    ³        ngn
 2485    ³    li = li + 1
 2486    ³    @ li, 00 say  ;
 2487    ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ'
 2488    ³    mpagado = mmontop
 2489    ³    ii = 1
 2490    ³    li = li + 1
 2491    ³    xsaldo = 0
 2492    ³  ÖÄfor ii = 1 to xnro
 2493    ³  º    lk = ltrim(str(ii))
 2494    ³  º  ÚÄif pagado&lk>=cuota&lk
 2495    ³  ^ÍÍÍÍÍÍÍloop
 2496    ³  º  ÀÄendif
 2497    ³  º  ÚÄif (mpagado+pagado&lk) >= cuota&lk
 2498    ³  º  ³    select 11
 2499    ³  º  ³    set order to codcuota
 2500    ³  º  ³    locate for lapso =  ;
 2501    ³  º  ³        lapmat  ;
 2502    ³  º  ³        .and.  ;
 2503    ³  º  ³        codigo =  ;
 2504    ³  º  ³        m.plancobro  ;
 2505    ³  º  ³        .and. cuota =  ;
 2506    ³  º  ³        ii
 2507    ³  º  ³    xpagado=(cuota&lk-pagado&lk)
 2508    ³  º  ³    mpagado=mpagado-(cuota&lk-pagado&lk)
 2509    ³  º  ³  ÖÄfor ww = 1 to 10
 2510    ³  º  ³  º    lw = ltrim(str(ww))
 2511    ³  º  ³  º    select 11
 2512    ³  º  ³  º  ÚÄif concepto&lw=space(2)
 2513    ³  º  ³  ^ÍÍÍÍÍÍÍloop
 2514    ³  º  ³  º  ÀÄendif
 2515    ³  º  ³  º    mcon=concepto&lw
 2516    ³  º  ³  º    mmon=monto&lw
 2517    ³  º  ³  º    select 12
 2518    ³  º  ³  º  ÚÄif  .not.  ;
 2519    ³  º  ³  º  ³        seek(mcon)
 2520    ³  º  ³  º  ³    mds = 'SIN DESCRIPCION'
 2521    ³  º  ³  º  ÃÄelse
 2522    ³  º  ³  º  ³    mds = alltrim(descripcio)
 2523    ³  º  ³  º  ÀÄendif
 2524    ³  º  ³  º  ÚÄif mdec1 >= 1  ;
 2525    ³  º  ³  º  ³        .and. lin1 =  ;
 2526    ³  º  ³  º  ³        0 .and. ww =  ;
 2527    ³  º  ³  º  ³        1
 2528    ³  º  ³  º  ³    @ li, 00  ;
 2529    ³  º  ³  º  ³        say  ;
 2530    ³  º  ³  º  ³        'CANCELACION MENSUALIDAD MATERIA ADICIONAL:'
 2531    ³  º  ³  º  ³    lin1 = 1
 2532    ³  º  ³  º  ³    li = li +  ;
 2533    ³  º  ³  º  ³        1
 2534    ³  º  ³  º  ÀÄendif
 2535    ³  º  ³  º  ÚÄif mdec1 >= 1  ;
 2536    ³  º  ³  º  ³        .and.  ;
 2537    ³  º  ³  º  ³        mdec2 >= 1  ;
 2538    ³  º  ³  º  ³        .and. lin2 =  ;
 2539    ³  º  ³  º  ³        1 .and. ww =  ;
 2540    ³  º  ³  º  ³        1
 2541    ³  º  ³  º  ³    @ li, 00  ;
 2542    ³  º  ³  º  ³        say  ;
 2543    ³  º  ³  º  ³        'ABONO MENSUALIDAD MATERIA ADICIONAL:'
 2544    ³  º  ³  º  ³    lin2 = 0
 2545    ³  º  ³  º  ³    li = li +  ;
 2546    ³  º  ³  º  ³        1
 2547    ³  º  ³  º  ÀÄendif
 2548    ³  º  ³  º  ÚÄif mdec1 = 0  ;
 2549    ³  º  ³  º  ³        .and.  ;
 2550    ³  º  ³  º  ³        mdec2 >= 1  ;
 2551    ³  º  ³  º  ³        .and. lin3 =  ;
 2552    ³  º  ³  º  ³        0 .and. ww =  ;
 2553    ³  º  ³  º  ³        1
 2554    ³  º  ³  º  ³    @ li, 00  ;
 2555    ³  º  ³  º  ³        say  ;
 2556    ³  º  ³  º  ³        'ABONO MENSUALIDAD MATERIA ADICIONAL:'
 2557    ³  º  ³  º  ³    li = li +  ;
 2558    ³  º  ³  º  ³        1
 2559    ³  º  ³  º  ³    lin3 = 1
 2560    ³  º  ³  º  ÀÄendif
 2561    ³  º  ³  º  ÚÄif ww = 1
 2562    ³  º  ³  º  ³    @ li, 02  ;
 2563    ³  º  ³  º  ³        say  ;
 2564    ³  º  ³  º  ³        mds  ;
 2565    ³  º  ³  º  ³        picture  ;
 2566    ³  º  ³  º  ³        '@!S32'
 2567    ³  º  ³  º  ³    tu = tu +  ;
 2568    ³  º  ³  º  ³        1
 2569    ³  º  ³  º  ÃÄelse
 2570    ³  º  ³  º  ³    @ li, 05  ;
 2571    ³  º  ³  º  ³        say  ;
 2572    ³  º  ³  º  ³        mds  ;
 2573    ³  º  ³  º  ³        picture  ;
 2574    ³  º  ³  º  ³        '@!S29'
 2575    ³  º  ³  º  ÀÄendif
 2576    ³  º  ³  º  ÚÄif mpsaldo&lk > 0;
 2577    ³  º  ³  º  ³        and ww=1
 2578    ³  º  ³  º  ³    @ li, 36  ;
 2579    ³  º  ³  º  ³        say  ;
 2580    ³  º  ³  º  ³        '('
 2581    ³  º  ³  º  ³    @li,38 say mpsaldo&lk;
 2582    ³  º  ³  º  ³        pict '9,999,999.99'
 2583    ³  º  ³  º  ³    @ li, 51  ;
 2584    ³  º  ³  º  ³        say  ;
 2585    ³  º  ³  º  ³        ')'
 2586    ³  º  ³  º  ÀÄendif
 2587    ³  º  ³  º  ÚÄif ww = 1
 2588    ³  º  ³  º  ³    select 2
 2589    ³  º  ³  º  ³    @li,58 say mpagrec&lk;
 2590    ³  º  ³  º  ³        pict '9,999,999.99'
 2591    ³  º  ³  º  ³    imp&lk=1
 2592    ³  º  ³  º  ÀÄendif
 2593    ³  º  ³  º  ÚÄif mdec2 >= 1  ;
 2594    ³  º  ³  º  ³        .and. tu =  ;
 2595    ³  º  ³  º  ³        mdec1  ;
 2596    ³  º  ³  º  ³        .and. ww =  ;
 2597    ³  º  ³  º  ³        1
 2598    ³  º  ³  º  ³    lin2 = 1
 2599    ³  º  ³  º  ÀÄendif
 2600    ³  º  ³  º    li = li + 1
 2601    ³  º  ³  º  ÚÄif li > 20
 2602    ³  º  ³  º  ³    @ 22, 00  ;
 2603    ³  º  ³  º  ³        say  ;
 2604    ³  º  ³  º  ³        'ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»'
 2605    ³  º  ³  º  ³    @ 23, 00  ;
 2606    ³  º  ³  º  ³        say  ;
 2607    ³  º  ³  º  ³        'º            N O T A            º  EFECTIVO   [ ]   CHEQ/DEPOST [ ]           º'
 2608    ³  º  ³  º  ³  ÚÄif mtipop <>  ;
 2609    ³  º  ³  º  ³  ³        'Efectivo'
 2610    ³  º  ³  º  ³  ³    @ 23,  ;
 2611    ³  º  ³  º  ³  ³        65  ;
 2612    ³  º  ³  º  ³  ³        say  ;
 2613    ³  º  ³  º  ³  ³        'X'
 2614    ³  º  ³  º  ³  ÃÄelse
 2615    ³  º  ³  º  ³  ³    @ 23,  ;
 2616    ³  º  ³  º  ³  ³        47  ;
 2617    ³  º  ³  º  ³  ³        say  ;
 2618    ³  º  ³  º  ³  ³        'X'
 2619    ³  º  ³  º  ³  ÀÄendif
 2620    ³  º  ³  º  ³    @ 24, 00  ;
 2621    ³  º  ³  º  ³        say  ;
 2622    ³  º  ³  º  ³        'ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶  NRO. :                                     º'
 2623    ³  º  ³  º  ³    @ 24, 41  ;
 2624    ³  º  ³  º  ³        say  ;
 2625    ³  º  ³  º  ³        mnrode  ;
 2626    ³  º  ³  º  ³        picture  ;
 2627    ³  º  ³  º  ³        '@!'
 2628    ³  º  ³  º  ³    @ 25, 00  ;
 2629    ³  º  ³  º  ³        say  ;
 2630    ³  º  ³  º  ³        'º                               º  BANCO:                                     º'
 2631    ³  º  ³  º  ³    @ 25, 41  ;
 2632    ³  º  ³  º  ³        say  ;
 2633    ³  º  ³  º  ³        mbandes
 2634    ³  º  ³  º  ³    @ 26, 00  ;
 2635    ³  º  ³  º  ³        say  ;
 2636    ³  º  ³  º  ³        'º                               º                                             º'
 2637    ³  º  ³  º  ³    @ 26, 05  ;
 2638    ³  º  ³  º  ³        say  ;
 2639    ³  º  ³  º  ³        'CONTINUA ....'
 2640    ³  º  ³  º  ³    @ 27, 00  ;
 2641    ³  º  ³  º  ³        say  ;
 2642    ³  º  ³  º  ³        'º                               º                        ___________________  º'
 2643    ³  º  ³  º  ³    @ 28, 00  ;
 2644    ³  º  ³  º  ³        say  ;
 2645    ³  º  ³  º  ³        'º                               º                           RECIBIDO POR:     º'
 2646    ³  º  ³  º  ³    @ 29, 00  ;
 2647    ³  º  ³  º  ³        say  ;
 2648    ³  º  ³  º  ³        'ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼'
 2649    ³  º  ³  º  ³    @ 30, 00  ;
 2650    ³  º  ³  º  ³        say  ;
 2651    ³  º  ³  º  ³        ' NOTA: Los Pagos Realizados no estan sujetos a devoluciones'
 2652    ³  º  ³  º  ³    select 9
 2653    ³  º  ³  º  ³    @ 0, 1  ;
 2654    ³  º  ³  º  ³        say  ;
 2655    ³  º  ³  º  ³        '  ' +  ;
 2656    ³  º  ³  º  ³        chr(27) +  ;
 2657    ³  º  ³  º  ³        chr(67) +  ;
 2658    ³  º  ³  º  ³        chr(33)
 2659    ³  º  ³  º  ³    @ 00, 00  ;
 2660    ³  º  ³  º  ³        say  ;
 2661    ³  º  ³  º  ³        chr(18) +  ;
 2662    ³  º  ³  º  ³        chr(20)
 2663    ³  º  ³  º  ³    @ 00, 00  ;
 2664    ³  º  ³  º  ³        say  ;
 2665    ³  º  ³  º  ³        chr(14) +  ;
 2666    ³  º  ³  º  ³        chr(15) +  ;
 2667    ³  º  ³  º  ³        titulo +  ;
 2668    ³  º  ³  º  ³        chr(18) +  ;
 2669    ³  º  ³  º  ³        chr(20) +  ;
 2670    ³  º  ³  º  ³        ' '
 2671    ³  º  ³  º  ³    @ 01, 00  ;
 2672    ³  º  ³  º  ³        say  ;
 2673    ³  º  ³  º  ³        'RIF .                                                   RECIBO Nro.:          '
 2674    ³  º  ³  º  ³    @ 01, 04  ;
 2675    ³  º  ³  º  ³        say  ;
 2676    ³  º  ³  º  ³        l_rif
 2677    ³  º  ³  º  ³    @ 01, 68  ;
 2678    ³  º  ³  º  ³        say  ;
 2679    ³  º  ³  º  ³        chr(14) +  ;
 2680    ³  º  ³  º  ³        ng +  ;
 2681    ³  º  ³  º  ³        ltrim(str(mrecibo)) +  ;
 2682    ³  º  ³  º  ³        ngn
 2683    ³  º  ³  º  ³    @ 02, 00  ;
 2684    ³  º  ³  º  ³        say  ;
 2685    ³  º  ³  º  ³        chr(15) +  ;
 2686    ³  º  ³  º  ³        ' '
 2687    ³  º  ³  º  ³    @ 02, 00  ;
 2688    ³  º  ³  º  ³        say  ;
 2689    ³  º  ³  º  ³        l_direccio
 2690    ³  º  ³  º  ³    @ 02,  ;
 2691    ³  º  ³  º  ³        pcol()  ;
 2692    ³  º  ³  º  ³        say  ;
 2693    ³  º  ³  º  ³        chr(18) +  ;
 2694    ³  º  ³  º  ³        chr(20) +  ;
 2695    ³  º  ³  º  ³        ' '
 2696    ³  º  ³  º  ³    @ 02, 00  ;
 2697    ³  º  ³  º  ³        say  ;
 2698    ³  º  ³  º  ³        '                                                        FECHA PAGO:          '
 2699    ³  º  ³  º  ³    @ 02, 68  ;
 2700    ³  º  ³  º  ³        say  ;
 2701    ³  º  ³  º  ³        mfechap  ;
 2702    ³  º  ³  º  ³        picture  ;
 2703    ³  º  ³  º  ³        '@E'
 2704    ³  º  ³  º  ³    @ 03, 00  ;
 2705    ³  º  ³  º  ³        say  ;
 2706    ³  º  ³  º  ³        '                                                      '
 2707    ³  º  ³  º  ³    @ 03, 28  ;
 2708    ³  º  ³  º  ³        say  ;
 2709    ³  º  ³  º  ³        chr(14) +  ;
 2710    ³  º  ³  º  ³        chr(15) +  ;
 2711    ³  º  ³  º  ³        'RECIBO DE PAGO' +  ;
 2712    ³  º  ³  º  ³        chr(18) +  ;
 2713    ³  º  ³  º  ³        chr(20) +  ;
 2714    ³  º  ³  º  ³        ' '
 2715    ³  º  ³  º  ³    @ 04, 00  ;
 2716    ³  º  ³  º  ³        say  ;
 2717    ³  º  ³  º  ³        '                                                      ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ» '
 2718    ³  º  ³  º  ³    @ 05, 00  ;
 2719    ³  º  ³  º  ³        say  ;
 2720    ³  º  ³  º  ³        'C.I.:                                                 º Bs.                º '
 2721    ³  º  ³  º  ³    @ 05, 61  ;
 2722    ³  º  ³  º  ³        say  ;
 2723    ³  º  ³  º  ³        mmontop  ;
 2724    ³  º  ³  º  ³        picture  ;
 2725    ³  º  ³  º  ³        '9,999,999.99'
 2726    ³  º  ³  º  ³    @ 05, 06  ;
 2727    ³  º  ³  º  ³        say  ;
 2728    ³  º  ³  º  ³        m.cedula  ;
 2729    ³  º  ³  º  ³        picture  ;
 2730    ³  º  ³  º  ³        '!-99999999'
 2731    ³  º  ³  º  ³    @ 06, 00  ;
 2732    ³  º  ³  º  ³        say  ;
 2733    ³  º  ³  º  ³        'ALUMNO:                                               ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼ '
 2734    ³  º  ³  º  ³    @ 06, 08  ;
 2735    ³  º  ³  º  ³        say  ;
 2736    ³  º  ³  º  ³        m.nombres  ;
 2737    ³  º  ³  º  ³        picture  ;
 2738    ³  º  ³  º  ³        '@!s45'
 2739    ³  º  ³  º  ³    @ 07, 00  ;
 2740    ³  º  ³  º  ³        say  ;
 2741    ³  º  ³  º  ³        'SEMESTRE: ' +  ;
 2742    ³  º  ³  º  ³        m.semestre
 2743    ³  º  ³  º  ³    @ 08, 00  ;
 2744    ³  º  ³  º  ³        say  ;
 2745    ³  º  ³  º  ³        'TURNO   : ' +  ;
 2746    ³  º  ³  º  ³        m.turno
 2747    ³  º  ³  º  ³    @ 09, 00  ;
 2748    ³  º  ³  º  ³        say  ;
 2749    ³  º  ³  º  ³        'PLAN    : ' +  ;
 2750    ³  º  ³  º  ³        mdes1
 2751    ³  º  ³  º  ³    xcantidad =  ;
 2752    ³  º  ³  º  ³        letras(mmontop)
 2753    ³  º  ³  º  ³    xcantidad =  ;
 2754    ³  º  ³  º  ³        alltrim(xcantidad)
 2755    ³  º  ³  º  ³    @ 10, 00  ;
 2756    ³  º  ³  º  ³        say  ;
 2757    ³  º  ³  º  ³        'Hemos recibido la cantidad de:'
 2758    ³  º  ³  º  ³    @ 11, 00  ;
 2759    ³  º  ³  º  ³        say  ;
 2760    ³  º  ³  º  ³        xcantidad  ;
 2761    ³  º  ³  º  ³        picture  ;
 2762    ³  º  ³  º  ³        '@!'
 2763    ³  º  ³  º  ³    li = 12
 2764    ³  º  ³  º  ³    @ li, 00  ;
 2765    ³  º  ³  º  ³        say  ;
 2766    ³  º  ³  º  ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ' +  ;
 2767    ³  º  ³  º  ³        ng
 2768    ³  º  ³  º  ³    li = li +  ;
 2769    ³  º  ³  º  ³        1
 2770    ³  º  ³  º  ³    @ li, 00  ;
 2771    ³  º  ³  º  ³        say  ;
 2772    ³  º  ³  º  ³        '  C O N C E P T O S                   S A L D O              M O N T O       ' +  ;
 2773    ³  º  ³  º  ³        ngn
 2774    ³  º  ³  º  ³    li = li +  ;
 2775    ³  º  ³  º  ³        1
 2776    ³  º  ³  º  ³    @ li, 00  ;
 2777    ³  º  ³  º  ³        say  ;
 2778    ³  º  ³  º  ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ'
 2779    ³  º  ³  º  ³    li = li +  ;
 2780    ³  º  ³  º  ³        1
 2781    ³  º  ³  º  ÀÄendif
 2782    ³  º  ³  ÓÄendfor
 2783    ³  º  ÃÄelse
 2784    ³  º  ³  ÚÄif mpagado > 0
 2785    ³  º  ³  ³    select 11
 2786    ³  º  ³  ³    set order to codcuota
 2787    ³  º  ³  ³    locate for  ;
 2788    ³  º  ³  ³        lapso =  ;
 2789    ³  º  ³  ³        lapmat  ;
 2790    ³  º  ³  ³        .and.  ;
 2791    ³  º  ³  ³        codigo =  ;
 2792    ³  º  ³  ³        m.plancobro  ;
 2793    ³  º  ³  ³        .and.  ;
 2794    ³  º  ³  ³        cuota =  ;
 2795    ³  º  ³  ³        ii
 2796    ³  º  ³  ³    xpagado=pagado&lk+mpagado
 2797    ³  º  ³  ³  ÖÄfor ww = 1 to  ;
 2798    ³  º  ³  ³  º        10
 2799    ³  º  ³  ³  º    lw = ltrim(str(ww))
 2800    ³  º  ³  ³  º    select 11
 2801    ³  º  ³  ³  º  ÚÄif concepto&lw=space(2)
 2802    ³  º  ³  ³  ^ÍÍÍÍÍÍÍloop
 2803    ³  º  ³  ³  º  ÀÄendif
 2804    ³  º  ³  ³  º    mcon=concepto&lw
 2805    ³  º  ³  ³  º    mmon=monto&lw
 2806    ³  º  ³  ³  º    select 12
 2807    ³  º  ³  ³  º  ÚÄif  .not.  ;
 2808    ³  º  ³  ³  º  ³        seek(mcon)
 2809    ³  º  ³  ³  º  ³    mds =  ;
 2810    ³  º  ³  ³  º  ³        'SIN DESCRIPCION'
 2811    ³  º  ³  ³  º  ÃÄelse
 2812    ³  º  ³  ³  º  ³    mds =  ;
 2813    ³  º  ³  ³  º  ³        alltrim(descripcio)
 2814    ³  º  ³  ³  º  ÀÄendif
 2815    ³  º  ³  ³  º  ÚÄif mdec1 >=  ;
 2816    ³  º  ³  ³  º  ³        1  ;
 2817    ³  º  ³  ³  º  ³        .and.  ;
 2818    ³  º  ³  ³  º  ³        lin1 =  ;
 2819    ³  º  ³  ³  º  ³        0  ;
 2820    ³  º  ³  ³  º  ³        .and.  ;
 2821    ³  º  ³  ³  º  ³        ww =  ;
 2822    ³  º  ³  ³  º  ³        1
 2823    ³  º  ³  ³  º  ³    @ li,  ;
 2824    ³  º  ³  ³  º  ³        00  ;
 2825    ³  º  ³  ³  º  ³        say  ;
 2826    ³  º  ³  ³  º  ³        'CANCELACION MENSUALIDAD MATERIA ADICIONAL:'
 2827    ³  º  ³  ³  º  ³    lin1 =  ;
 2828    ³  º  ³  ³  º  ³        1
 2829    ³  º  ³  ³  º  ³    li =  ;
 2830    ³  º  ³  ³  º  ³        li +  ;
 2831    ³  º  ³  ³  º  ³        1
 2832    ³  º  ³  ³  º  ÀÄendif
 2833    ³  º  ³  ³  º  ÚÄif mdec1 >=  ;
 2834    ³  º  ³  ³  º  ³        1  ;
 2835    ³  º  ³  ³  º  ³        .and.  ;
 2836    ³  º  ³  ³  º  ³        mdec2 >=  ;
 2837    ³  º  ³  ³  º  ³        1  ;
 2838    ³  º  ³  ³  º  ³        .and.  ;
 2839    ³  º  ³  ³  º  ³        lin2 =  ;
 2840    ³  º  ³  ³  º  ³        1  ;
 2841    ³  º  ³  ³  º  ³        .and.  ;
 2842    ³  º  ³  ³  º  ³        ww =  ;
 2843    ³  º  ³  ³  º  ³        1
 2844    ³  º  ³  ³  º  ³    @ li,  ;
 2845    ³  º  ³  ³  º  ³        00  ;
 2846    ³  º  ³  ³  º  ³        say  ;
 2847    ³  º  ³  ³  º  ³        'ABONO MENSUALIDAD MATERIA ADICIONAL:'
 2848    ³  º  ³  ³  º  ³    lin2 =  ;
 2849    ³  º  ³  ³  º  ³        0
 2850    ³  º  ³  ³  º  ³    li =  ;
 2851    ³  º  ³  ³  º  ³        li +  ;
 2852    ³  º  ³  ³  º  ³        1
 2853    ³  º  ³  ³  º  ÀÄendif
 2854    ³  º  ³  ³  º  ÚÄif mdec1 =  ;
 2855    ³  º  ³  ³  º  ³        0  ;
 2856    ³  º  ³  ³  º  ³        .and.  ;
 2857    ³  º  ³  ³  º  ³        mdec2 >=  ;
 2858    ³  º  ³  ³  º  ³        1  ;
 2859    ³  º  ³  ³  º  ³        .and.  ;
 2860    ³  º  ³  ³  º  ³        lin3 =  ;
 2861    ³  º  ³  ³  º  ³        0  ;
 2862    ³  º  ³  ³  º  ³        .and.  ;
 2863    ³  º  ³  ³  º  ³        ww =  ;
 2864    ³  º  ³  ³  º  ³        1
 2865    ³  º  ³  ³  º  ³    @ li,  ;
 2866    ³  º  ³  ³  º  ³        00  ;
 2867    ³  º  ³  ³  º  ³        say  ;
 2868    ³  º  ³  ³  º  ³        'ABONO MENSUALIDAD MATERIA ADICIONAL:'
 2869    ³  º  ³  ³  º  ³    li =  ;
 2870    ³  º  ³  ³  º  ³        li +  ;
 2871    ³  º  ³  ³  º  ³        1
 2872    ³  º  ³  ³  º  ³    lin3 =  ;
 2873    ³  º  ³  ³  º  ³        1
 2874    ³  º  ³  ³  º  ÀÄendif
 2875    ³  º  ³  ³  º  ÚÄif ww =  ;
 2876    ³  º  ³  ³  º  ³        1
 2877    ³  º  ³  ³  º  ³    @ li,  ;
 2878    ³  º  ³  ³  º  ³        02  ;
 2879    ³  º  ³  ³  º  ³        say  ;
 2880    ³  º  ³  ³  º  ³        mds  ;
 2881    ³  º  ³  ³  º  ³        picture  ;
 2882    ³  º  ³  ³  º  ³        '@!S32'
 2883    ³  º  ³  ³  º  ³    tu =  ;
 2884    ³  º  ³  ³  º  ³        tu +  ;
 2885    ³  º  ³  ³  º  ³        1
 2886    ³  º  ³  ³  º  ÃÄelse
 2887    ³  º  ³  ³  º  ³    @ li,  ;
 2888    ³  º  ³  ³  º  ³        05  ;
 2889    ³  º  ³  ³  º  ³        say  ;
 2890    ³  º  ³  ³  º  ³        mds  ;
 2891    ³  º  ³  ³  º  ³        picture  ;
 2892    ³  º  ³  ³  º  ³        '@!S29'
 2893    ³  º  ³  ³  º  ÀÄendif
 2894    ³  º  ³  ³  º    select 2
 2895    ³  º  ³  ³  º  ÚÄif mpsaldo&lk;
 2896    ³  º  ³  ³  º  ³        > 0 and ww=1
 2897    ³  º  ³  ³  º  ³    @ li,  ;
 2898    ³  º  ³  ³  º  ³        36  ;
 2899    ³  º  ³  ³  º  ³        say  ;
 2900    ³  º  ³  ³  º  ³        '('
 2901    ³  º  ³  ³  º  ³    @li,38 say;
 2902    ³  º  ³  ³  º  ³        mpsaldo&lk pict '9,999,999.99'
 2903    ³  º  ³  ³  º  ³    @ li,  ;
 2904    ³  º  ³  ³  º  ³        51  ;
 2905    ³  º  ³  ³  º  ³        say  ;
 2906    ³  º  ³  ³  º  ³        ')'
 2907    ³  º  ³  ³  º  ÀÄendif
 2908    ³  º  ³  ³  º  ÚÄif ww =  ;
 2909    ³  º  ³  ³  º  ³        1
 2910    ³  º  ³  ³  º  ³    @li,58 say;
 2911    ³  º  ³  ³  º  ³        mpagrec&lk pict '9,999,999.99'
 2912    ³  º  ³  ³  º  ÀÄendif
 2913    ³  º  ³  ³  º  ÚÄif mdec2 >=  ;
 2914    ³  º  ³  ³  º  ³        1  ;
 2915    ³  º  ³  ³  º  ³        .and.  ;
 2916    ³  º  ³  ³  º  ³        tu =  ;
 2917    ³  º  ³  ³  º  ³        mdec1  ;
 2918    ³  º  ³  ³  º  ³        .and.  ;
 2919    ³  º  ³  ³  º  ³        ww =  ;
 2920    ³  º  ³  ³  º  ³        1
 2921    ³  º  ³  ³  º  ³    lin2 =  ;
 2922    ³  º  ³  ³  º  ³        1
 2923    ³  º  ³  ³  º  ÀÄendif
 2924    ³  º  ³  ³  º    li = li +  ;
 2925    ³  º  ³  ³  º        1
 2926    ³  º  ³  ³  º  ÚÄif li >  ;
 2927    ³  º  ³  ³  º  ³        20
 2928    ³  º  ³  ³  º  ³    @ 22,  ;
 2929    ³  º  ³  ³  º  ³        00  ;
 2930    ³  º  ³  ³  º  ³        say  ;
 2931    ³  º  ³  ³  º  ³        'ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»'
 2932    ³  º  ³  ³  º  ³    @ 23,  ;
 2933    ³  º  ³  ³  º  ³        00  ;
 2934    ³  º  ³  ³  º  ³        say  ;
 2935    ³  º  ³  ³  º  ³        'º            N O T A            º  EFECTIVO   [ ]   CHEQ/DEPOST [ ]           º'
 2936    ³  º  ³  ³  º  ³  ÚÄif mtipop <>  ;
 2937    ³  º  ³  ³  º  ³  ³        'Efectivo'
 2938    ³  º  ³  ³  º  ³  ³    @ 23, 65 say 'X'
 2939    ³  º  ³  ³  º  ³  ÃÄelse
 2940    ³  º  ³  ³  º  ³  ³    @ 23, 47 say 'X'
 2941    ³  º  ³  ³  º  ³  ÀÄendif
 2942    ³  º  ³  ³  º  ³    @ 24,  ;
 2943    ³  º  ³  ³  º  ³        00  ;
 2944    ³  º  ³  ³  º  ³        say  ;
 2945    ³  º  ³  ³  º  ³        'ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶  NRO. :                                     º'
 2946    ³  º  ³  ³  º  ³    @ 24,  ;
 2947    ³  º  ³  ³  º  ³        41  ;
 2948    ³  º  ³  ³  º  ³        say  ;
 2949    ³  º  ³  ³  º  ³        mnrode  ;
 2950    ³  º  ³  ³  º  ³        picture  ;
 2951    ³  º  ³  ³  º  ³        '@!'
 2952    ³  º  ³  ³  º  ³    @ 25,  ;
 2953    ³  º  ³  ³  º  ³        00  ;
 2954    ³  º  ³  ³  º  ³        say  ;
 2955    ³  º  ³  ³  º  ³        'º                               º  BANCO:                                     º'
 2956    ³  º  ³  ³  º  ³    @ 25,  ;
 2957    ³  º  ³  ³  º  ³        41  ;
 2958    ³  º  ³  ³  º  ³        say  ;
 2959    ³  º  ³  ³  º  ³        mbandes
 2960    ³  º  ³  ³  º  ³    @ 26,  ;
 2961    ³  º  ³  ³  º  ³        00  ;
 2962    ³  º  ³  ³  º  ³        say  ;
 2963    ³  º  ³  ³  º  ³        'º                               º                                             º'
 2964    ³  º  ³  ³  º  ³    @ 26,  ;
 2965    ³  º  ³  ³  º  ³        05  ;
 2966    ³  º  ³  ³  º  ³        say  ;
 2967    ³  º  ³  ³  º  ³        'CONTINUA ....'
 2968    ³  º  ³  ³  º  ³    @ 27,  ;
 2969    ³  º  ³  ³  º  ³        00  ;
 2970    ³  º  ³  ³  º  ³        say  ;
 2971    ³  º  ³  ³  º  ³        'º                               º                        ___________________  º'
 2972    ³  º  ³  ³  º  ³    @ 28,  ;
 2973    ³  º  ³  ³  º  ³        00  ;
 2974    ³  º  ³  ³  º  ³        say  ;
 2975    ³  º  ³  ³  º  ³        'º                               º                           RECIBIDO POR:     º'
 2976    ³  º  ³  ³  º  ³    @ 29,  ;
 2977    ³  º  ³  ³  º  ³        00  ;
 2978    ³  º  ³  ³  º  ³        say  ;
 2979    ³  º  ³  ³  º  ³        'ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼'
 2980    ³  º  ³  ³  º  ³    @ 30,  ;
 2981    ³  º  ³  ³  º  ³        00  ;
 2982    ³  º  ³  ³  º  ³        say  ;
 2983    ³  º  ³  ³  º  ³        ' NOTA: Los Pagos Realizados no estan sujetos a devoluciones'
 2984    ³  º  ³  ³  º  ³    select  ;
 2985    ³  º  ³  ³  º  ³        9
 2986    ³  º  ³  ³  º  ³    @ 0,  ;
 2987    ³  º  ³  ³  º  ³        1  ;
 2988    ³  º  ³  ³  º  ³        say  ;
 2989    ³  º  ³  ³  º  ³        '  ' +  ;
 2990    ³  º  ³  ³  º  ³        chr(27) +  ;
 2991    ³  º  ³  ³  º  ³        chr(67) +  ;
 2992    ³  º  ³  ³  º  ³        chr(33)
 2993    ³  º  ³  ³  º  ³    @ 00,  ;
 2994    ³  º  ³  ³  º  ³        00  ;
 2995    ³  º  ³  ³  º  ³        say  ;
 2996    ³  º  ³  ³  º  ³        chr(18) +  ;
 2997    ³  º  ³  ³  º  ³        chr(20)
 2998    ³  º  ³  ³  º  ³    @ 00,  ;
 2999    ³  º  ³  ³  º  ³        00  ;
 3000    ³  º  ³  ³  º  ³        say  ;
 3001    ³  º  ³  ³  º  ³        chr(14) +  ;
 3002    ³  º  ³  ³  º  ³        chr(15) +  ;
 3003    ³  º  ³  ³  º  ³        titulo +  ;
 3004    ³  º  ³  ³  º  ³        chr(18) +  ;
 3005    ³  º  ³  ³  º  ³        chr(20) +  ;
 3006    ³  º  ³  ³  º  ³        ' '
 3007    ³  º  ³  ³  º  ³    @ 01,  ;
 3008    ³  º  ³  ³  º  ³        00  ;
 3009    ³  º  ³  ³  º  ³        say  ;
 3010    ³  º  ³  ³  º  ³        'RIF .                                                   RECIBO Nro.:          '
 3011    ³  º  ³  ³  º  ³    @ 01,  ;
 3012    ³  º  ³  ³  º  ³        04  ;
 3013    ³  º  ³  ³  º  ³        say  ;
 3014    ³  º  ³  ³  º  ³        l_rif
 3015    ³  º  ³  ³  º  ³    @ 01,  ;
 3016    ³  º  ³  ³  º  ³        68  ;
 3017    ³  º  ³  ³  º  ³        say  ;
 3018    ³  º  ³  ³  º  ³        chr(14) +  ;
 3019    ³  º  ³  ³  º  ³        ng +  ;
 3020    ³  º  ³  ³  º  ³        ltrim(str(mrecibo)) +  ;
 3021    ³  º  ³  ³  º  ³        ngn
 3022    ³  º  ³  ³  º  ³    @ 02,  ;
 3023    ³  º  ³  ³  º  ³        00  ;
 3024    ³  º  ³  ³  º  ³        say  ;
 3025    ³  º  ³  ³  º  ³        chr(15) +  ;
 3026    ³  º  ³  ³  º  ³        ' '
 3027    ³  º  ³  ³  º  ³    @ 02,  ;
 3028    ³  º  ³  ³  º  ³        00  ;
 3029    ³  º  ³  ³  º  ³        say  ;
 3030    ³  º  ³  ³  º  ³        l_direccio
 3031    ³  º  ³  ³  º  ³    @ 02,  ;
 3032    ³  º  ³  ³  º  ³        pcol()  ;
 3033    ³  º  ³  ³  º  ³        say  ;
 3034    ³  º  ³  ³  º  ³        chr(18) +  ;
 3035    ³  º  ³  ³  º  ³        chr(20) +  ;
 3036    ³  º  ³  ³  º  ³        ' '
 3037    ³  º  ³  ³  º  ³    @ 02,  ;
 3038    ³  º  ³  ³  º  ³        00  ;
 3039    ³  º  ³  ³  º  ³        say  ;
 3040    ³  º  ³  ³  º  ³        '                                                        FECHA PAGO:          '
 3041    ³  º  ³  ³  º  ³    @ 02,  ;
 3042    ³  º  ³  ³  º  ³        68  ;
 3043    ³  º  ³  ³  º  ³        say  ;
 3044    ³  º  ³  ³  º  ³        mfechap  ;
 3045    ³  º  ³  ³  º  ³        picture  ;
 3046    ³  º  ³  ³  º  ³        '@E'
 3047    ³  º  ³  ³  º  ³    @ 03,  ;
 3048    ³  º  ³  ³  º  ³        00  ;
 3049    ³  º  ³  ³  º  ³        say  ;
 3050    ³  º  ³  ³  º  ³        '                                                      '
 3051    ³  º  ³  ³  º  ³    @ 03,  ;
 3052    ³  º  ³  ³  º  ³        28  ;
 3053    ³  º  ³  ³  º  ³        say  ;
 3054    ³  º  ³  ³  º  ³        chr(14) +  ;
 3055    ³  º  ³  ³  º  ³        chr(15) +  ;
 3056    ³  º  ³  ³  º  ³        'RECIBO DE PAGO' +  ;
 3057    ³  º  ³  ³  º  ³        chr(18) +  ;
 3058    ³  º  ³  ³  º  ³        chr(20) +  ;
 3059    ³  º  ³  ³  º  ³        ' '
 3060    ³  º  ³  ³  º  ³    @ 04,  ;
 3061    ³  º  ³  ³  º  ³        00  ;
 3062    ³  º  ³  ³  º  ³        say  ;
 3063    ³  º  ³  ³  º  ³        '                                                      ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ» '
 3064    ³  º  ³  ³  º  ³    @ 05,  ;
 3065    ³  º  ³  ³  º  ³        00  ;
 3066    ³  º  ³  ³  º  ³        say  ;
 3067    ³  º  ³  ³  º  ³        'C.I.:                                                 º Bs.                º '
 3068    ³  º  ³  ³  º  ³    @ 05,  ;
 3069    ³  º  ³  ³  º  ³        61  ;
 3070    ³  º  ³  ³  º  ³        say  ;
 3071    ³  º  ³  ³  º  ³        mmontop  ;
 3072    ³  º  ³  ³  º  ³        picture  ;
 3073    ³  º  ³  ³  º  ³        '9,999,999.99'
 3074    ³  º  ³  ³  º  ³    @ 05,  ;
 3075    ³  º  ³  ³  º  ³        06  ;
 3076    ³  º  ³  ³  º  ³        say  ;
 3077    ³  º  ³  ³  º  ³        m.cedula  ;
 3078    ³  º  ³  ³  º  ³        picture  ;
 3079    ³  º  ³  ³  º  ³        '!-99999999'
 3080    ³  º  ³  ³  º  ³    @ 06,  ;
 3081    ³  º  ³  ³  º  ³        00  ;
 3082    ³  º  ³  ³  º  ³        say  ;
 3083    ³  º  ³  ³  º  ³        'ALUMNO:                                               ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼ '
 3084    ³  º  ³  ³  º  ³    @ 06,  ;
 3085    ³  º  ³  ³  º  ³        08  ;
 3086    ³  º  ³  ³  º  ³        say  ;
 3087    ³  º  ³  ³  º  ³        m.nombres  ;
 3088    ³  º  ³  ³  º  ³        picture  ;
 3089    ³  º  ³  ³  º  ³        '@!s45'
 3090    ³  º  ³  ³  º  ³    @ 07,  ;
 3091    ³  º  ³  ³  º  ³        00  ;
 3092    ³  º  ³  ³  º  ³        say  ;
 3093    ³  º  ³  ³  º  ³        'SEMESTRE: ' +  ;
 3094    ³  º  ³  ³  º  ³        m.semestre
 3095    ³  º  ³  ³  º  ³    @ 08,  ;
 3096    ³  º  ³  ³  º  ³        00  ;
 3097    ³  º  ³  ³  º  ³        say  ;
 3098    ³  º  ³  ³  º  ³        'TURNO   : ' +  ;
 3099    ³  º  ³  ³  º  ³        m.turno
 3100    ³  º  ³  ³  º  ³    @ 08,  ;
 3101    ³  º  ³  ³  º  ³        pcol() +  ;
 3102    ³  º  ³  ³  º  ³        2  ;
 3103    ³  º  ³  ³  º  ³        say  ;
 3104    ³  º  ³  ³  º  ³        m.representa  ;
 3105    ³  º  ³  ³  º  ³        picture  ;
 3106    ³  º  ³  ³  º  ³        '@!'
 3107    ³  º  ³  ³  º  ³    @ 09,  ;
 3108    ³  º  ³  ³  º  ³        00  ;
 3109    ³  º  ³  ³  º  ³        say  ;
 3110    ³  º  ³  ³  º  ³        'PLAN    : ' +  ;
 3111    ³  º  ³  ³  º  ³        mdes1
 3112    ³  º  ³  ³  º  ³    xcantidad =  ;
 3113    ³  º  ³  ³  º  ³        letras(mmontop)
 3114    ³  º  ³  ³  º  ³    xcantidad =  ;
 3115    ³  º  ³  ³  º  ³        alltrim(xcantidad)
 3116    ³  º  ³  ³  º  ³    @ 10,  ;
 3117    ³  º  ³  ³  º  ³        00  ;
 3118    ³  º  ³  ³  º  ³        say  ;
 3119    ³  º  ³  ³  º  ³        'Hemos recibido la cantidad de:'
 3120    ³  º  ³  ³  º  ³    @ 11,  ;
 3121    ³  º  ³  ³  º  ³        00  ;
 3122    ³  º  ³  ³  º  ³        say  ;
 3123    ³  º  ³  ³  º  ³        xcantidad  ;
 3124    ³  º  ³  ³  º  ³        picture  ;
 3125    ³  º  ³  ³  º  ³        '@!'
 3126    ³  º  ³  ³  º  ³    li =  ;
 3127    ³  º  ³  ³  º  ³        12
 3128    ³  º  ³  ³  º  ³    @ li,  ;
 3129    ³  º  ³  ³  º  ³        00  ;
 3130    ³  º  ³  ³  º  ³        say  ;
 3131    ³  º  ³  ³  º  ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ' +  ;
 3132    ³  º  ³  ³  º  ³        ng
 3133    ³  º  ³  ³  º  ³    li =  ;
 3134    ³  º  ³  ³  º  ³        li +  ;
 3135    ³  º  ³  ³  º  ³        1
 3136    ³  º  ³  ³  º  ³    @ li,  ;
 3137    ³  º  ³  ³  º  ³        00  ;
 3138    ³  º  ³  ³  º  ³        say  ;
 3139    ³  º  ³  ³  º  ³        '  C O N C E P T O S                                          M O N T O       ' +  ;
 3140    ³  º  ³  ³  º  ³        ngn
 3141    ³  º  ³  ³  º  ³    li =  ;
 3142    ³  º  ³  ³  º  ³        li +  ;
 3143    ³  º  ³  ³  º  ³        1
 3144    ³  º  ³  ³  º  ³    @ li,  ;
 3145    ³  º  ³  ³  º  ³        00  ;
 3146    ³  º  ³  ³  º  ³        say  ;
 3147    ³  º  ³  ³  º  ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ'
 3148    ³  º  ³  ³  º  ³    li =  ;
 3149    ³  º  ³  ³  º  ³        li +  ;
 3150    ³  º  ³  ³  º  ³        1
 3151    ³  º  ³  ³  º  ÀÄendif
 3152    ³  º  ³  ³  ÓÄendfor
 3153    ³  º  ³  ÀÄendif
 3154    ³  vÍÍÍÍÍÍÍexit
 3155    ³  º  ÀÄendif
 3156    ³  ÓÄendfor
 3157    ³    @ 22, 00 say  ;
 3158    ³        'ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»'
 3159    ³    @ 23, 00 say  ;
 3160    ³        'º            N O T A            º  EFECTIVO   [ ]   CHEQ/DEPOST [ ]           º'
 3161    ³  ÚÄif mtipop <> 'Efectivo'
 3162    ³  ³    @ 23, 65 say 'X'
 3163    ³  ÃÄelse
 3164    ³  ³    @ 23, 47 say 'X'
 3165    ³  ÀÄendif
 3166    ³    @ 24, 00 say  ;
 3167    ³        'ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶  NRO. :                                     º'
 3168    ³    @ 24, 41 say mnrode picture  ;
 3169    ³        '@!'
 3170    ³    @ 25, 00 say  ;
 3171    ³        'º                               º  BANCO:                                     º'
 3172    ³    @ 25, 41 say mbandes
 3173    ³    @ 26, 00 say  ;
 3174    ³        'º                               º                                             º'
 3175    ³    @ 27, 00 say  ;
 3176    ³        'º                               º                        ___________________  º'
 3177    ³    @ 28, 00 say  ;
 3178    ³        'º                               º                           RECIBIDO POR:     º'
 3179    ³    @ 29, 00 say  ;
 3180    ³        'ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼'
 3181    ³    @ 30, 00 say  ;
 3182    ³        ' NOTA: Los Pagos Realizados no estan sujetos a devoluciones'
 3183    ³    eject
 3184    ÀÄendif
 3185      return
 3186      *
 3187      *: EOF: SCP20333.ACT

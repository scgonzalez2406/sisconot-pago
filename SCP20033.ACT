    1  *:*****************************************************************************
    2  *:
    3  *: Procedure file: Z:\SISTEMA\SCP20033.PRG
    4  *:
    5  *:         System: 
    6  *:         Author: 
    7  *:      Copyright (c) 1910, 
    8  *:  Last modified: 25/04/107     11:21
    9  *:
   10  *:  Procs & Fncts: VALIDAR
   11  *:               : DEUDA_VEN3()
   12  *:               : DEUDA_VEN1()
   13  *:               : DEUDA_VEN2()
   14  *:               : MBANCOS()
   15  *:               : MCOBRAD()
   16  *:               : REPITE_REC
   17  *:
   18  *:         Set by: SCP20333.PRG                      
   19  *:
   20  *:          Calls: SPACE()            (function  in ?)
   21  *:               : CHR()              (function  in ?)
   22  *:               : VARREAD()          (function  in ?)
   23  *:               : VALIDAR            (procedure in SCP20033.PRG)
   24  *:               : LASTKEY()          (function  in ?)
   25  *:               : IIF()              (function  in ?)
   26  *:               : LEN()              (function  in ?)
   27  *:               : LTRIM()            (function  in ?)
   28  *:               : STR()              (function  in ?)
   29  *:               : BUSQUEDA()         (function  in ?)
   30  *:               : SUBSTR()           (function  in ?)
   31  *:               : VAL()              (function  in ?)
   32  *:               : MSGERRO()          (function  in ?)
   33  *:               : FOUND()            (function  in ?)
   34  *:               : LEFT()             (function  in ?)
   35  *:               : SEEK()             (function  in ?)
   36  *:               : DEUDA_VEN3()       (function  in SCP20033.PRG)
   37  *:               : DEUDA_VEN1()       (function  in SCP20033.PRG)
   38  *:               : DEUDA_VEN2()       (function  in SCP20033.PRG)
   39  *:               : ALLTRIM()          (function  in ?)
   40  *:               : DATE()             (function  in ?)
   41  *:               : EOF()              (function  in ?)
   42  *:               : COL()              (function  in ?)
   43  *:               : ACEPTA()           (function  in ?)
   44  *:               : SCP20333.PRG
   45  *:               : MBANCOS()          (function  in SCP20033.PRG)
   46  *:               : SALIDA()           (function  in ?)
   47  *:               : BOXFIELD()         (function  in ?)
   48  *:               : MCOBRAD()          (function  in SCP20033.PRG)
   49  *:               : ACEPTA1()          (function  in ?)
   50  *:               : RLOCK()            (function  in ?)
   51  *:               : PRINTER()          (function  in ?)
   52  *:               : PCOL()             (function  in ?)
   53  *:               : LETRAS()           (function  in ?)
   54  *:               : FLOCK()            (function  in ?)
   55  *:               : REPITE_RECIBO.PRG
   56  *:               : WCOLS()            (function  in ?)
   57  *:               : OBJNUM()           (function  in ?)
   58  *:
   59  *:           Uses: LAPSO1.DBF         
   60  *:               : DATOS.DBF          
   61  *:               : MP&LAPMAT.DBF      
   62  *:               : CONTDEUD.DBF           Alias: CONTDEUD
   63  *:               : PLANCOBR.DBF           Alias: PLANCOBR
   64  *:               : DETACOBR.DBF           Alias: DETACOBR
   65  *:               : CONCEPTO.DBF           Alias: CONCEPTO
   66  *:               : LICEO.DBF          
   67  *:               : COBRADOR.DBF           Alias: COBRADOR
   68  *:               : REGPAGOS.DBF           Alias: REGDATOS
   69  *:               : BANCOS.DBF             Alias: BANCOS
   70  *:               : AD&LAPMAT.DBF      
   71  *:
   72  *:      CDX files: DATOS.CDX
   73  *:               : CONTDEUD.CDX
   74  *:               : PLANCOBR.CDX
   75  *:               : DETACOBR.CDX
   76  *:               : CONCEPTO.CDX
   77  *:               : COBRADOR.CDX
   78  *:               : REGPAGOS.CDX
   79  *:               : BANCOS.CDX
   80  *:
   81  *:      Documented 25/04/10 at 11:21               FoxDoc  version 2.10f
   82  *:*****************************************************************************
   83      close databases
   84      set deleted on
   85      set talk off
   86      select 1
   87      use lapso1
   88      m.lapso = lapso1
   89      clear gets
   90      select 1
   91      use datos
   92      set order to cedula
   93      select 2
   94      use mp&lapmat
   95      set order to ced
   96      select 7
   97      use contdeud again alias contdeud order cedula
   98      select 8
   99      use plancobr again alias plancobr order lapcod
  100      select 11
  101      use detacobr again alias detacobr order lapcod
  102      select 12
  103      use concepto again alias concepto order codigo
  104      select 13
  105      use liceo
  106      select 14
  107      use cobrador again alias cobrador order codigo
  108      select 9
  109      use regpagos again alias regdatos order cedula
  110      select 10
  111      use bancos again alias bancos order codigo
  112      select 15
  113      use ad&lapmat
  114      set order to ced
  115      define window record1 from 00, 00  ;
  116          to 24, 79 grow float close  ;
  117          zoom shadow title  ;
  118          'Registro de Control de Pago (SCP20033)'  ;
  119          minimize system color  ;
  120          scheme 5
  121      move window record1 center
  122      activate window record1
  123      xcedula = space(12)
  124      m.nrocont = space(10)
  125      m.nromatad = space(2)
  126      m.nroconad = space(10)
  127      m.swp = 0
  128      m.control = 0
  129      m.pote = 1
  130      on key label f8 keybo chr(13)
  131      on key label f9 keybo chr(13)
  132      on key label tab do validar with varread()
  133      m.nac = 'V'
  134      m.ced = 0
  135      valida1 = 'ABCDEFGHIJKLMNOPQRSTUVXYZ'
  136      valida2 = 'ABCDEFGHIJKLMNOPQRSTUVXYZ*'
  137      mcuota = 00
  138      lin1 = 0
  139      lin2 = 0
  140      mdec1 = 0
  141      mdec2 = 0
  142      tu = 0
  143      mbandes = space(30)
  144    ÉÍdo while .t.
  145    º    nod1 = .f.
  146    º    nod2 = .f.
  147    º    lin1 = 0
  148    º    lin2 = 0
  149    º    lin3 = 0
  150    º    mdec1 = 0
  151    º    mdec2 = 0
  152    º    tu = 0
  153    º    mbandes = space(30)
  154    º  ÚÄif m.pote = 1
  155    º  ³    @ 00, 00 say 'ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»'
  156    º  ³    @ 01, 00 say 'º C‚dula  :             Apell/Nombres :                                      º'
  157    º  ³    @ 02, 00 say 'º Menci¢n :       (             )  Nro.Control:             Semestre :(  )   º'
  158    º  ³    @ 03, 00 say 'º Nro.Mat.Adicionales : (  )       Nro.Control Mat.Adicional:                º'
  159    º  ³    @ 04, 00 say 'ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶'
  160    º  ³    @ 05, 00 say 'º C¢digo del Plan:      Descripci¢n:                                         º'
  161    º  ³    @ 06, 00 say 'º       Total Plan Cobro:               Fecha de Pago    :                   º'
  162    º  ³    @ 07, 00 say 'º           Monto Pagado:               Tipo Pago (E/D/C):                   º'
  163    º  ³    @ 08, 00 say 'º        Saldo por Pagar:               Nro. Dep./Cheq   :                   º'
  164    º  ³    @ 09, 00 say 'º    Total Deuda Vencida:               Banco :                              º'
  165    º  ³    @ 10, 00 say 'º  Monto Cancelar/Abonar:               Cobrador :                           º'
  166    º  ³    @ 11, 00 say 'º CONCEPTOS   ³  Cuotas  ³  Pagado  ³Tº CONCEPTOS    ³  Cuotas  ³  Pagado  ³Tº'
  167    º  ³    @ 11, 01 say ' CONCEPTOS   ³  Cuotas  ³  Pagado  ³Tº CONCEPTOS    ³  Cuotas  ³  Pagado  ³T' color n+/w
  168    º  ³    @ 12, 00 say 'º             ³          ³          ³ º              ³          ³          ³ º'
  169    º  ³    @ 13, 00 say 'º             ³          ³          ³ º              ³          ³          ³ º'
  170    º  ³    @ 14, 00 say 'º             ³          ³          ³ º              ³          ³          ³ º'
  171    º  ³    @ 15, 00 say 'º             ³          ³          ³ º              ³          ³          ³ º'
  172    º  ³    @ 16, 00 say 'º             ³          ³          ³ º              ³          ³          ³ º'
  173    º  ³    @ 17, 00 say 'º             ³          ³          ³ º              ³          ³          ³ º'
  174    º  ³    @ 18, 00 say 'º             ³          ³          ³ º              ³          ³          ³ º'
  175    º  ³    @ 19, 00 say 'º             ³          ³          ³ º              ³          ³          ³ º'
  176    º  ³    @ 20, 00 say 'º             ³          ³          ³ º              ³          ³          ³ º'
  177    º  ³    @ 21, 00 say 'ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÏÍÊÍÍÍÍÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÏÍ¼'
  178    º  ³    m.pote = 2
  179    º  ³    save screen to pelota
  180    º  ÀÄendif
  181    º    restore screen from pelota
  182    º    @ 01, 12 get m.nac picture '@!M V,E,C,R' message 'Ingrese la Nacionalidad del Alumno'
  183    º    @ 01, 13 say '-'
  184    º    @ 01, 14 get m.ced picture '99999999' valid m.ced >= 0 message 'Ingrese el N£mero del Cedula del Alumno' error 'Ingrese al N£mero de Cedula'
  185    º    read
  186    º  ÚÄif lastkey() = -8
  187    º  ³    select 1
  188    º  ³    goto top
  189    º  ³    m.ced = iif(len(ltrim(str(m.ced,10))) < 10,ltrim(str(m.ced,10)) + space(10 -  ;
  190    º  ³        len(ltrim(str(m.ced,10)))),ltrim(str(m.ced,10)))
  191    º  ³    xcedula = m.nac + '-' +m.ced
  192    º  ³    xcedula = busqueda()
  193    º  ³    m.nac = substr(xcedula,1, 1)
  194    º  ³    m.ced = val(substr(xcedula,3, 10))
  195    ^ÍÍÍÍÍÍÍloop
  196    º  ÀÄendif
  197    º  ÚÄif lastkey() = 27
  198    º  ³    entra = .f.
  199    º  ³    on key label tab
  200    º  ³    release window record1
  201    º  ³    close databases
  202  <ÍÍÍÍÍÍÍÍÍreturn
  203    º  ÀÄendif
  204    º  ÚÄif m.ced <= 0
  205    º  ³    = msgerro('Ingrese el Nro. de Cedula')
  206    ^ÍÍÍÍÍÍÍloop
  207    º  ÀÄendif
  208    º    m.ced = iif(len(ltrim(str(m.ced,10))) < 10,ltrim(str(m.ced,10)) + space(10 -  ;
  209    º        len(ltrim(str(m.ced,10)))),ltrim(str(m.ced,10)))
  210    º    xcedula = m.nac + '-' + m.ced
  211    º    select 1
  212    º    set order to cedula
  213    º    seek xcedula
  214    º  ÚÄif  .not. found()
  215    º  ³    = msgerro('Este alumno no esta registrado, verifique')
  216    º  ³    m.nac = 'V'
  217    º  ³    m.ced = 0
  218    ^ÍÍÍÍÍÍÍloop
  219    º  ÀÄendif
  220    º    scatter memo memvar
  221    º    m.cedula = xcedula
  222    º    @ 01, 40 get m.nombres picture '@!S37' message 'Ingrese Apellidos y Nombres de Alumno'
  223    º    m.nac1 = left(m.rep_legal, 1)
  224    º    m.ced1 = val(substr(m.rep_legal,3, 10))
  225    º    select 2
  226    º  ÚÄif seek(xcedula)
  227    º  ³  ÚÄif cierre = 'S'
  228    º  ³  ³    = msgerro('Esta Matricula de pago ya fue cerrada, verifique')
  229    º  ³  ³    m.nac = 'V'
  230    º  ³  ³    m.ced = 0
  231    ^ÍÍÍÍÍÍÍÍÍÍloop
  232    º  ³  ÀÄendif
  233    º  ÀÄendif
  234    º    select 7
  235    º    set order to cedula
  236    º  ÚÄif seek(xcedula)
  237    º  ³    m.saldo = total_d - monto_p
  238    º  ³  ÚÄif m.saldo > 0
  239    º  ³  ³    = msgerro('Este Alumno tiene un registro de deuda vencida pendiente, verifique')
  240    º  ³  ³  ÚÄif lapsomat = space(6)
  241    º  ³  ³  ³  ÚÄif  .not. deuda_ven3()
  242    º  ³  ³  ³  ³    nod1 = .t.
  243    º  ³  ³  ³  ÀÄendif
  244    º  ³  ³  ÃÄelse
  245    º  ³  ³  ³  ÚÄif  .not. deuda_ven1()
  246    º  ³  ³  ³  ³    nod1 = .t.
  247    º  ³  ³  ³  ÀÄendif
  248    º  ³  ³  ³  ÚÄif  .not.  deuda_ven2()
  249    º  ³  ³  ³  ³    nod1 = .t.
  250    º  ³  ³  ³  ÀÄendif
  251    º  ³  ³  ÀÄendif
  252    º  ³  ³  ÚÄif nod1 = .t.
  253    º  ³  ³  ³    m.nac = 'V'
  254    º  ³  ³  ³    m.ced = 0
  255    ^ÍÍÍÍÍÍÍÍÍÍÍÍÍloop
  256    º  ³  ³  ÀÄendif
  257    º  ³  ÀÄendif
  258    º  ÀÄendif
  259    º    select 2
  260    º    set order to ced
  261    º  ÚÄif  .not. seek(xcedula)
  262    º  ³    = msgerro('Este alumno no esta registrado, verifique')
  263    º  ³    m.nac = 'V'
  264    º  ³    m.ced = 0
  265    ^ÍÍÍÍÍÍÍloop
  266    º  ÀÄendif
  267    º  ÚÄif status = 'X'
  268    º  ³    = msgerro(  'Este Alumno fue egresado de la Matricula, verifique'     )
  269    º  ³    m.nac = 'V'
  270    º  ³    m.ced = space(10)
  271    ^ÍÍÍÍÍÍÍloop
  272    º  ÀÄendif
  273    º    scatter memo memvar
  274    º    qcurso = m.cur
  275    º    m.codigo = semestre
  276    º    m.nrocont = matricula
  277    º    @ 02, 12 get qcurso picture '@!M 32012,31022,31023'
  278    º  ÕÍdo case
  279    º  ÆÍcase alltrim(qcurso) =         '32012'
  280    º  ³    @ 02, 19 say     'BASICA'
  281    º  ³    mmencion = 'BASICA'
  282    º  ÆÍcase alltrim(qcurso) =  ;
  283    º  ³        '31022'
  284    º  ³    @ 02, 19 say  ;
  285    º  ³        'CIENCIAS'
  286    º  ³    mmencion = 'CIENCIAS'
  287    º  ÆÍcase alltrim(qcurso) =  ;
  288    º  ³        '31023'
  289    º  ³    @ 02, 19 say  ;
  290    º  ³        'HUMANIDADES'
  291    º  ³    mmencion = 'HUMANIDADES'
  292    º  ÔÍendcase
  293    º    @ 02, 48 get m.nrocont  ;
  294    º        picture '@!'
  295    º    @ 02, 71 get m.codigo  ;
  296    º        picture '@!'
  297    º    m.curso = qcurso
  298    º    m.cedula = xcedula
  299    º    m.ced = xcedula
  300    º    m.ultima = ultimacuot + 1
  301    º    xultimacuo = ultimacuot
  302    º    m.turno = turno
  303    º    clear gets
  304    º    select 15
  305    º    set order to ced
  306    º  ÚÄif seek(xcedula)
  307    º  ³    m.nromatad = nromatad
  308    º  ³    m.nroconad = matricula
  309    º  ³    @ 03, 25 say m.nromatad  ;
  310    º  ³        picture '@!' color w+/ ;
  311    º  ³        bg*
  312    º  ³    @ 03, 62 say m.nroconad  ;
  313    º  ³        picture '@!' color w+/ ;
  314    º  ³        bg*
  315    º  ÀÄendif
  316    º    select 8
  317    º    seek lapmat + m.plancobro
  318    º    mdes1 = alltrim(descripcio)
  319    º    @ 05, 18 say m.plancobro  ;
  320    º        picture '@!' color w+/w
  321    º    @ 05, 36 say mdes1 picture  ;
  322    º        '@!'
  323    º    xnro = nrocuotas
  324    º    save screen to hol
  325    º    select 2
  326    º    ii = 1
  327    º    m.montov = 0.00
  328    º  ÖÄfor ii = 1 to xnro
  329    º  º    lk = ltrim(str(ii))
  330    º  º  ÚÄif cuota&lk=pagado&lk
  331    º  ^ÍÍÍÍÍÍÍloop
  332    º  º  ÀÄendif
  333    º  º    select 11
  334    º  º    set order to codcuota
  335    º  º    locate for lapso =  ;
  336    º  º        lapmat .and.  ;
  337    º  º        codigo =  ;
  338    º  º        m.plancobro  ;
  339    º  º        .and. cuota =  ;
  340    º  º        ii
  341    º  º  ÚÄif fecha_ven >= date()
  342    º  vÍÍÍÍÍÍÍexit
  343    º  º  ÀÄendif
  344    º  º    select 2
  345    º  º    m.montov=m.montov+(cuota&lk-pagado&lk)
  346    º  ÓÄendfor
  347    º    select 2
  348    º    m.saldo_paga = m.total_deud -  ;
  349    º        m.monto_paga
  350    º    @ 06, 26 say m.total_deud  ;
  351    º        picture '99,999,999.99'  ;
  352    º        color w+/w
  353    º    @ 07, 26 say m.monto_paga  ;
  354    º        picture '99,999,999.99'  ;
  355    º        color w+/w
  356    º    @ 08, 26 say m.saldo_paga  ;
  357    º        picture '99,999,999.99'  ;
  358    º        color w+/w
  359    º    @ 09, 26 say m.montov  ;
  360    º        picture '99,999,999.99'  ;
  361    º        color w+/w
  362    º    mcuota=ultimacuot
  363    º    mm = 1
  364    º    select 11
  365    º    seek lapmat + m.plancobro +  ;
  366    º        str(1)
  367    º    swp = 0
  368    º    suma = 0
  369    º    paso = 0
  370    º    li = 12
  371    º    m.planco = m.plancobro
  372    º  ÉÍdo while  .not. eof()
  373    º  º  ÚÄif lapso <> lapmat
  374    º  º  ³    select 11
  375    º  º  ³    skip
  376    º  ^ÍÍÍÍÍÍÍloop
  377    º  º  ÀÄendif
  378    º  º  ÚÄif codigo <> m.planco
  379    º  º  ³    select 11
  380    º  º  ³    skip
  381    º  ^ÍÍÍÍÍÍÍloop
  382    º  º  ÀÄendif
  383    º  º  ÚÄif swp = 0
  384    º  º  ³    mcuota = cuota
  385    º  º  ³    swp = 1
  386    º  º  ³    mcon = concepto1
  387    º  º  ³    col1 = 02
  388    º  º  ³    select 12
  389    º  º  ³    seek mcon
  390    º  º  ³    @ li, col1 say  ;
  391    º  º  ³        left(descripcio,  ;
  392    º  º  ³        11)
  393    º  º  ³    select 11
  394    º  º  ÀÄendif
  395    º  º  ÚÄif mcuota <> cuota
  396    º  º  ³    lk = ltrim(str(mcuota))
  397    º  º  ³    @ li, col() + 2  ;
  398    º  º  ³        say suma picture  ;
  399    º  º  ³        '999,999.99'
  400    º  º  ³    m.cuota&lk=suma
  401    º  º  ³    select 2
  402    º  º  ³    @li,col()+1 say pagado&lk;
  403    º  º  ³        pict '999,999.99'
  404    º  º  ³  ÚÄif pagado&lk > 0
  405    º  º  ³  ³    marca=iif(pagado&lk=suma,'û','í')
  406    º  º  ³  ³    @ li, col() +  ;
  407    º  º  ³  ³        1 say marca  ;
  408    º  º  ³  ³        color w+/bg*
  409    º  º  ³  ÀÄendif
  410    º  º  ³    li = li + 1
  411    º  º  ³  ÚÄif li > 20
  412    º  º  ³  ³    col1 = 41
  413    º  º  ³  ³    li = 12
  414    º  º  ³  ³    paso = 1
  415    º  º  ³  ÃÄelse
  416    º  º  ³  ³  ÚÄif paso = 0
  417    º  º  ³  ³  ³    col1 = 02
  418    º  º  ³  ³  ÃÄelse
  419    º  º  ³  ³  ³    col1 = 41
  420    º  º  ³  ³  ÀÄendif
  421    º  º  ³  ÀÄendif
  422    º  º  ³    select 11
  423    º  º  ³    mcuota = cuota
  424    º  º  ³    mcon = concepto1
  425    º  º  ³    select 12
  426    º  º  ³    seek mcon
  427    º  º  ³    @ li, col1 say  ;
  428    º  º  ³        left(descripcio,  ;
  429    º  º  ³        11)
  430    º  º  ³    select 11
  431    º  º  ³    suma = 0.00
  432    º  º  ³    mcuota = cuota
  433    º  º  ÀÄendif
  434    º  º    ii = 1
  435    º  º  ÖÄfor ii = 1 to 10
  436    º  º  º    lk = ltrim(str(ii))
  437    º  º  º  ÚÄif concepto&lk=space(2)
  438    º  º  ^ÍÍÍÍÍÍÍloop
  439    º  º  º  ÀÄendif
  440    º  º  º  ÚÄif monto&lk=0
  441    º  º  ^ÍÍÍÍÍÍÍloop
  442    º  º  º  ÀÄendif
  443    º  º  º    suma=suma+monto&lk
  444    º  º  ÓÄendfor
  445    º  º    skip
  446    º  ÈÍenddo
  447    º    lk = ltrim(str(mcuota))
  448    º    @ li, col() + 2 say suma  ;
  449    º        picture '999,999.99'
  450    º    m.cuota&lk=suma
  451    º    select 2
  452    º    @li,col()+1 say pagado&lk pict '999,999.99'
  453    º  ÚÄif pagado&lk > 0
  454    º  ³    marca=iif(pagado&lk=suma,'û','í')
  455    º  ³    @ li, col() + 1 say  ;
  456    º  ³        marca color w+/bg*
  457    º  ÀÄendif
  458    º  ÚÄif m.total_deud =  ;
  459    º  ³        m.monto_paga
  460    º  ³    = msgerro( ;
  461    º  ³        'Este Alumno esta Solvente de Pagos, Verifique' ;
  462    º  ³        )
  463    º  ³    m.nac = 'V'
  464    º  ³    m.ced = 0
  465    ^ÍÍÍÍÍÍÍloop
  466    º  ÀÄendif
  467    º    select 2
  468    º  ÚÄif cierre = 'S'
  469    º  ³    = msgerro( ;
  470    º  ³        'Esta Matricula de pago ya fue cerrada, verifique' ;
  471    º  ³        )
  472    º  ³    m.nac = 'V'
  473    º  ³    m.ced = 0
  474    ^ÍÍÍÍÍÍÍloop
  475    º  ÀÄendif
  476    º    select 15
  477    º    set order to ced
  478    º  ÚÄif seek(xcedula)
  479    º  ³  ÚÄif status <> 'X'
  480    º  ³  ³    iii = 1
  481    º  ³  ³    m.montovad = 0.00
  482    º  ³  ³  ÖÄfor iii = 1 to  ;
  483    º  ³  ³  º        xnro
  484    º  ³  ³  º    lq = ltrim(str(iii))
  485    º  ³  ³  º  ÚÄif cuota&lq=pagado&lq
  486    º  ³  ³  ^ÍÍÍÍÍÍÍloop
  487    º  ³  ³  º  ÀÄendif
  488    º  ³  ³  º    select 11
  489    º  ³  ³  º    set order to codcuota
  490    º  ³  ³  º    locate for  ;
  491    º  ³  ³  º        lapso =  ;
  492    º  ³  ³  º        lapmat  ;
  493    º  ³  ³  º        .and.  ;
  494    º  ³  ³  º        codigo =  ;
  495    º  ³  ³  º        m.plancobro  ;
  496    º  ³  ³  º        .and.  ;
  497    º  ³  ³  º        cuota =  ;
  498    º  ³  ³  º        iii
  499    º  ³  ³  º  ÚÄif fecha_ven >=  ;
  500    º  ³  ³  º  ³        date()
  501    º  ³  ³  vÍÍÍÍÍÍÍexit
  502    º  ³  ³  º  ÀÄendif
  503    º  ³  ³  º    select 15
  504    º  ³  ³  º    m.montovad=m.montovad+(cuota&lq-pagado&lq)
  505    º  ³  ³  ÓÄendfor
  506    º  ³  ³  ÚÄif m.montovad > 0  ;
  507    º  ³  ³  ³        .and. entra =  ;
  508    º  ³  ³  ³        .f.
  509    º  ³  ³  ³    = msgerro( ;
  510    º  ³  ³  ³        'Este Alumno tiene Deuda Vencida de Materia Adicional, verifique' ;
  511    º  ³  ³  ³        )
  512    º  ³  ³  ³    opc = acepta( ;
  513    º  ³  ³  ³        'Ir a Proceso de Pago de Mat. Adicional' ;
  514    º  ³  ³  ³        )
  515    º  ³  ³  ³  ÚÄif opc = 1
  516    º  ³  ³  ³  ³    entra = .t.
  517    º  ³  ³  ³  ³    do scp20333
  518    º  ³  ³  ³  ³    on key label;
  519    º  ³  ³  ³  ³        tab
  520    º  ³  ³  ³  ³    release window  ;
  521    º  ³  ³  ³  ³        record1
  522    º  ³  ³  ³  ³    close databases
  523  <ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍreturn
  524    º  ³  ³  ³  ÀÄendif
  525    º  ³  ³  ÀÄendif
  526    º  ³  ÀÄendif
  527    º  ÀÄendif
  528    º    select 2
  529    º    mfechap = date()
  530    º    mtipop = 'Efectivo'
  531    º    mnrode = space(20)
  532    º    mbanco = space(2)
  533    º    mmontop = 0.00
  534    º    mdesban = space(20)
  535    º    m.choice = 1
  536    º    mcobrador = space(2)
  537    º    swp = 0
  538    º    p = 0
  539    º    save screen to hi
  540    º  ÉÍdo while .t.
  541    º  º    restore screen from hi
  542    º  º    @ 06, 58 say mfechap  ;
  543    º  º        picture '@E'
  544    º  º    @ 07, 58 get mtipop  ;
  545    º  º        default 'Efectivo'  ;
  546    º  º        picture  ;
  547    º  º        '@!M Deposito,Cheque,Efectivo'
  548    º  º    read
  549    º  º  ÚÄif mtipop <> 'Efectivo'
  550    º  º  ³    @ 08, 58 get  ;
  551    º  º  ³        mnrode picture  ;
  552    º  º  ³        '@!S15' valid  ;
  553    º  º  ³        mnrode <>  ;
  554    º  º  ³        space(20) error  ;
  555    º  º  ³        'El N£mero de la Transacci¢n esta en blanco'
  556    º  º  ³    @ 09, 47 get  ;
  557    º  º  ³        mbanco picture  ;
  558    º  º  ³        '@!' valid  ;
  559    º  º  ³        mbancos(mbanco)
  560    º  º  ³    read
  561    º  º  ³  ÚÄif lastkey() = 27
  562    º  º  ³  ³    p = salida()
  563    º  º  ³  ³  ÚÄif p = 2
  564    º  º  ³  ³  ³    entra = .f.
  565    º  º  ³  ³  ³    on key label;
  566    º  º  ³  ³  ³        f4
  567    º  vÍÍÍÍÍÍÍÍÍÍÍÍÍexit
  568    º  º  ³  ³  ÀÄendif
  569    º  ^ÍÍÍÍÍÍÍÍÍÍloop
  570    º  º  ³  ÀÄendif
  571    º  º  ³    select 10
  572    º  º  ³  ÚÄif  .not.  ;
  573    º  º  ³  ³        seek(mbanco)
  574    º  º  ³  ³    mbanco = boxfield('bancos', ;
  575    º  º  ³  ³        'codigo')
  576    º  º  ³  ÀÄendif
  577    º  º  ³    select 9
  578    º  º  ³    set order to bandepo
  579    º  º  ³  ÚÄif seek(mbanco +  ;
  580    º  º  ³  ³        mnrode)
  581    º  º  ³  ³  ÚÄif status <>  ;
  582    º  º  ³  ³  ³        'D'
  583    º  º  ³  ³  ³    = msgerro( ;
  584    º  º  ³  ³  ³        'Ya existe un registro de pagos con este numero, verifique' ;
  585    º  º  ³  ³  ³        )
  586    º  ^ÍÍÍÍÍÍÍÍÍÍÍÍÍloop
  587    º  º  ³  ³  ÀÄendif
  588    º  º  ³  ÀÄendif
  589    º  º  ³    select 10
  590    º  º  ³    @ 09, 47 say  ;
  591    º  º  ³        mbanco picture  ;
  592    º  º  ³        '@!' color w+/w
  593    º  º  ³    @ 09, col() + 2  ;
  594    º  º  ³        say  ;
  595    º  º  ³        left(descripcio,  ;
  596    º  º  ³        25)
  597    º  º  ³    mbandes = alltrim(descripcio)
  598    º  º  ÀÄendif
  599    º  º    @ 10, 26 get mmontop  ;
  600    º  º        picture  ;
  601    º  º        '99,999,999.99'
  602    º  º    @ 10, 50 get mcobrador  ;
  603    º  º        picture '@!' valid  ;
  604    º  º        mcobrad(mcobrador)
  605    º  º    read
  606    º  º  ÚÄif lastkey() = 27
  607    º  º  ³    p = salida()
  608    º  º  ³  ÚÄif p = 2
  609    º  º  ³  ³    entra = .f.
  610    º  º  ³  ³    on key label f4
  611    º  vÍÍÍÍÍÍÍÍÍÍexit
  612    º  º  ³  ÀÄendif
  613    º  ^ÍÍÍÍÍÍÍloop
  614    º  º  ÀÄendif
  615    º  º  ÚÄif mmontop = 0 .or.  ;
  616    º  º  ³        mmontop >  ;
  617    º  º  ³        m.total_deud
  618    º  º  ³    = msgerro( ;
  619    º  º  ³        'El Monto a Pagar por Concepto de Mensualidad es invalido, verifique' ;
  620    º  º  ³        )
  621    º  ^ÍÍÍÍÍÍÍloop
  622    º  º  ÀÄendif
  623    º  º    select cobrador
  624    º  º  ÚÄif  .not.  ;
  625    º  º  ³        seek(mcobrador)
  626    º  º  ³    mcobrador = boxfield('cobrador', ;
  627    º  º  ³        'codigo')
  628    º  º  ÀÄendif
  629    º  º    select 14
  630    º  º    @ 10, 50 say mcobrador  ;
  631    º  º        picture '@!' color w+/ ;
  632    º  º        w
  633    º  º    @ 10, col() + 2 say  ;
  634    º  º        left(nombres, 20)
  635    º  º    mnomcob = alltrim(nombres)
  636    º  º    opc = acepta1( ;
  637    º  º        'Esta correcto este Monto a Cancelar' ;
  638    º  º        )
  639    º  º  ÚÄif opc = 2
  640    º  ^ÍÍÍÍÍÍÍloop
  641    º  º  ÀÄendif
  642    º  vÍÍÍÍexit
  643    º  ÈÍenddo
  644    º  ÚÄif p = 2
  645    º  ³    m.nac = 'V'
  646    º  ³    m.ced = 0
  647    ^ÍÍÍÍÍÍÍloop
  648    º  ÀÄendif
  649    º    on key label f4
  650    º    mpagado = mmontop
  651    º    np = 1
  652    º  ÖÄfor np = 1 to 12
  653    º  º    np1 = ltrim(str(np))
  654    º  º    mpagrec&np1=0
  655    º  º    mpsaldo&np1=0
  656    º  º    imp&np1=0
  657    º  ÓÄendfor
  658    º    ii = 1
  659    º    li = 12
  660    º    col1 = 26
  661    º    paso = 0
  662    º  ÖÄfor ii = 1 to xnro
  663    º  º    lk = ltrim(str(ii))
  664    º  º  ÚÄif pagado&lk=cuota&lk
  665    º  º  ³    li = li + 1
  666    º  º  ³  ÚÄif li > 20
  667    º  º  ³  ³    col1 = 65
  668    º  º  ³  ³    li = 12
  669    º  º  ³  ÀÄendif
  670    º  ^ÍÍÍÍÍÍÍloop
  671    º  º  ÀÄendif
  672    º  º  ÚÄif (mpagado+pagado&lk) >= m.cuota&lk
  673    º  º  ³    mpagado=mpagado-(m.cuota&lk-pagado&lk)
  674    º  º  ³    mpagrec&lk=m.cuota&lk-pagado&lk
  675    º  º  ³    mpsaldo&lk=0
  676    º  º  ³    @li,col1 say m.cuota&lk;
  677    º  º  ³        pict '999,999.99'
  678    º  º  ³    @ li, col() + 1  ;
  679    º  º  ³        say 'û' color w+/ ;
  680    º  º  ³        bg*
  681    º  º  ³    mdec1 = mdec1 + 1
  682    º  º  ÃÄelse
  683    º  º  ³  ÚÄif mpagado > 0
  684    º  º  ³  ³    @li,col1 say mpagado+pagado&lk;
  685    º  º  ³  ³        pict '999,999.99'
  686    º  º  ³  ³    @ li, col() +  ;
  687    º  º  ³  ³        1 say 'í'  ;
  688    º  º  ³  ³        color w+/bg*
  689    º  º  ³  ³    mpsaldo&lk=m.cuota&lk-mpagado-pagado&lk
  690    º  º  ³  ³    mpagrec&lk=mpagado
  691    º  º  ³  ³    mdec2 = mdec2 +  ;
  692    º  º  ³  ³        1
  693    º  º  ³  ÀÄendif
  694    º  vÍÍÍÍÍÍÍexit
  695    º  º  ÀÄendif
  696    º  º    li = li + 1
  697    º  º  ÚÄif li > 20
  698    º  º  ³    col1 = 65
  699    º  º  ³    li = 12
  700    º  º  ÀÄendif
  701    º  ÓÄendfor
  702    º    opce = acepta1( ;
  703    º        'Proceso este Pago de Mensualidad' ;
  704    º        )
  705    º  ÚÄif opce = 2
  706    º  ³    release window reg
  707    º  ³    on key label f4
  708    º  ³    m.nac = 'V'
  709    º  ³    m.ced = 0
  710    ^ÍÍÍÍÍÍÍloop
  711    º  ÀÄendif
  712    º    mrecibo = 0
  713    º    select 13
  714    º  ÉÍdo while .t.
  715    º  º  ÚÄif rlock()
  716    º  º  ³    replace recibo  ;
  717    º  º  ³        with  ;
  718    º  º  ³        recibo +  ;
  719    º  º  ³        1
  720    º  º  ³    mrecibo = recibo
  721    º  º  ³    unlock
  722    º  vÍÍÍÍÍÍÍexit
  723    º  º  ÀÄendif
  724    º  ÈÍenddo
  725    º    p = printer()
  726    º  ÚÄif p = 2
  727    º  ³    select 2
  728    º  ³    wait window  ;
  729    º  ³        'Nro. del Recibo Generado: ' +  ;
  730    º  ³        ltrim(str(mrecibo)) +  ;
  731    º  ³        chr(13) +  ;
  732    º  ³        'Presione Cualquier Tecla para continuar..'
  733    º  ÃÄelse
  734    º  ³    select 2
  735    º  ³    set device to printer
  736    º  ³    @ 0, 1 say '  ' +  ;
  737    º  ³        chr(27) + chr(67) +  ;
  738    º  ³        chr(33)
  739    º  ³    @ 00, 00 say chr(18) +  ;
  740    º  ³        chr(20)
  741    º  ³    @ 00, 00 say chr(14) +  ;
  742    º  ³        chr(15) + titulo +  ;
  743    º  ³        chr(18) + chr(20) +  ;
  744    º  ³        ' '
  745    º  ³    @ 01, 00 say  ;
  746    º  ³        'RIF                                                     RECIBO Nro.:          '
  747    º  ³    @ 01, 04 say l_rif
  748    º  ³    @ 01, 68 say chr(14) +  ;
  749    º  ³        ng +  ;
  750    º  ³        ltrim(str(mrecibo)) +  ;
  751    º  ³        ngn
  752    º  ³    @ 02, 00 say chr(15) +  ;
  753    º  ³        ' '
  754    º  ³    @ 02, 00 say l_direccio
  755    º  ³    @ 02, pcol() say  ;
  756    º  ³        chr(18) + chr(20) +  ;
  757    º  ³        ' '
  758    º  ³    @ 02, 00 say  ;
  759    º  ³        '                                                        FECHA PAGO :          '
  760    º  ³    @ 02, 68 say mfechap  ;
  761    º  ³        picture '@E'
  762    º  ³    @ 03, 00 say  ;
  763    º  ³        '                                                      '
  764    º  ³    @ 03, 28 say chr(14) +  ;
  765    º  ³        chr(15) +  ;
  766    º  ³        'RECIBO DE PAGO' +  ;
  767    º  ³        chr(18) + chr(20) +  ;
  768    º  ³        ' '
  769    º  ³    @ 04, 00 say  ;
  770    º  ³        '                                                      ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ» '
  771    º  ³    @ 05, 00 say  ;
  772    º  ³        'C.I.:                                                 º Bs.                º '
  773    º  ³    @ 05, 61 say mmontop  ;
  774    º  ³        picture  ;
  775    º  ³        '9,999,999.99'
  776    º  ³    @ 05, 06 say m.cedula  ;
  777    º  ³        picture '!-99999999'
  778    º  ³    @ 06, 00 say  ;
  779    º  ³        'ALUMNO:                                               ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼ '
  780    º  ³    @ 06, 08 say m.nombres  ;
  781    º  ³        picture '@!s45'
  782    º  ³    @ 07, 00 say  ;
  783    º  ³        'SEMESTRE: ' +  ;
  784    º  ³        m.semestre
  785    º  ³    @ 08, 00 say  ;
  786    º  ³        'TURNO   : ' +  ;
  787    º  ³        m.turno
  788    º  ³    xcantidad = letras(mmontop)
  789    º  ³    xcantidad = alltrim(xcantidad)
  790    º  ³    @ 09, 00 say  ;
  791    º  ³        'Hemos recibido la cantidad de:'
  792    º  ³    @ 10, 00 say xcantidad  ;
  793    º  ³        picture '@!'
  794    º  ³    li = 11
  795    º  ³    @ li, 00 say  ;
  796    º  ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ' +  ;
  797    º  ³        ng
  798    º  ³    li = li + 1
  799    º  ³    @ li, 00 say  ;
  800    º  ³        '  C O N C E P T O S                   S A L D O              M O N T O       ' +  ;
  801    º  ³        ngn
  802    º  ³    li = li + 1
  803    º  ³    @ li, 00 say  ;
  804    º  ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ'
  805    º  ³    mpagado = mmontop
  806    º  ³    ii = 1
  807    º  ³    li = li + 1
  808    º  ³    xsaldo = 0
  809    º  ³  ÖÄfor ii = 1 to xnro
  810    º  ³  º    lk = ltrim(str(ii))
  811    º  ³  º  ÚÄif pagado&lk=cuota&lk
  812    º  ³  ^ÍÍÍÍÍÍÍloop
  813    º  ³  º  ÀÄendif
  814    º  ³  º  ÚÄif (mpagado+pagado&lk);
  815    º  ³  º  ³        >= m.cuota&lk
  816    º  ³  º  ³    select 11
  817    º  ³  º  ³    set order to codcuota
  818    º  ³  º  ³    locate for  ;
  819    º  ³  º  ³        lapso =  ;
  820    º  ³  º  ³        lapmat  ;
  821    º  ³  º  ³        .and.  ;
  822    º  ³  º  ³        codigo =  ;
  823    º  ³  º  ³        m.plancobro  ;
  824    º  ³  º  ³        .and.  ;
  825    º  ³  º  ³        cuota =  ;
  826    º  ³  º  ³        ii
  827    º  ³  º  ³    xpagado=(m.cuota&lk-pagado&lk)
  828    º  ³  º  ³    mpagado=mpagado-(m.cuota&lk-pagado&lk)
  829    º  ³  º  ³  ÖÄfor ww = 1 to  ;
  830    º  ³  º  ³  º        10
  831    º  ³  º  ³  º    lw = ltrim(str(ww))
  832    º  ³  º  ³  º    select 11
  833    º  ³  º  ³  º  ÚÄif concepto&lw=space(2)
  834    º  ³  º  ³  ^ÍÍÍÍÍÍÍloop
  835    º  ³  º  ³  º  ÀÄendif
  836    º  ³  º  ³  º    mcon=concepto&lw
  837    º  ³  º  ³  º    mmon=monto&lw
  838    º  ³  º  ³  º    select 12
  839    º  ³  º  ³  º  ÚÄif  .not.  ;
  840    º  ³  º  ³  º  ³        seek(mcon)
  841    º  ³  º  ³  º  ³    mds =  ;
  842    º  ³  º  ³  º  ³        'SIN DESCRIPCION'
  843    º  ³  º  ³  º  ÃÄelse
  844    º  ³  º  ³  º  ³    mds =  ;
  845    º  ³  º  ³  º  ³        alltrim(descripcio)
  846    º  ³  º  ³  º  ÀÄendif
  847    º  ³  º  ³  º  ÚÄif mdec1 >=  ;
  848    º  ³  º  ³  º  ³        1  ;
  849    º  ³  º  ³  º  ³        .and.  ;
  850    º  ³  º  ³  º  ³        lin1 =  ;
  851    º  ³  º  ³  º  ³        0  ;
  852    º  ³  º  ³  º  ³        .and.  ;
  853    º  ³  º  ³  º  ³        ww =  ;
  854    º  ³  º  ³  º  ³        1
  855    º  ³  º  ³  º  ³    @ li,  ;
  856    º  ³  º  ³  º  ³        00  ;
  857    º  ³  º  ³  º  ³        say  ;
  858    º  ³  º  ³  º  ³        'CANCELACION MENSUALIDAD:'
  859    º  ³  º  ³  º  ³    lin1 =  ;
  860    º  ³  º  ³  º  ³        1
  861    º  ³  º  ³  º  ³    li =  ;
  862    º  ³  º  ³  º  ³        li +  ;
  863    º  ³  º  ³  º  ³        1
  864    º  ³  º  ³  º  ÀÄendif
  865    º  ³  º  ³  º  ÚÄif mdec1 >=  ;
  866    º  ³  º  ³  º  ³        1  ;
  867    º  ³  º  ³  º  ³        .and.  ;
  868    º  ³  º  ³  º  ³        mdec2 >=  ;
  869    º  ³  º  ³  º  ³        1  ;
  870    º  ³  º  ³  º  ³        .and.  ;
  871    º  ³  º  ³  º  ³        lin2 =  ;
  872    º  ³  º  ³  º  ³        1  ;
  873    º  ³  º  ³  º  ³        .and.  ;
  874    º  ³  º  ³  º  ³        ww =  ;
  875    º  ³  º  ³  º  ³        1
  876    º  ³  º  ³  º  ³    @ li,  ;
  877    º  ³  º  ³  º  ³        00  ;
  878    º  ³  º  ³  º  ³        say  ;
  879    º  ³  º  ³  º  ³        'ABONO MENSUALIDAD:'
  880    º  ³  º  ³  º  ³    lin2 =  ;
  881    º  ³  º  ³  º  ³        0
  882    º  ³  º  ³  º  ³    li =  ;
  883    º  ³  º  ³  º  ³        li +  ;
  884    º  ³  º  ³  º  ³        1
  885    º  ³  º  ³  º  ÀÄendif
  886    º  ³  º  ³  º  ÚÄif mdec1 =  ;
  887    º  ³  º  ³  º  ³        0  ;
  888    º  ³  º  ³  º  ³        .and.  ;
  889    º  ³  º  ³  º  ³        mdec2 >=  ;
  890    º  ³  º  ³  º  ³        1  ;
  891    º  ³  º  ³  º  ³        .and.  ;
  892    º  ³  º  ³  º  ³        lin3 =  ;
  893    º  ³  º  ³  º  ³        0  ;
  894    º  ³  º  ³  º  ³        .and.  ;
  895    º  ³  º  ³  º  ³        ww =  ;
  896    º  ³  º  ³  º  ³        1
  897    º  ³  º  ³  º  ³    @ li,  ;
  898    º  ³  º  ³  º  ³        00  ;
  899    º  ³  º  ³  º  ³        say  ;
  900    º  ³  º  ³  º  ³        'ABONO MENSUALIDAD:'
  901    º  ³  º  ³  º  ³    li =  ;
  902    º  ³  º  ³  º  ³        li +  ;
  903    º  ³  º  ³  º  ³        1
  904    º  ³  º  ³  º  ³    lin3 =  ;
  905    º  ³  º  ³  º  ³        1
  906    º  ³  º  ³  º  ÀÄendif
  907    º  ³  º  ³  º  ÚÄif ww =  ;
  908    º  ³  º  ³  º  ³        1
  909    º  ³  º  ³  º  ³    @ li,  ;
  910    º  ³  º  ³  º  ³        02  ;
  911    º  ³  º  ³  º  ³        say  ;
  912    º  ³  º  ³  º  ³        mds  ;
  913    º  ³  º  ³  º  ³        picture  ;
  914    º  ³  º  ³  º  ³        '@!S32'
  915    º  ³  º  ³  º  ³    tu =  ;
  916    º  ³  º  ³  º  ³        tu +  ;
  917    º  ³  º  ³  º  ³        1
  918    º  ³  º  ³  º  ÃÄelse
  919    º  ³  º  ³  º  ³    @ li,  ;
  920    º  ³  º  ³  º  ³        05  ;
  921    º  ³  º  ³  º  ³        say  ;
  922    º  ³  º  ³  º  ³        mds  ;
  923    º  ³  º  ³  º  ³        picture  ;
  924    º  ³  º  ³  º  ³        '@!S29'
  925    º  ³  º  ³  º  ÀÄendif
  926    º  ³  º  ³  º  ÚÄif mpsaldo&lk;
  927    º  ³  º  ³  º  ³        > 0 and ww=1
  928    º  ³  º  ³  º  ³    @ li,  ;
  929    º  ³  º  ³  º  ³        36  ;
  930    º  ³  º  ³  º  ³        say  ;
  931    º  ³  º  ³  º  ³        '('
  932    º  ³  º  ³  º  ³    @li,38 say;
  933    º  ³  º  ³  º  ³        mpsaldo&lk pict '9,999,999.99'
  934    º  ³  º  ³  º  ³    @ li,  ;
  935    º  ³  º  ³  º  ³        51  ;
  936    º  ³  º  ³  º  ³        say  ;
  937    º  ³  º  ³  º  ³        ')'
  938    º  ³  º  ³  º  ÀÄendif
  939    º  ³  º  ³  º  ÚÄif ww =  ;
  940    º  ³  º  ³  º  ³        1
  941    º  ³  º  ³  º  ³    select  ;
  942    º  ³  º  ³  º  ³        2
  943    º  ³  º  ³  º  ³    @li,58 say;
  944    º  ³  º  ³  º  ³        mpagrec&lk pict '9,999,999.99'
  945    º  ³  º  ³  º  ³    imp&lk=1
  946    º  ³  º  ³  º  ÀÄendif
  947    º  ³  º  ³  º  ÚÄif mdec2 >=  ;
  948    º  ³  º  ³  º  ³        1  ;
  949    º  ³  º  ³  º  ³        .and.  ;
  950    º  ³  º  ³  º  ³        tu =  ;
  951    º  ³  º  ³  º  ³        mdec1  ;
  952    º  ³  º  ³  º  ³        .and.  ;
  953    º  ³  º  ³  º  ³        ww =  ;
  954    º  ³  º  ³  º  ³        1
  955    º  ³  º  ³  º  ³    lin2 =  ;
  956    º  ³  º  ³  º  ³        1
  957    º  ³  º  ³  º  ÀÄendif
  958    º  ³  º  ³  º    li = li +  ;
  959    º  ³  º  ³  º        1
  960    º  ³  º  ³  º  ÚÄif li >  ;
  961    º  ³  º  ³  º  ³        20
  962    º  ³  º  ³  º  ³    @ 22,  ;
  963    º  ³  º  ³  º  ³        00  ;
  964    º  ³  º  ³  º  ³        say  ;
  965    º  ³  º  ³  º  ³        'ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»'
  966    º  ³  º  ³  º  ³    @ 23,  ;
  967    º  ³  º  ³  º  ³        00  ;
  968    º  ³  º  ³  º  ³        say  ;
  969    º  ³  º  ³  º  ³        'º            N O T A            º  EFECTIVO   [ ]   CHEQ/DEPOST [ ]           º'
  970    º  ³  º  ³  º  ³  ÚÄif mtipop <>  ;
  971    º  ³  º  ³  º  ³  ³        'Efectivo'
  972    º  ³  º  ³  º  ³  ³    @ 23, 65 say 'X'
  973    º  ³  º  ³  º  ³  ÃÄelse
  974    º  ³  º  ³  º  ³  ³    @ 23, 47 say 'X'
  975    º  ³  º  ³  º  ³  ÀÄendif
  976    º  ³  º  ³  º  ³    @ 24,  ;
  977    º  ³  º  ³  º  ³        00  ;
  978    º  ³  º  ³  º  ³        say  ;
  979    º  ³  º  ³  º  ³        'ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶  NRO. :                                     º'
  980    º  ³  º  ³  º  ³    @ 24,  ;
  981    º  ³  º  ³  º  ³        41  ;
  982    º  ³  º  ³  º  ³        say  ;
  983    º  ³  º  ³  º  ³        mnrode  ;
  984    º  ³  º  ³  º  ³        picture  ;
  985    º  ³  º  ³  º  ³        '@!'
  986    º  ³  º  ³  º  ³    @ 25,  ;
  987    º  ³  º  ³  º  ³        00  ;
  988    º  ³  º  ³  º  ³        say  ;
  989    º  ³  º  ³  º  ³        'º                               º  BANCO:                                     º'
  990    º  ³  º  ³  º  ³    @ 25,  ;
  991    º  ³  º  ³  º  ³        41  ;
  992    º  ³  º  ³  º  ³        say  ;
  993    º  ³  º  ³  º  ³        mbandes
  994    º  ³  º  ³  º  ³    @ 26,  ;
  995    º  ³  º  ³  º  ³        00  ;
  996    º  ³  º  ³  º  ³        say  ;
  997    º  ³  º  ³  º  ³        'º                               º                                             º'
  998    º  ³  º  ³  º  ³    @ 26,  ;
  999    º  ³  º  ³  º  ³        05  ;
 1000    º  ³  º  ³  º  ³        say  ;
 1001    º  ³  º  ³  º  ³        'CONTINUA ....'
 1002    º  ³  º  ³  º  ³    @ 27,  ;
 1003    º  ³  º  ³  º  ³        00  ;
 1004    º  ³  º  ³  º  ³        say  ;
 1005    º  ³  º  ³  º  ³        'º                               º                        ___________________  º'
 1006    º  ³  º  ³  º  ³    @ 28,  ;
 1007    º  ³  º  ³  º  ³        00  ;
 1008    º  ³  º  ³  º  ³        say  ;
 1009    º  ³  º  ³  º  ³        'º                               º                           RECIBIDO POR:     º'
 1010    º  ³  º  ³  º  ³    @ 29,  ;
 1011    º  ³  º  ³  º  ³        00  ;
 1012    º  ³  º  ³  º  ³        say  ;
 1013    º  ³  º  ³  º  ³        'ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼'
 1014    º  ³  º  ³  º  ³    @ 30,  ;
 1015    º  ³  º  ³  º  ³        00  ;
 1016    º  ³  º  ³  º  ³        say  ;
 1017    º  ³  º  ³  º  ³        ' NOTA: Los Pagos Realizados no estan sujetos a devoluciones'
 1018    º  ³  º  ³  º  ³    select  ;
 1019    º  ³  º  ³  º  ³        9
 1020    º  ³  º  ³  º  ³    @ 0,  ;
 1021    º  ³  º  ³  º  ³        1  ;
 1022    º  ³  º  ³  º  ³        say  ;
 1023    º  ³  º  ³  º  ³        '  ' +  ;
 1024    º  ³  º  ³  º  ³        chr(27) +  ;
 1025    º  ³  º  ³  º  ³        chr(67) +  ;
 1026    º  ³  º  ³  º  ³        chr(33)
 1027    º  ³  º  ³  º  ³    @ 00,  ;
 1028    º  ³  º  ³  º  ³        00  ;
 1029    º  ³  º  ³  º  ³        say  ;
 1030    º  ³  º  ³  º  ³        chr(18) +  ;
 1031    º  ³  º  ³  º  ³        chr(20)
 1032    º  ³  º  ³  º  ³    @ 00,  ;
 1033    º  ³  º  ³  º  ³        00  ;
 1034    º  ³  º  ³  º  ³        say  ;
 1035    º  ³  º  ³  º  ³        chr(14) +  ;
 1036    º  ³  º  ³  º  ³        chr(15) +  ;
 1037    º  ³  º  ³  º  ³        titulo +  ;
 1038    º  ³  º  ³  º  ³        chr(18) +  ;
 1039    º  ³  º  ³  º  ³        chr(20) +  ;
 1040    º  ³  º  ³  º  ³        ' '
 1041    º  ³  º  ³  º  ³    @ 01,  ;
 1042    º  ³  º  ³  º  ³        00  ;
 1043    º  ³  º  ³  º  ³        say  ;
 1044    º  ³  º  ³  º  ³        'RIF .                                                   RECIBO Nro.:          '
 1045    º  ³  º  ³  º  ³    @ 01,  ;
 1046    º  ³  º  ³  º  ³        04  ;
 1047    º  ³  º  ³  º  ³        say  ;
 1048    º  ³  º  ³  º  ³        l_rif
 1049    º  ³  º  ³  º  ³    @ 01,  ;
 1050    º  ³  º  ³  º  ³        68  ;
 1051    º  ³  º  ³  º  ³        say  ;
 1052    º  ³  º  ³  º  ³        chr(14) +  ;
 1053    º  ³  º  ³  º  ³        ng +  ;
 1054    º  ³  º  ³  º  ³        ltrim(str(mrecibo)) +  ;
 1055    º  ³  º  ³  º  ³        ngn
 1056    º  ³  º  ³  º  ³    @ 02,  ;
 1057    º  ³  º  ³  º  ³        00  ;
 1058    º  ³  º  ³  º  ³        say  ;
 1059    º  ³  º  ³  º  ³        chr(15) +  ;
 1060    º  ³  º  ³  º  ³        ' '
 1061    º  ³  º  ³  º  ³    @ 02,  ;
 1062    º  ³  º  ³  º  ³        00  ;
 1063    º  ³  º  ³  º  ³        say  ;
 1064    º  ³  º  ³  º  ³        l_direccio
 1065    º  ³  º  ³  º  ³    @ 02,  ;
 1066    º  ³  º  ³  º  ³        pcol()  ;
 1067    º  ³  º  ³  º  ³        say  ;
 1068    º  ³  º  ³  º  ³        chr(18) +  ;
 1069    º  ³  º  ³  º  ³        chr(20) +  ;
 1070    º  ³  º  ³  º  ³        ' '
 1071    º  ³  º  ³  º  ³    @ 02,  ;
 1072    º  ³  º  ³  º  ³        00  ;
 1073    º  ³  º  ³  º  ³        say  ;
 1074    º  ³  º  ³  º  ³        '                                                        FECHA PAGO:          '
 1075    º  ³  º  ³  º  ³    @ 02,  ;
 1076    º  ³  º  ³  º  ³        68  ;
 1077    º  ³  º  ³  º  ³        say  ;
 1078    º  ³  º  ³  º  ³        mfechap  ;
 1079    º  ³  º  ³  º  ³        picture  ;
 1080    º  ³  º  ³  º  ³        '@E'
 1081    º  ³  º  ³  º  ³    @ 03,  ;
 1082    º  ³  º  ³  º  ³        00  ;
 1083    º  ³  º  ³  º  ³        say  ;
 1084    º  ³  º  ³  º  ³        '                                                      '
 1085    º  ³  º  ³  º  ³    @ 03,  ;
 1086    º  ³  º  ³  º  ³        28  ;
 1087    º  ³  º  ³  º  ³        say  ;
 1088    º  ³  º  ³  º  ³        chr(14) +  ;
 1089    º  ³  º  ³  º  ³        chr(15) +  ;
 1090    º  ³  º  ³  º  ³        'RECIBO DE PAGO' +  ;
 1091    º  ³  º  ³  º  ³        chr(18) +  ;
 1092    º  ³  º  ³  º  ³        chr(20) +  ;
 1093    º  ³  º  ³  º  ³        ' '
 1094    º  ³  º  ³  º  ³    @ 04,  ;
 1095    º  ³  º  ³  º  ³        00  ;
 1096    º  ³  º  ³  º  ³        say  ;
 1097    º  ³  º  ³  º  ³        '                                                      ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ» '
 1098    º  ³  º  ³  º  ³    @ 05,  ;
 1099    º  ³  º  ³  º  ³        00  ;
 1100    º  ³  º  ³  º  ³        say  ;
 1101    º  ³  º  ³  º  ³        'C.I.:                                                 º Bs.                º '
 1102    º  ³  º  ³  º  ³    @ 05,  ;
 1103    º  ³  º  ³  º  ³        61  ;
 1104    º  ³  º  ³  º  ³        say  ;
 1105    º  ³  º  ³  º  ³        mmontop  ;
 1106    º  ³  º  ³  º  ³        picture  ;
 1107    º  ³  º  ³  º  ³        '9,999,999.99'
 1108    º  ³  º  ³  º  ³    @ 05,  ;
 1109    º  ³  º  ³  º  ³        06  ;
 1110    º  ³  º  ³  º  ³        say  ;
 1111    º  ³  º  ³  º  ³        m.cedula  ;
 1112    º  ³  º  ³  º  ³        picture  ;
 1113    º  ³  º  ³  º  ³        '!-99999999'
 1114    º  ³  º  ³  º  ³    @ 06,  ;
 1115    º  ³  º  ³  º  ³        00  ;
 1116    º  ³  º  ³  º  ³        say  ;
 1117    º  ³  º  ³  º  ³        'ALUMNO:                                               ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼ '
 1118    º  ³  º  ³  º  ³    @ 06,  ;
 1119    º  ³  º  ³  º  ³        08  ;
 1120    º  ³  º  ³  º  ³        say  ;
 1121    º  ³  º  ³  º  ³        m.nombres  ;
 1122    º  ³  º  ³  º  ³        picture  ;
 1123    º  ³  º  ³  º  ³        '@!s45'
 1124    º  ³  º  ³  º  ³    @ 07,  ;
 1125    º  ³  º  ³  º  ³        00  ;
 1126    º  ³  º  ³  º  ³        say  ;
 1127    º  ³  º  ³  º  ³        'SEMESTRE: ' +  ;
 1128    º  ³  º  ³  º  ³        m.semestre
 1129    º  ³  º  ³  º  ³    @ 08,  ;
 1130    º  ³  º  ³  º  ³        00  ;
 1131    º  ³  º  ³  º  ³        say  ;
 1132    º  ³  º  ³  º  ³        'TURNO   : ' +  ;
 1133    º  ³  º  ³  º  ³        m.turno
 1134    º  ³  º  ³  º  ³    xcantidad =  ;
 1135    º  ³  º  ³  º  ³        letras(mmontop)
 1136    º  ³  º  ³  º  ³    xcantidad =  ;
 1137    º  ³  º  ³  º  ³        alltrim(xcantidad)
 1138    º  ³  º  ³  º  ³    @ 09,  ;
 1139    º  ³  º  ³  º  ³        00  ;
 1140    º  ³  º  ³  º  ³        say  ;
 1141    º  ³  º  ³  º  ³        'Hemos recibido la cantidad de:'
 1142    º  ³  º  ³  º  ³    @ 10,  ;
 1143    º  ³  º  ³  º  ³        00  ;
 1144    º  ³  º  ³  º  ³        say  ;
 1145    º  ³  º  ³  º  ³        xcantidad  ;
 1146    º  ³  º  ³  º  ³        picture  ;
 1147    º  ³  º  ³  º  ³        '@!'
 1148    º  ³  º  ³  º  ³    li =  ;
 1149    º  ³  º  ³  º  ³        11
 1150    º  ³  º  ³  º  ³    @ li,  ;
 1151    º  ³  º  ³  º  ³        00  ;
 1152    º  ³  º  ³  º  ³        say  ;
 1153    º  ³  º  ³  º  ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ' +  ;
 1154    º  ³  º  ³  º  ³        ng
 1155    º  ³  º  ³  º  ³    li =  ;
 1156    º  ³  º  ³  º  ³        li +  ;
 1157    º  ³  º  ³  º  ³        1
 1158    º  ³  º  ³  º  ³    @ li,  ;
 1159    º  ³  º  ³  º  ³        00  ;
 1160    º  ³  º  ³  º  ³        say  ;
 1161    º  ³  º  ³  º  ³        '  C O N C E P T O S                   S A L D O              M O N T O       ' +  ;
 1162    º  ³  º  ³  º  ³        ngn
 1163    º  ³  º  ³  º  ³    li =  ;
 1164    º  ³  º  ³  º  ³        li +  ;
 1165    º  ³  º  ³  º  ³        1
 1166    º  ³  º  ³  º  ³    @ li,  ;
 1167    º  ³  º  ³  º  ³        00  ;
 1168    º  ³  º  ³  º  ³        say  ;
 1169    º  ³  º  ³  º  ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ'
 1170    º  ³  º  ³  º  ³    li =  ;
 1171    º  ³  º  ³  º  ³        li +  ;
 1172    º  ³  º  ³  º  ³        1
 1173    º  ³  º  ³  º  ÀÄendif
 1174    º  ³  º  ³  ÓÄendfor
 1175    º  ³  º  ÃÄelse
 1176    º  ³  º  ³  ÚÄif mpagado >  ;
 1177    º  ³  º  ³  ³        0
 1178    º  ³  º  ³  ³    select 11
 1179    º  ³  º  ³  ³    set order to;
 1180    º  ³  º  ³  ³        codcuota
 1181    º  ³  º  ³  ³    locate for  ;
 1182    º  ³  º  ³  ³        lapso =  ;
 1183    º  ³  º  ³  ³        lapmat  ;
 1184    º  ³  º  ³  ³        .and.  ;
 1185    º  ³  º  ³  ³        codigo =  ;
 1186    º  ³  º  ³  ³        m.plancobro  ;
 1187    º  ³  º  ³  ³        .and.  ;
 1188    º  ³  º  ³  ³        cuota =  ;
 1189    º  ³  º  ³  ³        ii
 1190    º  ³  º  ³  ³    xpagado=pagado&lk+mpagado
 1191    º  ³  º  ³  ³  ÖÄfor ww =  ;
 1192    º  ³  º  ³  ³  º        1 to  ;
 1193    º  ³  º  ³  ³  º        10
 1194    º  ³  º  ³  ³  º    lw =  ;
 1195    º  ³  º  ³  ³  º        ltrim(str(ww))
 1196    º  ³  º  ³  ³  º    select  ;
 1197    º  ³  º  ³  ³  º        11
 1198    º  ³  º  ³  ³  º  ÚÄif concepto&lw=space(2)
 1199    º  ³  º  ³  ³  ^ÍÍÍÍÍÍÍloop
 1200    º  ³  º  ³  ³  º  ÀÄendif
 1201    º  ³  º  ³  ³  º    mcon=concepto&lw
 1202    º  ³  º  ³  ³  º    mmon=monto&lw
 1203    º  ³  º  ³  ³  º    select  ;
 1204    º  ³  º  ³  ³  º        12
 1205    º  ³  º  ³  ³  º  ÚÄif   ;
 1206    º  ³  º  ³  ³  º  ³        .not.  ;
 1207    º  ³  º  ³  ³  º  ³        seek(mcon)
 1208    º  ³  º  ³  ³  º  ³    mds = 'SIN DESCRIPCION'
 1209    º  ³  º  ³  ³  º  ÃÄelse
 1210    º  ³  º  ³  ³  º  ³    mds = alltrim(descripcio)
 1211    º  ³  º  ³  ³  º  ÀÄendif
 1212    º  ³  º  ³  ³  º  ÚÄif mdec1 >=  ;
 1213    º  ³  º  ³  ³  º  ³        1  ;
 1214    º  ³  º  ³  ³  º  ³        .and.  ;
 1215    º  ³  º  ³  ³  º  ³        lin1 =  ;
 1216    º  ³  º  ³  ³  º  ³        0  ;
 1217    º  ³  º  ³  ³  º  ³        .and.  ;
 1218    º  ³  º  ³  ³  º  ³        ww =  ;
 1219    º  ³  º  ³  ³  º  ³        1
 1220    º  ³  º  ³  ³  º  ³    @ li, 00 say 'CANCELACION MENSUALIDAD:'
 1221    º  ³  º  ³  ³  º  ³    lin1 = 1
 1222    º  ³  º  ³  ³  º  ³    li = li + 1
 1223    º  ³  º  ³  ³  º  ÀÄendif
 1224    º  ³  º  ³  ³  º  ÚÄif mdec1 >=  ;
 1225    º  ³  º  ³  ³  º  ³        1  ;
 1226    º  ³  º  ³  ³  º  ³        .and.  ;
 1227    º  ³  º  ³  ³  º  ³        mdec2 >=  ;
 1228    º  ³  º  ³  ³  º  ³        1  ;
 1229    º  ³  º  ³  ³  º  ³        .and.  ;
 1230    º  ³  º  ³  ³  º  ³        lin2 =  ;
 1231    º  ³  º  ³  ³  º  ³        1  ;
 1232    º  ³  º  ³  ³  º  ³        .and.  ;
 1233    º  ³  º  ³  ³  º  ³        ww =  ;
 1234    º  ³  º  ³  ³  º  ³        1
 1235    º  ³  º  ³  ³  º  ³    @ li, 00 say 'ABONO MENSUALIDAD:'
 1236    º  ³  º  ³  ³  º  ³    li = li + 1
 1237    º  ³  º  ³  ³  º  ³    lin2 = 0
 1238    º  ³  º  ³  ³  º  ÀÄendif
 1239    º  ³  º  ³  ³  º  ÚÄif mdec1 =  ;
 1240    º  ³  º  ³  ³  º  ³        0  ;
 1241    º  ³  º  ³  ³  º  ³        .and.  ;
 1242    º  ³  º  ³  ³  º  ³        mdec2 >=  ;
 1243    º  ³  º  ³  ³  º  ³        1  ;
 1244    º  ³  º  ³  ³  º  ³        .and.  ;
 1245    º  ³  º  ³  ³  º  ³        lin3 =  ;
 1246    º  ³  º  ³  ³  º  ³        0  ;
 1247    º  ³  º  ³  ³  º  ³        .and.  ;
 1248    º  ³  º  ³  ³  º  ³        ww =  ;
 1249    º  ³  º  ³  ³  º  ³        1
 1250    º  ³  º  ³  ³  º  ³    @ li, 00 say 'ABONO MENSUALIDAD:'
 1251    º  ³  º  ³  ³  º  ³    li = li + 1
 1252    º  ³  º  ³  ³  º  ³    lin3 = 1
 1253    º  ³  º  ³  ³  º  ÀÄendif
 1254    º  ³  º  ³  ³  º  ÚÄif ww =  ;
 1255    º  ³  º  ³  ³  º  ³        1
 1256    º  ³  º  ³  ³  º  ³    @ li, 02 say mds picture '@!S32'
 1257    º  ³  º  ³  ³  º  ³    tu = tu + 1
 1258    º  ³  º  ³  ³  º  ÃÄelse
 1259    º  ³  º  ³  ³  º  ³    @ li, 05 say mds picture '@!S29'
 1260    º  ³  º  ³  ³  º  ÀÄendif
 1261    º  ³  º  ³  ³  º    select  ;
 1262    º  ³  º  ³  ³  º        2
 1263    º  ³  º  ³  ³  º  ÚÄif mpsaldo&lk;
 1264    º  ³  º  ³  ³  º  ³        > 0 and ww=1
 1265    º  ³  º  ³  ³  º  ³    @ li, 36 say '('
 1266    º  ³  º  ³  ³  º  ³    @li,38 say mpsaldo&lk pict '9,999,999.99'
 1267    º  ³  º  ³  ³  º  ³    @ li, 51 say ')'
 1268    º  ³  º  ³  ³  º  ÀÄendif
 1269    º  ³  º  ³  ³  º  ÚÄif ww =  ;
 1270    º  ³  º  ³  ³  º  ³        1
 1271    º  ³  º  ³  ³  º  ³    @li,58 say mpagrec&lk pict '9,999,999.99'
 1272    º  ³  º  ³  ³  º  ÀÄendif
 1273    º  ³  º  ³  ³  º  ÚÄif mdec2 >=  ;
 1274    º  ³  º  ³  ³  º  ³        1  ;
 1275    º  ³  º  ³  ³  º  ³        .and.  ;
 1276    º  ³  º  ³  ³  º  ³        tu =  ;
 1277    º  ³  º  ³  ³  º  ³        mdec1  ;
 1278    º  ³  º  ³  ³  º  ³        .and.  ;
 1279    º  ³  º  ³  ³  º  ³        ww =  ;
 1280    º  ³  º  ³  ³  º  ³        1
 1281    º  ³  º  ³  ³  º  ³    lin2 = 1
 1282    º  ³  º  ³  ³  º  ÀÄendif
 1283    º  ³  º  ³  ³  º    li =  ;
 1284    º  ³  º  ³  ³  º        li +  ;
 1285    º  ³  º  ³  ³  º        1
 1286    º  ³  º  ³  ³  º  ÚÄif li >  ;
 1287    º  ³  º  ³  ³  º  ³        20
 1288    º  ³  º  ³  ³  º  ³    @ 22, 00 say 'ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»'
 1289    º  ³  º  ³  ³  º  ³    @ 23, 00 say 'º            N O T A            º  EFECTIVO   [ ]   CHEQ/DEPOST [ ]           º'
 1290    º  ³  º  ³  ³  º  ³  ÚÄif mtipop <> 'Efectivo'
 1291    º  ³  º  ³  ³  º  ³  ³    @ 23, 65 say 'X'
 1292    º  ³  º  ³  ³  º  ³  ÃÄelse
 1293    º  ³  º  ³  ³  º  ³  ³    @ 23, 47 say 'X'
 1294    º  ³  º  ³  ³  º  ³  ÀÄendif
 1295    º  ³  º  ³  ³  º  ³    @ 24, 00 say 'ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶  NRO. :                                     º'
 1296    º  ³  º  ³  ³  º  ³    @ 24, 41 say mnrode picture '@!'
 1297    º  ³  º  ³  ³  º  ³    @ 25, 00 say 'º                               º  BANCO:                                     º'
 1298    º  ³  º  ³  ³  º  ³    @ 25, 41 say mbandes
 1299    º  ³  º  ³  ³  º  ³    @ 26, 00 say 'º                               º                                             º'
 1300    º  ³  º  ³  ³  º  ³    @ 26, 05 say 'CONTINUA ....'
 1301    º  ³  º  ³  ³  º  ³    @ 27, 00 say 'º                               º                        ___________________  º'
 1302    º  ³  º  ³  ³  º  ³    @ 28, 00 say 'º                               º                           RECIBIDO POR:     º'
 1303    º  ³  º  ³  ³  º  ³    @ 29, 00 say 'ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼'
 1304    º  ³  º  ³  ³  º  ³    @ 30, 00 say ' NOTA: Los Pagos Realizados no estan sujetos a devoluciones'
 1305    º  ³  º  ³  ³  º  ³    select 9
 1306    º  ³  º  ³  ³  º  ³    @ 0, 1 say '  ' + chr(27) + chr(67) + chr(33)
 1307    º  ³  º  ³  ³  º  ³    @ 00, 00 say chr(18) + chr(20)
 1308    º  ³  º  ³  ³  º  ³    @ 00, 00 say chr(14) + chr(15) + titulo + chr(18) + chr(20) + ' '
 1309    º  ³  º  ³  ³  º  ³    @ 01, 00 say 'RIF .                                                   RECIBO Nro.:          '
 1310    º  ³  º  ³  ³  º  ³    @ 01, 04 say l_rif
 1311    º  ³  º  ³  ³  º  ³    @ 01, 68 say chr(14) + ng + ltrim(str(mrecibo)) + ngn
 1312    º  ³  º  ³  ³  º  ³    @ 02, 00 say chr(15) + ' '
 1313    º  ³  º  ³  ³  º  ³    @ 02, 00 say l_direccio
 1314    º  ³  º  ³  ³  º  ³    @ 02, pcol() say chr(18) + chr(20) + ' '
 1315    º  ³  º  ³  ³  º  ³    @ 02, 00 say '                                                        FECHA PAGO:          '
 1316    º  ³  º  ³  ³  º  ³    @ 02, 68 say mfechap picture '@E'
 1317    º  ³  º  ³  ³  º  ³    @ 03, 00 say '                                                      '
 1318    º  ³  º  ³  ³  º  ³    @ 03, 28 say chr(14) + chr(15) + 'RECIBO DE PAGO' + chr(18) + chr(20) + ' '
 1319    º  ³  º  ³  ³  º  ³    @ 04, 00 say '                                                      ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ» '
 1320    º  ³  º  ³  ³  º  ³    @ 05, 00 say 'C.I.:                                                 º Bs.                º '
 1321    º  ³  º  ³  ³  º  ³    @ 05, 61 say mmontop picture '9,999,999.99'
 1322    º  ³  º  ³  ³  º  ³    @ 05, 06 say m.cedula picture '!-99999999'
 1323    º  ³  º  ³  ³  º  ³    @ 06, 00 say 'ALUMNO:                                               ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼ '
 1324    º  ³  º  ³  ³  º  ³    @ 06, 08 say m.nombres picture '@!s45'
 1325    º  ³  º  ³  ³  º  ³    @ 07, 00 say 'SEMESTRE: ' + m.semestre
 1326    º  ³  º  ³  ³  º  ³    @ 08, 00 say 'TURNO   : ' + m.turno
 1327    º  ³  º  ³  ³  º  ³    @ 08, pcol() + 2 say m.representa picture '@!'
 1328    º  ³  º  ³  ³  º  ³    xcantidad = letras(mmontop)
 1329    º  ³  º  ³  ³  º  ³    xcantidad = alltrim(xcantidad)
 1330    º  ³  º  ³  ³  º  ³    @ 09, 00 say 'Hemos recibido la cantidad de:'
 1331    º  ³  º  ³  ³  º  ³    @ 10, 00 say xcantidad picture '@!'
 1332    º  ³  º  ³  ³  º  ³    li = 11
 1333    º  ³  º  ³  ³  º  ³    @ li, 00 say 'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ' + ng
 1334    º  ³  º  ³  ³  º  ³    li = li + 1
 1335    º  ³  º  ³  ³  º  ³    @ li, 00 say '  C O N C E P T O S                                          M O N T O       ' + ngn
 1336    º  ³  º  ³  ³  º  ³    li = li + 1
 1337    º  ³  º  ³  ³  º  ³    @ li, 00 say 'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ'
 1338    º  ³  º  ³  ³  º  ³    li = li + 1
 1339    º  ³  º  ³  ³  º  ÀÄendif
 1340    º  ³  º  ³  ³  ÓÄendfor
 1341    º  ³  º  ³  ÀÄendif
 1342    º  ³  vÍÍÍÍÍÍÍexit
 1343    º  ³  º  ÀÄendif
 1344    º  ³  ÓÄendfor
 1345    º  ³    @ 22, 00 say  ;
 1346    º  ³        'ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»'
 1347    º  ³    @ 23, 00 say  ;
 1348    º  ³        'º            N O T A            º  EFECTIVO   [ ]   CHEQ/DEPOST [ ]           º'
 1349    º  ³  ÚÄif mtipop <> 'Efectivo'
 1350    º  ³  ³    @ 23, 65 say 'X'
 1351    º  ³  ÃÄelse
 1352    º  ³  ³    @ 23, 47 say 'X'
 1353    º  ³  ÀÄendif
 1354    º  ³    @ 24, 00 say  ;
 1355    º  ³        'ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶  NRO. :                                     º'
 1356    º  ³    @ 24, 41 say mnrode  ;
 1357    º  ³        picture '@!'
 1358    º  ³    @ 25, 00 say  ;
 1359    º  ³        'º                               º  BANCO:                                     º'
 1360    º  ³    @ 25, 41 say mbandes
 1361    º  ³    @ 26, 00 say  ;
 1362    º  ³        'º                               º                                             º'
 1363    º  ³    @ 27, 00 say  ;
 1364    º  ³        'º                               º                        ___________________  º'
 1365    º  ³    @ 28, 00 say  ;
 1366    º  ³        'º                               º                           RECIBIDO POR:     º'
 1367    º  ³    @ 29, 00 say  ;
 1368    º  ³        'ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼'
 1369    º  ³    @ 30, 00 say  ;
 1370    º  ³        ' NOTA: Los Pagos Realizados no estan sujetos a devoluciones'
 1371    º  ³    eject
 1372    º  ³    set device to screen
 1373    º  ÀÄendif
 1374    º    select 2
 1375    º    mpagado = mmontop
 1376    º    ii = 1
 1377    º  ÖÄfor ii = 1 to xnro
 1378    º  º    lk = ltrim(str(ii))
 1379    º  º  ÚÄif pagado&lk=cuota&lk
 1380    º  ^ÍÍÍÍÍÍÍloop
 1381    º  º  ÀÄendif
 1382    º  º  ÚÄif (mpagado+pagado&lk) >= m.cuota&lk
 1383    º  º  ³    xpagado=(m.cuota&lk-pagado&lk)
 1384    º  º  ³    select 9
 1385    º  º  ³  ÉÍdo while .t.
 1386    º  º  ³  º  ÚÄif flock()
 1387    º  º  ³  º  ³    append blank
 1388    º  º  ³  º  ³    replace recibo  ;
 1389    º  º  ³  º  ³        with  ;
 1390    º  º  ³  º  ³        mrecibo,  ;
 1391    º  º  ³  º  ³        cedula  ;
 1392    º  º  ³  º  ³        with  ;
 1393    º  º  ³  º  ³        m.cedula
 1394    º  º  ³  º  ³    replace curso  ;
 1395    º  º  ³  º  ³        with  ;
 1396    º  º  ³  º  ³        m.cur,  ;
 1397    º  º  ³  º  ³        plancobro  ;
 1398    º  º  ³  º  ³        with  ;
 1399    º  º  ³  º  ³        m.plancobro
 1400    º  º  ³  º  ³    replace seccion  ;
 1401    º  º  ³  º  ³        with  ;
 1402    º  º  ³  º  ³        m.semestre,  ;
 1403    º  º  ³  º  ³        fecha_pago  ;
 1404    º  º  ³  º  ³        with  ;
 1405    º  º  ³  º  ³        mfechap
 1406    º  º  ³  º  ³    replace nrocuota  ;
 1407    º  º  ³  º  ³        with  ;
 1408    º  º  ³  º  ³        ii,  ;
 1409    º  º  ³  º  ³        tipo_pago  ;
 1410    º  º  ³  º  ³        with  ;
 1411    º  º  ³  º  ³        mtipop,  ;
 1412    º  º  ³  º  ³        nro_depo  ;
 1413    º  º  ³  º  ³        with  ;
 1414    º  º  ³  º  ³        mnrode
 1415    º  º  ³  º  ³    replace cod_banco  ;
 1416    º  º  ³  º  ³        with  ;
 1417    º  º  ³  º  ³        mbanco,  ;
 1418    º  º  ³  º  ³        monto  ;
 1419    º  º  ³  º  ³        with  ;
 1420    º  º  ³  º  ³        xpagado,  ;
 1421    º  º  ³  º  ³        transa  ;
 1422    º  º  ³  º  ³        with  ;
 1423    º  º  ³  º  ³        'CO'
 1424    º  º  ³  º  ³    replace cobrador  ;
 1425    º  º  ³  º  ³        with  ;
 1426    º  º  ³  º  ³        mcobrador
 1427    º  º  ³  º  ³    replace lapso  ;
 1428    º  º  ³  º  ³        with  ;
 1429    º  º  ³  º  ³        lapmat
 1430    º  º  ³  º  ³    unlock
 1431    º  º  ³  vÍÍÍÍÍÍÍexit
 1432    º  º  ³  º  ÀÄendif
 1433    º  º  ³  ÈÍenddo
 1434    º  º  ³    select 2
 1435    º  º  ³    mpagado=mpagado-(m.cuota&lk-pagado&lk)
 1436    º  º  ÃÄelse
 1437    º  º  ³  ÚÄif mpagado > 0
 1438    º  º  ³  ³    select 9
 1439    º  º  ³  ³  ÉÍdo while .t.
 1440    º  º  ³  ³  º  ÚÄif flock()
 1441    º  º  ³  ³  º  ³    append  ;
 1442    º  º  ³  ³  º  ³        blank
 1443    º  º  ³  ³  º  ³    replace  ;
 1444    º  º  ³  ³  º  ³        recibo  ;
 1445    º  º  ³  ³  º  ³        with  ;
 1446    º  º  ³  ³  º  ³        mrecibo,  ;
 1447    º  º  ³  ³  º  ³        cedula  ;
 1448    º  º  ³  ³  º  ³        with  ;
 1449    º  º  ³  ³  º  ³        m.cedula
 1450    º  º  ³  ³  º  ³    replace  ;
 1451    º  º  ³  ³  º  ³        curso  ;
 1452    º  º  ³  ³  º  ³        with  ;
 1453    º  º  ³  ³  º  ³        m.cur,  ;
 1454    º  º  ³  ³  º  ³        plancobro  ;
 1455    º  º  ³  ³  º  ³        with  ;
 1456    º  º  ³  ³  º  ³        m.plancobro
 1457    º  º  ³  ³  º  ³    replace  ;
 1458    º  º  ³  ³  º  ³        seccion  ;
 1459    º  º  ³  ³  º  ³        with  ;
 1460    º  º  ³  ³  º  ³        m.semestre,  ;
 1461    º  º  ³  ³  º  ³        fecha_pago  ;
 1462    º  º  ³  ³  º  ³        with  ;
 1463    º  º  ³  ³  º  ³        mfechap
 1464    º  º  ³  ³  º  ³    replace  ;
 1465    º  º  ³  ³  º  ³        tipo_pago  ;
 1466    º  º  ³  ³  º  ³        with  ;
 1467    º  º  ³  ³  º  ³        mtipop,  ;
 1468    º  º  ³  ³  º  ³        nro_depo  ;
 1469    º  º  ³  ³  º  ³        with  ;
 1470    º  º  ³  ³  º  ³        mnrode
 1471    º  º  ³  ³  º  ³    replace  ;
 1472    º  º  ³  ³  º  ³        cod_banco  ;
 1473    º  º  ³  ³  º  ³        with  ;
 1474    º  º  ³  ³  º  ³        mbanco,  ;
 1475    º  º  ³  ³  º  ³        monto  ;
 1476    º  º  ³  ³  º  ³        with  ;
 1477    º  º  ³  ³  º  ³        mpagado
 1478    º  º  ³  ³  º  ³    replace  ;
 1479    º  º  ³  ³  º  ³        nrocuota  ;
 1480    º  º  ³  ³  º  ³        with  ;
 1481    º  º  ³  ³  º  ³        ii,  ;
 1482    º  º  ³  ³  º  ³        transa  ;
 1483    º  º  ³  ³  º  ³        with  ;
 1484    º  º  ³  ³  º  ³        'AB'
 1485    º  º  ³  ³  º  ³    replace  ;
 1486    º  º  ³  ³  º  ³        cobrador  ;
 1487    º  º  ³  ³  º  ³        with  ;
 1488    º  º  ³  ³  º  ³        mcobrador
 1489    º  º  ³  ³  º  ³    replace  ;
 1490    º  º  ³  ³  º  ³        lapso  ;
 1491    º  º  ³  ³  º  ³        with  ;
 1492    º  º  ³  ³  º  ³        lapmat
 1493    º  º  ³  ³  º  ³    unlock
 1494    º  º  ³  ³  vÍÍÍÍÍÍÍexit
 1495    º  º  ³  ³  º  ÀÄendif
 1496    º  º  ³  ³  ÈÍenddo
 1497    º  º  ³  ÀÄendif
 1498    º  º  ³    select 2
 1499    º  vÍÍÍÍÍÍÍexit
 1500    º  º  ÀÄendif
 1501    º  ÓÄendfor
 1502    º    select 2
 1503    º  ÉÍdo while .t.
 1504    º  º  ÚÄif rlock()
 1505    º  º  ³    mpagado = mmontop
 1506    º  º  ³    ii = 1
 1507    º  º  ³  ÖÄfor ii = 1 to xnro
 1508    º  º  ³  º    lk = ltrim(str(ii))
 1509    º  º  ³  º  ÚÄif pagado&lk=cuota&lk
 1510    º  º  ³  º  ³    li = li +  ;
 1511    º  º  ³  º  ³        1
 1512    º  º  ³  ^ÍÍÍÍÍÍÍloop
 1513    º  º  ³  º  ÀÄendif
 1514    º  º  ³  º  ÚÄif (mpagado+pagado&lk);
 1515    º  º  ³  º  ³        >= m.cuota&lk
 1516    º  º  ³  º  ³    mpagado=mpagado-(m.cuota&lk-pagado&lk)
 1517    º  º  ³  º  ³    replace ultimacuot  ;
 1518    º  º  ³  º  ³        with  ;
 1519    º  º  ³  º  ³        ultimacuot +  ;
 1520    º  º  ³  º  ³        1
 1521    º  º  ³  º  ³    x=(m.cuota&lk-pagado&lk)
 1522    º  º  ³  º  ³    replace monto_paga  ;
 1523    º  º  ³  º  ³        with  ;
 1524    º  º  ³  º  ³        monto_paga +  ;
 1525    º  º  ³  º  ³        x
 1526    º  º  ³  º  ³    repla pagado&lk;
 1527    º  º  ³  º  ³        with m.cuota&lk
 1528    º  º  ³  º  ³    replace nrorecibo  ;
 1529    º  º  ³  º  ³        with  ;
 1530    º  º  ³  º  ³        mrecibo
 1531    º  º  ³  º  ³    replace fecha_ultp  ;
 1532    º  º  ³  º  ³        with  ;
 1533    º  º  ³  º  ³        mfechap
 1534    º  º  ³  º  ÃÄelse
 1535    º  º  ³  º  ³    repla pagado&lk;
 1536    º  º  ³  º  ³        with pagado&lk+mpagado
 1537    º  º  ³  º  ³    replace monto_paga  ;
 1538    º  º  ³  º  ³        with  ;
 1539    º  º  ³  º  ³        monto_paga +  ;
 1540    º  º  ³  º  ³        mpagado
 1541    º  º  ³  º  ³    replace nrorecibo  ;
 1542    º  º  ³  º  ³        with  ;
 1543    º  º  ³  º  ³        mrecibo
 1544    º  º  ³  º  ³    replace fecha_ultp  ;
 1545    º  º  ³  º  ³        with  ;
 1546    º  º  ³  º  ³        mfechap
 1547    º  º  ³  vÍÍÍÍÍÍÍexit
 1548    º  º  ³  º  ÀÄendif
 1549    º  º  ³  ÓÄendfor
 1550    º  º  ³    unlock
 1551    º  vÍÍÍÍÍÍÍexit
 1552    º  º  ÀÄendif
 1553    º  º    @ 22, 03 say  ;
 1554    º  º        'F1 = HELP'
 1555    º  º    @ 22, 25 say  ;
 1556    º  º        'F3 = REIMPRIMIR RECIBO'
 1557    º  º    @ 22, 58 say  ;
 1558    º  º        'ENTER = CONTINUAR'
 1559    º  º    on key label f3 do repite_recibo
 1560    º  º    read
 1561    º  ÈÍenddo
 1562    º    xcedula = space(12)
 1563    º    m.swp = 0
 1564    º    @ 06, 00 clear to 19,  ;
 1565    º        wcols()
 1566    º    _curobj = objnum(xcedula)
 1567    º    show gets
 1568    º    m.control = 0
 1569    º    m.nac = 'V'
 1570    º    m.ced = 0
 1571    º    entra = .f.
 1572    ÈÍenddo
 1573      *
 1595  *!*****************************************************************************
 1596  *!
 1597  *!      Procedure: VALIDAR
 1598  *!
 1599  *!      Called by: SCP20033.PRG                      
 1600  *!               : VALIDAR            (procedure in SCP20033.PRG)
 1601  *!               : SCP20333.PRG                      
 1602  *!
 1603  *!          Calls: IIF()              (function  in ?)
 1604  *!               : LEN()              (function  in ?)
 1605  *!               : LTRIM()            (function  in ?)
 1606  *!               : STR()              (function  in ?)
 1607  *!               : SPACE()            (function  in ?)
 1608  *!               : BUSQUEDA()         (function  in ?)
 1609  *!               : SUBSTR()           (function  in ?)
 1610  *!               : VAL()              (function  in ?)
 1611  *!               : BOXFIELD()         (function  in ?)
 1612  *!               : VARREAD()          (function  in ?)
 1613  *!               : VALIDAR            (procedure in SCP20033.PRG)
 1614  *!
 1615  *!*****************************************************************************
 1595      procedure validar
 1596      parameter xvar
 1597    ÕÍdo case
 1598    ÆÍcase xvar = 'NAC' .or. xvar =  ;
 1599    ³        'CED'
 1600    ³    on key label tab
 1601    ³    m.ced = iif(len(ltrim(str(m.ced,  ;
 1602    ³        10))) < 10,  ;
 1603    ³        ltrim(str(m.ced,  ;
 1604    ³        10)) + space(10 -  ;
 1605    ³        len(ltrim(str(m.ced,  ;
 1606    ³        10)))),  ;
 1607    ³        ltrim(str(m.ced,  ;
 1608    ³        10)))
 1609    ³    xcedula = m.nac + '-' +  ;
 1610    ³        m.ced
 1611    ³    select 1
 1612    ³    xcedula = busqueda()
 1613    ³    m.nac = substr(xcedula,  ;
 1614    ³        1, 1)
 1615    ³    m.ced = val(substr(xcedula,  ;
 1616    ³        3, 10))
 1617    ³    show get m.nac
 1618    ³    show get m.ced
 1619    ÆÍcase xvar = 'PLANCOBRO'
 1620    ³    on key label tab
 1621    ³    m.planco = boxfield('PLANCOBR', ;
 1622    ³        'CODIGO')
 1623    ³    show get m.planco
 1624    ÆÍcase xvar = 'MBANCO'
 1625    ³    on key label tab
 1626    ³    mbanco = boxfield('BANCOS', ;
 1627    ³        'CODIGO')
 1628    ³    show get mbanco
 1629    ÆÍcase xvar = 'MCOBRADOR'
 1630    ³    on key label tab
 1631    ³    mcobrador = boxfield('COBRADOR', ;
 1632    ³        'CODIGO')
 1633    ³    show get mcobrador
 1634    ÔÍendcase
 1635      on key label tab do validar with varread()
 1636      return
 1637      *
 1652  *!*****************************************************************************
 1653  *!
 1654  *!       Function: MBANCOS()
 1655  *!
 1656  *!      Called by: SCP20033.PRG                      
 1657  *!               : DEUDA_VEN3()       (function  in SCP20033.PRG)
 1658  *!               : DEUDA_VEN1()       (function  in SCP20033.PRG)
 1659  *!               : DEUDA_VEN2()       (function  in SCP20033.PRG)
 1660  *!               : SCP20333.PRG                      
 1661  *!
 1662  *!          Calls: SEEK()             (function  in ?)
 1663  *!               : BOXFIELD()         (function  in ?)
 1664  *!
 1665  *!*****************************************************************************
 1652      function mbancos
 1653      parameter xban
 1654      select bancos
 1655    ÚÄif  .not. seek(xban)
 1656    ³    mbanco = boxfield('BANCOS', ;
 1657    ³        'CODIGO')
 1658    ÀÄendif
 1659      show get mbanco
 1660      return .t.
 1661      *
 1676  *!*****************************************************************************
 1677  *!
 1678  *!       Function: MCOBRAD()
 1679  *!
 1680  *!      Called by: SCP20033.PRG                      
 1681  *!               : DEUDA_VEN3()       (function  in SCP20033.PRG)
 1682  *!               : DEUDA_VEN1()       (function  in SCP20033.PRG)
 1683  *!               : DEUDA_VEN2()       (function  in SCP20033.PRG)
 1684  *!               : SCP20333.PRG                      
 1685  *!
 1686  *!          Calls: SEEK()             (function  in ?)
 1687  *!               : BOXFIELD()         (function  in ?)
 1688  *!
 1689  *!*****************************************************************************
 1676      function mcobrad
 1677      parameter xban
 1678      select cobrador
 1679    ÚÄif  .not. seek(xban)
 1680    ³    mcobrador = boxfield('COBRADOR', ;
 1681    ³        'CODIGO')
 1682    ÀÄendif
 1683      show get mcobrador
 1684      return .t.
 1685      *
 1723  *!*****************************************************************************
 1724  *!
 1725  *!       Function: DEUDA_VEN1()
 1726  *!
 1727  *!      Called by: SCP20033.PRG                      
 1728  *!               : SCP20333.PRG                      
 1729  *!
 1730  *!          Calls: LEFT()             (function  in ?)
 1731  *!               : ALLTRIM()          (function  in ?)
 1732  *!               : STR()              (function  in ?)
 1733  *!               : YEAR()             (function  in ?)
 1734  *!               : CTOD()             (function  in ?)
 1735  *!               : SUBSTR()           (function  in ?)
 1736  *!               : SPACE()            (function  in ?)
 1737  *!               : LTRIM()            (function  in ?)
 1738  *!               : SEEK()             (function  in ?)
 1739  *!               : DATE()             (function  in ?)
 1740  *!               : LASTKEY()          (function  in ?)
 1741  *!               : SALIDA()           (function  in ?)
 1742  *!               : MBANCOS()          (function  in SCP20033.PRG)
 1743  *!               : BOXFIELD()         (function  in ?)
 1744  *!               : MSGERRO()          (function  in ?)
 1745  *!               : COL()              (function  in ?)
 1746  *!               : MCOBRAD()          (function  in SCP20033.PRG)
 1747  *!               : ACEPTA()           (function  in ?)
 1748  *!               : PRINTER()          (function  in ?)
 1749  *!               : RLOCK()            (function  in ?)
 1750  *!               : CHR()              (function  in ?)
 1751  *!               : PCOL()             (function  in ?)
 1752  *!               : LETRAS()           (function  in ?)
 1753  *!               : FLOCK()            (function  in ?)
 1754  *!               : IIF()              (function  in ?)
 1755  *!               : RIGHT()            (function  in ?)
 1756  *!
 1757  *!           Uses: MP&XLAP.DBF            Alias: NUEVO
 1758  *!
 1759  *!*****************************************************************************
 1723      function deuda_ven1
 1724      define window deuda from 00, 00  ;
 1725          to 24, 79 shadow title  ;
 1726          'Registro de Control de Deuda Anterior'  ;
 1727          color scheme 5
 1728      activate window deuda
 1729      @ 00, 00 say  ;
 1730          'ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»'
 1731      @ 01, 00 say  ;
 1732          'º C.I. :            Alumno:                                                  º'
 1733      @ 02, 00 say  ;
 1734          'º Menci¢n :                   Semestre    Plan de Cobro:       Lapso:        º'
 1735      @ 03, 00 say  ;
 1736          'ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶'
 1737      @ 04, 00 say  ;
 1738          'ºTot.Deuda Vencida Mens.:               Fecha de Pago    :                   º'
 1739      @ 05, 00 say  ;
 1740          'º   Monto Pagado/Abonado:               Tipo Pago (E/D/C):                   º'
 1741      @ 06, 00 say  ;
 1742          'º  Saldo Pendiente Pagar:               Nro. Dep./Cheq   :                   º'
 1743      @ 07, 00 say  ;
 1744          'º            % Descuento:               Banco :                              º'
 1745      @ 08, 00 say  ;
 1746          'º  Monto Cancelar/Abonar:               Cobrador :                           º'
 1747      @ 09, 00 say  ;
 1748          'º  Nro. ³  Descripci¢n de Conceptos           ³ Fecha Vencmto. ³ Monto Cuota º'  ;
 1749          color n/w
 1750      @ 10, 00 say  ;
 1751          'º       ³                                     ³                ³             º'
 1752      @ 11, 00 say  ;
 1753          'º       ³                                     ³                ³             º'
 1754      @ 12, 00 say  ;
 1755          'º       ³                                     ³                ³             º'
 1756      @ 13, 00 say  ;
 1757          'º       ³                                     ³                ³             º'
 1758      @ 14, 00 say  ;
 1759          'º       ³                                     ³                ³             º'
 1760      @ 15, 00 say  ;
 1761          'º       ³                                     ³                ³             º'
 1762      @ 16, 00 say  ;
 1763          'º       ³                                     ³                ³             º'
 1764      @ 17, 00 say  ;
 1765          'º       ³                                     ³                ³             º'
 1766      @ 18, 00 say  ;
 1767          'º       ³                                     ³                ³             º'
 1768      @ 19, 00 say  ;
 1769          'º       ³                                     ³                ³             º'
 1770      @ 20, 00 say  ;
 1771          'º       ³                                     ³                ³             º'
 1772      @ 21, 00 say  ;
 1773          'ÇÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄ¶'
 1774      @ 22, 00 say  ;
 1775          'º                                                              ³             º'
 1776      select 7
 1777      xlap = lapsomat
 1778      m.total_d = total_d - monto_p
 1779      ch1 = left(xlap, 2)
 1780      ch2 = alltrim(str(year(ctod( ;
 1781          '01/01/' + substr(xlap, 5,  ;
 1782          2)))))
 1783    ÚÄif lapsomat <> space(6)
 1784    ³    select 18
 1785    ³    use mp&xlap again alias nuevo order ced
 1786    ³    seek xcedula
 1787    ³  ÚÄif cierre="N"
 1788    ³  ³    scatter memo memvar
 1789    ³  ³    m.curso = cur
 1790    ³  ³    m.saldo = m.total_deud - m.monto_paga
 1791    ³  ³  ÚÄif m.saldo = 0
 1792    ³  ³  ³    release window deuda
 1793  <ÍÍÍÍÍÍÍÍÍÍÍÍreturn .f.
 1794    ³  ³  ÀÄendif
 1795    ³  ³  ÕÍdo case
 1796    ³  ³  ÆÍcase m.curso = '32012'
 1797    ³  ³  ³    m.mencion = 'BASICA'
 1798    ³  ³  ÆÍcase m.curso = '31022'
 1799    ³  ³  ³    m.mencion = 'CIENCIAS'
 1800    ³  ³  ÆÍcase m.curso = '31023'
 1801    ³  ³  ³    m.mencion = 'HUMANIDADES'
 1802    ³  ³  ÔÍendcase
 1803    ³  ÃÄelse
 1804    ³  ³    m.cur = space(5)
 1805    ³  ³    m.curso = space(5)
 1806    ³  ³    m.mencion = space(11)
 1807    ³  ³    m.semestre = space(1)
 1808    ³  ³    m.plancobro = space(5)
 1809    ³  ³    m.ch1 = space(2)
 1810    ³  ³    m.ch2 = space(4)
 1811    ³  ³    m.turno = space(4)
 1812    ³  ³    
 1813    ³  ³    select 7
 1814    ³  ³    m.saldo = total_d - monto_p
 1815    ³  ³    m.monto_p=monto_p
 1816    ³  ÀÄendif
 1817    ÃÄelse
 1818    ³    m.cur = space(5)
 1819    ³    m.curso = space(5)
 1820    ³    m.mencion = space(11)
 1821    ³    m.semestre = space(1)
 1822    ³    m.plancobro = space(5)
 1823    ³    m.ch1 = space(2)
 1824    ³    m.ch2 = space(4)
 1825    ³    m.turno = space(4)
 1826    ÀÄendif
 1827      select 1
 1828      @ 01, 08 get m.cedula picture  ;
 1829          '@!'
 1830      @ 01, 27 get m.nombres picture  ;
 1831          '@!'
 1832      @ 02, 38 get m.semestre picture  ;
 1833          '@!'
 1834      @ 02, 56 get m.plancobro picture  ;
 1835          '@!'
 1836      @ 02, 70 get ch1 picture '@!'
 1837      @ 02, 72 say '-'
 1838      @ 02, 73 get ch2 picture '@!'
 1839      @ 04, 26 get m.saldo picture  ;
 1840          '99,999,999.99'
 1841      @ 05, 26 get m.monto_p picture  ;
 1842          '99,999,999.99'
 1843      @ 06, 26 get m.saldo picture  ;
 1844          '99,999,999.99'
 1845      clear gets
 1846      release datos
 1847      dimension datos( 7, 4)
 1848      external array datos
 1849    ÖÄfor q = 1 to 7
 1850    º    datos( q, 1) = space(50)
 1851    º    datos( q, 2) = 0.00
 1852    º    datos( q, 3) = space(50)
 1853    º    datos( q, 4) = 0.00
 1854    ÓÄendfor
 1855      li = 10
 1856      w = 1
 1857      z = 1
 1858      mpagar = 0.00
 1859    ÚÄif m.cur <> space(5)
 1860    ³  ÖÄfor q = 1 to 12
 1861    ³  º    lq = ltrim(str(q))
 1862    ³  º    mpagar=cuota&lq-pagado&lq
 1863    ³  º  ÚÄif pagado&lq >= cuota&lq
 1864    ³  ^ÍÍÍÍÍÍÍloop
 1865    ³  º  ÀÄendif
 1866    ³  º    mcuota = q
 1867    ³  º    select 11
 1868    ³  º    locate for lapso = xlap  ;
 1869    ³  º        .and. codigo =  ;
 1870    ³  º        m.plancobro  ;
 1871    ³  º        .and. cuota = q
 1872    ³  º    xfec = fecha_ven
 1873    ³  º    xcon = concepto1
 1874    ³  º    select 12
 1875    ³  º  ÚÄif  .not. seek(xcon)
 1876    ³  º  ³    xdes = 'SIN DESCRIPCION'
 1877    ³  º  ÃÄelse
 1878    ³  º  ³    xdes = alltrim(descripcio)
 1879    ³  º  ÀÄendif
 1880    ³  º    select 18
 1881    ³  º    @ li, 02 say  ;
 1882    ³  º        ltrim(str(q)) picture  ;
 1883    ³  º        '99'
 1884    ³  º    @ li, 11 say xdes
 1885    ³  º    @ li, 51 say xfec  ;
 1886    ³  º        picture '@E'
 1887    ³  º    @ li, 65 say mpagar  ;
 1888    ³  º        picture  ;
 1889    ³  º        '99,999,999.99'
 1890    ³  º    li = li + 1
 1891    ³  º  ÚÄif w > 7
 1892    ³  º  ³    datos( z, 3) =  ;
 1893    ³  º  ³        xdes
 1894    ³  º  ³    datos( z, 4) =  ;
 1895    ³  º  ³        mpagar
 1896    ³  º  ³    z = z + 1
 1897    ³  º  ÃÄelse
 1898    ³  º  ³    datos( w, 1) =  ;
 1899    ³  º  ³        xdes
 1900    ³  º  ³    datos( w, 2) =  ;
 1901    ³  º  ³        mpagar
 1902    ³  º  ÀÄendif
 1903    ³  º    w = w + 1
 1904    ³  ÓÄendfor
 1905    ÃÄelse
 1906    ³  ÖÄfor jj = 1 to 5
 1907    ³  º    lj = ltrim(str(jj))
 1908    ³  º    datos(jj,1)=alltrim(concepto&lj)
 1909    ³  º    datos(jj,2)=monto&lj
 1910    ³  º    @ li, 02 say jj picture  ;
 1911    ³  º        '99'
 1912    ³  º    @li,11 say concepto&lj
 1913    ³  º    @li,65 say monto&lj pict '99,999,999.99'
 1914    ³  º    li = li + 1
 1915    ³  ÓÄendfor
 1916    ÀÄendif
 1917      @ 22, 65 say m.saldo picture  ;
 1918          '99,999,999.99'
 1919      m.fechap = date()
 1920      m.tipop = 'Efectivo'
 1921      m.nrode = space(20)
 1922      m.banco = space(2)
 1923      m.montop = 0.00
 1924      m.desban = space(20)
 1925      m.choice = 1
 1926      m.cobrador = space(2)
 1927      m.descuento = 0.00
 1928      save screen to ven
 1929    ÉÍdo while .t.
 1930    º    restore screen from ven
 1931    º    @ 04, 58 get m.fechap  ;
 1932    º        picture '@E'
 1933    º    @ 05, 58 get m.tipop default  ;
 1934    º        'Efectivo' picture  ;
 1935    º        '@!M Deposito,Cheque,Efectivo'
 1936    º    read
 1937    º  ÚÄif lastkey() = 27
 1938    º  ³    p = salida()
 1939    º  ³  ÚÄif p = 2
 1940    º  ³  ³    entra = .f.
 1941    º  ³  ³    release window  ;
 1942    º  ³  ³        deuda
 1943  <ÍÍÍÍÍÍÍÍÍÍÍÍreturn .f.
 1944    º  ³  ÀÄendif
 1945    ^ÍÍÍÍÍÍÍloop
 1946    º  ÀÄendif
 1947    º  ÚÄif m.tipop <> 'Efectivo'
 1948    º  ³    @ 06, 58 get m.nrode  ;
 1949    º  ³        picture '@!S15' valid  ;
 1950    º  ³        m.nrode <> space(20)  ;
 1951    º  ³        error  ;
 1952    º  ³        'El N£mero de la Transacci¢n esta en blanco'
 1953    º  ³    @ 07, 47 get m.banco  ;
 1954    º  ³        picture '@!' valid  ;
 1955    º  ³        mbancos(m.banco)
 1956    º  ³    read
 1957    º  ³    select 10
 1958    º  ³  ÚÄif  .not. seek(m.banco)
 1959    º  ³  ³    m.banco = boxfield('bancos', ;
 1960    º  ³  ³        'codigo')
 1961    º  ³  ÀÄendif
 1962    º  ³    select 9
 1963    º  ³    set order to bandepo
 1964    º  ³  ÚÄif seek(m.banco +  ;
 1965    º  ³  ³        m.nrode)
 1966    º  ³  ³  ÚÄif status <> 'D'
 1967    º  ³  ³  ³    = msgerro( ;
 1968    º  ³  ³  ³        'Ya existe un registro de pagos con este numero, verifique' ;
 1969    º  ³  ³  ³        )
 1970    ^ÍÍÍÍÍÍÍÍÍÍÍÍÍloop
 1971    º  ³  ³  ÀÄendif
 1972    º  ³  ÀÄendif
 1973    º  ³    select 10
 1974    º  ³    @ 07, 47 say m.banco  ;
 1975    º  ³        picture '@!' color w+/ ;
 1976    º  ³        w
 1977    º  ³    @ 07, col() + 2 say  ;
 1978    º  ³        left(descripcio, 25)
 1979    º  ÀÄendif
 1980    º  ÚÄif m.monto_p = 0
 1981    º  ³    @ 07, 26 get  ;
 1982    º  ³        m.descuento picture  ;
 1983    º  ³        '999' valid  ;
 1984    º  ³        m.descuento <= 100  ;
 1985    º  ³        error  ;
 1986    º  ³        'El Porcentaje de Descuento es invalido, verifique'
 1987    º  ³    read
 1988    º  ³  ÚÄif lastkey() = 27
 1989    º  ³  ³    p = salida()
 1990    º  ³  ³  ÚÄif p = 2
 1991    º  ³  ³  ³    entra = .f.
 1992    º  ³  ³  ³    release window  ;
 1993    º  ³  ³  ³        deuda
 1994  <ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍreturn .f.
 1995    º  ³  ³  ÀÄendif
 1996    ^ÍÍÍÍÍÍÍÍÍÍloop
 1997    º  ³  ÀÄendif
 1998    º  ³    m.porc = m.descuento /  ;
 1999    º  ³        100
 2000    º  ³    m.montop = m.saldo *  ;
 2001    º  ³        m.porc
 2002    º  ÀÄendif
 2003    º    @ 08, 26 get m.montop  ;
 2004    º        picture '99,999,999.99'
 2005    º    @ 08, 50 get m.cobrador  ;
 2006    º        picture '@!' valid  ;
 2007    º        mcobrad(m.cobrador)
 2008    º    read
 2009    º  ÚÄif lastkey() = 27
 2010    º  ³    p = salida()
 2011    º  ³  ÚÄif p = 2
 2012    º  ³  ³    entra = .f.
 2013    º  ³  ³    release window  ;
 2014    º  ³  ³        deuda
 2015  <ÍÍÍÍÍÍÍÍÍÍÍÍreturn .f.
 2016    º  ³  ÀÄendif
 2017    ^ÍÍÍÍÍÍÍloop
 2018    º  ÀÄendif
 2019    º  ÚÄif m.descuento > 0
 2020    º  ³    m.porc = m.descuento /  ;
 2021    º  ³        100
 2022    º  ³    nuevosaldo = m.saldo *  ;
 2023    º  ³        m.porc
 2024    º  ³  ÚÄif m.montop <= 0 .or.  ;
 2025    º  ³  ³        m.montop >  ;
 2026    º  ³  ³        nuevosaldo
 2027    º  ³  ³    = msgerro( ;
 2028    º  ³  ³        'El Monto a Pagar por Concepto de Mensualidad es invalido, verifique' ;
 2029    º  ³  ³        )
 2030    ^ÍÍÍÍÍÍÍÍÍÍloop
 2031    º  ³  ÀÄendif
 2032    º  ³  ÚÄif nuevosaldo >  ;
 2033    º  ³  ³        m.montop
 2034    º  ³  ³    = msgerro( ;
 2035    º  ³  ³        'El Monto a cancelar es invalido, no se permite abonos para esta modalidad' ;
 2036    º  ³  ³        )
 2037    ^ÍÍÍÍÍÍÍÍÍÍloop
 2038    º  ³  ÀÄendif
 2039    º  ÃÄelse
 2040    º  ³  ÚÄif m.montop = 0 .or.  ;
 2041    º  ³  ³        m.montop > m.saldo
 2042    º  ³  ³    = msgerro( ;
 2043    º  ³  ³        'El Monto a Pagar por Concepto de Mensualidad es invalido, verifique' ;
 2044    º  ³  ³        )
 2045    ^ÍÍÍÍÍÍÍÍÍÍloop
 2046    º  ³  ÀÄendif
 2047    º  ÀÄendif
 2048    º    select cobrador
 2049    º  ÚÄif  .not. seek(m.cobrador)
 2050    º  ³    m.cobrador = boxfield('cobrador', ;
 2051    º  ³        'codigo')
 2052    º  ÀÄendif
 2053    º    select 14
 2054    º    @ 08, 50 say m.cobrador  ;
 2055    º        picture '@!' color w+/w
 2056    º    @ 08, col() + 2 say  ;
 2057    º        left(nombres, 20)
 2058    º    mnomcob = alltrim(nombres)
 2059    º    opc = acepta( ;
 2060    º        'Esta correcto este Monto a Cancelar' ;
 2061    º        )
 2062    º  ÚÄif opc = 2
 2063    ^ÍÍÍÍÍÍÍloop
 2064    º  ÀÄendif
 2065    vÍÍÍÍexit
 2066    ÈÍenddo
 2067    ÚÄif m.descuento > 0
 2068    ³    m.porc = m.descuento / 100
 2069    ³    nuevosaldo = (m.saldo *  ;
 2070    ³        m.porc) -  ;
 2071    ³        m.montop
 2072    ÃÄelse
 2073    ³    nuevosaldo = m.saldo -  ;
 2074    ³        m.montop
 2075    ÀÄendif
 2076      opce = acepta( ;
 2077          'Proceso este Pago de Mensualidad' ;
 2078          )
 2079    ÚÄif opce = 2
 2080    ³    release window deuda
 2081  <ÍÍÍÍÍÍreturn .f.
 2082    ÀÄendif
 2083      mrecibo = 0
 2084      select 18
 2085      p = printer()
 2086    ÚÄif p = 2
 2087    ³    select 13
 2088    ³  ÉÍdo while .t.
 2089    ³  º  ÚÄif rlock()
 2090    ³  º  ³    replace recibo  ;
 2091    ³  º  ³        with  ;
 2092    ³  º  ³        recibo +  ;
 2093    ³  º  ³        1
 2094    ³  º  ³    mrecibo = recibo
 2095    ³  º  ³    unlock
 2096    ³  vÍÍÍÍÍÍÍexit
 2097    ³  º  ÀÄendif
 2098    ³  ÈÍenddo
 2099    ³    select 18
 2100    ³    wait window  ;
 2101    ³        'Nro. del Recibo Generado: ' +  ;
 2102    ³        ltrim(str(mrecibo)) +  ;
 2103    ³        chr(13) +  ;
 2104    ³        'Presione Cualquier Tecla para continuar..'
 2105    ÃÄelse
 2106    ³    select 13
 2107    ³  ÉÍdo while .t.
 2108    ³  º  ÚÄif rlock()
 2109    ³  º  ³    replace recibo  ;
 2110    ³  º  ³        with  ;
 2111    ³  º  ³        recibo +  ;
 2112    ³  º  ³        1
 2113    ³  º  ³    mrecibo = recibo
 2114    ³  º  ³    unlock
 2115    ³  vÍÍÍÍÍÍÍexit
 2116    ³  º  ÀÄendif
 2117    ³  ÈÍenddo
 2118    ³    select 18
 2119    ³    set device to printer
 2120    ³    @ 0, 1 say '  ' + chr(27) +  ;
 2121    ³        chr(67) + chr(33)
 2122    ³    @ 00, 00 say chr(18) +  ;
 2123    ³        chr(20)
 2124    ³    @ 00, 00 say chr(14) +  ;
 2125    ³        chr(15) + titulo + chr(18) +  ;
 2126    ³        chr(20) + ' '
 2127    ³    @ 01, 00 say  ;
 2128    ³        'RIF .                                                   RECIBO Nro.:          '
 2129    ³    @ 01, 04 say l_rif
 2130    ³    @ 01, 68 say chr(14) + ng +  ;
 2131    ³        ltrim(str(mrecibo)) + ngn
 2132    ³    @ 02, 00 say chr(15) + ' '
 2133    ³    @ 02, 00 say l_direccio
 2134    ³    @ 02, pcol() say chr(18) +  ;
 2135    ³        chr(20) + ' '
 2136    ³    @ 02, 00 say  ;
 2137    ³        '                                                        FECHA PAGO:          '
 2138    ³    @ 02, 68 say m.fechap  ;
 2139    ³        picture '@E'
 2140    ³    @ 03, 00 say  ;
 2141    ³        '                                                      '
 2142    ³    @ 03, 28 say chr(14) +  ;
 2143    ³        chr(15) + 'RECIBO DE PAGO' +  ;
 2144    ³        chr(18) + chr(20) + ' '
 2145    ³    @ 04, 00 say  ;
 2146    ³        '                                                      ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ» '
 2147    ³    @ 05, 00 say  ;
 2148    ³        'C.I.:                                                 º Bs.                º '
 2149    ³    @ 05, 61 say m.montop  ;
 2150    ³        picture '9,999,999.99'
 2151    ³    @ 05, 06 say m.cedula  ;
 2152    ³        picture '!-99999999'
 2153    ³    @ 06, 00 say  ;
 2154    ³        'ALUMNO:                                               ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼ '
 2155    ³    @ 06, 08 say m.nombres  ;
 2156    ³        picture '@!s45'
 2157    ³    xcantidad = letras(m.montop)
 2158    ³    xcantidad = alltrim(xcantidad)
 2159    ³    @ 08, 00 say  ;
 2160    ³        'Hemos recibido la cantidad de:'
 2161    ³    @ 10, 00 say xcantidad  ;
 2162    ³        picture '@!'
 2163    ³    li = 11
 2164    ³    @ li, 00 say  ;
 2165    ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ' +  ;
 2166    ³        ng
 2167    ³    li = li + 1
 2168    ³    @ li, 00 say  ;
 2169    ³        '  C O N C E P T O S                                          M O N T O       ' +  ;
 2170    ³        ngn
 2171    ³    li = li + 1
 2172    ³    @ li, 00 say  ;
 2173    ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ'
 2174    ³    li = li + 1
 2175    ³    suma = 0.00
 2176    ³    m.montop1 = 0.00
 2177    ³    m.montop1 = m.montop
 2178    ³  ÖÄfor s = 1 to 7
 2179    ³  º    ls = ltrim(str(s))
 2180    ³  º  ÚÄif datos(s,1) =  ;
 2181    ³  º  ³        space(60)
 2182    ³  ^ÍÍÍÍÍÍÍloop
 2183    ³  º  ÀÄendif
 2184    ³  º    @ li, 01 say datos(s,1)  ;
 2185    ³  º        picture '@!s50'
 2186    ³  º  ÚÄif datos(s,2) <=  ;
 2187    ³  º  ³        m.montop1
 2188    ³  º  ³  ÚÄif datos(s,2) =  ;
 2189    ³  º  ³  ³        0.00
 2190    ³  vÍÍÍÍÍÍÍÍÍÍexit
 2191    ³  º  ³  ÀÄendif
 2192    ³  º  ³    @ li, 60 say  ;
 2193    ³  º  ³        datos(s,2)  ;
 2194    ³  º  ³        picture  ;
 2195    ³  º  ³        '999,999.99'
 2196    ³  º  ÃÄelse
 2197    ³  º  ³    @ li, 60 say  ;
 2198    ³  º  ³        m.montop1  ;
 2199    ³  º  ³        picture  ;
 2200    ³  º  ³        '999,999.99'
 2201    ³  vÍÍÍÍÍÍÍexit
 2202    ³  º  ÀÄendif
 2203    ³  º    li = li + 1
 2204    ³  º    m.montop1 = m.montop1 -  ;
 2205    ³  º        datos(s,2)
 2206    ³  ÓÄendfor
 2207    ³    @ 21, 00 say  ;
 2208    ³        'ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»'
 2209    ³    @ 22, 00 say  ;
 2210    ³        'º            N O T A            º  EFECTIVO   [ ]   CHEQ/DEPOST [ ]           º'
 2211    ³  ÚÄif m.tipop <> 'Efectivo'
 2212    ³  ³    @ 22, 65 say 'X'
 2213    ³  ÃÄelse
 2214    ³  ³    @ 22, 47 say 'X'
 2215    ³  ÀÄendif
 2216    ³    @ 23, 00 say  ;
 2217    ³        'ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶  NRO. :                                     º'
 2218    ³    @ 23, 41 say m.nrode picture  ;
 2219    ³        '@!'
 2220    ³    @ 24, 00 say  ;
 2221    ³        'º                               º  BANCO:                                     º'
 2222    ³    @ 24, 41 say m.desban
 2223    ³    @ 25, 00 say  ;
 2224    ³        'º                               º                                             º'
 2225    ³    @ 26, 00 say  ;
 2226    ³        'º                               º                        ___________________  º'
 2227    ³    @ 27, 00 say  ;
 2228    ³        'º                               º                           RECIBIDO POR:     º'
 2229    ³    @ 28, 00 say  ;
 2230    ³        'ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼'
 2231    ³    @ 29, 00 say  ;
 2232    ³        ' NOTA: Los Pagos Realizados no estan sujetos a devoluciones'
 2233    ³    @ 30, 00 say ' '
 2234    ³    eject
 2235    ³    set device to screen
 2236    ÀÄendif
 2237      select 9
 2238    ÉÍdo while .t.
 2239    º  ÚÄif flock()
 2240    º  ³    append blank
 2241    º  ³    replace recibo with  ;
 2242    º  ³        mrecibo, cedula  ;
 2243    º  ³        with m.cedula
 2244    º  ³    replace curso with  ;
 2245    º  ³        m.curso,  ;
 2246    º  ³        plancobro with  ;
 2247    º  ³        m.plancobro
 2248    º  ³    replace seccion with  ;
 2249    º  ³        m.semestre,  ;
 2250    º  ³        fecha_pago with  ;
 2251    º  ³        m.fechap
 2252    º  ³    replace nrocuota with 0,  ;
 2253    º  ³        tipo_pago with  ;
 2254    º  ³        m.tipop,  ;
 2255    º  ³        nro_depo with  ;
 2256    º  ³        m.nrode
 2257    º  ³    replace cod_banco with  ;
 2258    º  ³        m.banco, monto  ;
 2259    º  ³        with m.montop,  ;
 2260    º  ³        transa with  ;
 2261    º  ³        'AT'
 2262    º  ³    replace cobrador with  ;
 2263    º  ³        m.cobrador
 2264    º  ³    replace lapso with  ;
 2265    º  ³        lapmat
 2266    º  ³    unlock
 2267    vÍÍÍÍÍÍÍexit
 2268    º  ÀÄendif
 2269    ÈÍenddo
 2270      select 7
 2271    ÉÍdo while .t.
 2272    º  ÚÄif rlock()
 2273    º  ³    replace monto_p with  ;
 2274    º  ³        monto_p +  ;
 2275    º  ³        m.montop
 2276    º  ³    replace descto with  ;
 2277    º  ³        m.descuento
 2278    º  ³    unlock
 2279    vÍÍÍÍÍÍÍexit
 2280    º  ÀÄendif
 2281    ÈÍenddo
 2282      select 18
 2283    ÉÍdo while .t.
 2284    º  ÚÄif rlock()
 2285    º  ³    mpagado = m.montop
 2286    º  ³    ii = 1
 2287    º  ³  ÖÄfor ii = 1 to 12
 2288    º  ³  º    lk = ltrim(str(ii))
 2289    º  ³  º  ÚÄif pagado&lk=cuota&lk
 2290    º  ³  º  ³    li = li + 1
 2291    º  ³  ^ÍÍÍÍÍÍÍloop
 2292    º  ³  º  ÀÄendif
 2293    º  ³  º  ÚÄif (mpagado+pagado&lk);
 2294    º  ³  º  ³        >= m.cuota&lk
 2295    º  ³  º  ³    mpagado=mpagado-(m.cuota&lk-pagado&lk)
 2296    º  ³  º  ³    replace ultimacuot  ;
 2297    º  ³  º  ³        with  ;
 2298    º  ³  º  ³        ultimacuot +  ;
 2299    º  ³  º  ³        1
 2300    º  ³  º  ³    x=(m.cuota&lk-pagado&lk)
 2301    º  ³  º  ³    replace monto_paga  ;
 2302    º  ³  º  ³        with  ;
 2303    º  ³  º  ³        monto_paga +  ;
 2304    º  ³  º  ³        x
 2305    º  ³  º  ³    repla pagado&lk with;
 2306    º  ³  º  ³        m.cuota&lk
 2307    º  ³  º  ³    replace nrorecibo  ;
 2308    º  ³  º  ³        with  ;
 2309    º  ³  º  ³        mrecibo
 2310    º  ³  º  ³    replace fecha_ultp  ;
 2311    º  ³  º  ³        with  ;
 2312    º  ³  º  ³        m.fechap
 2313    º  ³  º  ÃÄelse
 2314    º  ³  º  ³    repla pagado&lk with;
 2315    º  ³  º  ³        pagado&lk+mpagado
 2316    º  ³  º  ³    replace monto_paga  ;
 2317    º  ³  º  ³        with  ;
 2318    º  ³  º  ³        monto_paga +  ;
 2319    º  ³  º  ³        mpagado
 2320    º  ³  º  ³    replace nrorecibo  ;
 2321    º  ³  º  ³        with  ;
 2322    º  ³  º  ³        mrecibo
 2323    º  ³  º  ³    replace fecha_ultp  ;
 2324    º  ³  º  ³        with  ;
 2325    º  ³  º  ³        m.fechap
 2326    º  ³  vÍÍÍÍÍÍÍexit
 2327    º  ³  º  ÀÄendif
 2328    º  ³  ÓÄendfor
 2329    º  ³    unlock
 2330    vÍÍÍÍÍÍÍexit
 2331    º  ÀÄendif
 2332    ÈÍenddo
 2333      release window deuda
 2334      return iif(nuevosaldo = 0, .t.,  ;
 2335          .f.)
 2336      *
 2372  *!*****************************************************************************
 2373  *!
 2374  *!       Function: DEUDA_VEN2()
 2375  *!
 2376  *!      Called by: SCP20033.PRG                      
 2377  *!
 2378  *!          Calls: LEFT()             (function  in ?)
 2379  *!               : ALLTRIM()          (function  in ?)
 2380  *!               : STR()              (function  in ?)
 2381  *!               : YEAR()             (function  in ?)
 2382  *!               : CTOD()             (function  in ?)
 2383  *!               : SUBSTR()           (function  in ?)
 2384  *!               : SPACE()            (function  in ?)
 2385  *!               : LTRIM()            (function  in ?)
 2386  *!               : SEEK()             (function  in ?)
 2387  *!               : DATE()             (function  in ?)
 2388  *!               : LASTKEY()          (function  in ?)
 2389  *!               : SALIDA()           (function  in ?)
 2390  *!               : MBANCOS()          (function  in SCP20033.PRG)
 2391  *!               : BOXFIELD()         (function  in ?)
 2392  *!               : MSGERRO()          (function  in ?)
 2393  *!               : COL()              (function  in ?)
 2394  *!               : MCOBRAD()          (function  in SCP20033.PRG)
 2395  *!               : ACEPTA()           (function  in ?)
 2396  *!               : PRINTER()          (function  in ?)
 2397  *!               : RLOCK()            (function  in ?)
 2398  *!               : CHR()              (function  in ?)
 2399  *!               : PCOL()             (function  in ?)
 2400  *!               : LETRAS()           (function  in ?)
 2401  *!               : FLOCK()            (function  in ?)
 2402  *!               : IIF()              (function  in ?)
 2403  *!
 2404  *!           Uses: AD&XLAP.DBF            Alias: NUEVO
 2405  *!
 2406  *!*****************************************************************************
 2372      function deuda_ven2
 2373      define window deuda from 00, 00  ;
 2374          to 24, 79 shadow title  ;
 2375          'Registro de Control de Deuda Anterior'  ;
 2376          color scheme 5
 2377      activate window deuda
 2378      @ 00, 00 say 'ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»'
 2379      @ 01, 00 say 'º C.I. :            Alumno:                                                  º'
 2380      @ 02, 00 say 'º Menci¢n :                   Semestre    Plan de Cobro:       Lapso:        º'
 2381      @ 03, 00 say 'ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶'
 2382      @ 04, 00 say 'ºTot.Deuda Vencida Adic.:               Fecha de Pago    :                   º'
 2383      @ 05, 00 say 'º   Monto Pagado/Abonado:               Tipo Pago (E/D/C):                   º'
 2384      @ 06, 00 say 'º  Saldo Pendiente Pagar:               Nro. Dep./Cheq   :                   º'
 2385      @ 07, 00 say 'º            % Descuento:               Banco :                              º'
 2386      @ 08, 00 say 'º  Monto Cancelar/Abonar:               Cobrador :                           º'
 2387      @ 09, 00 say 'º  Nro. ³  Descripci¢n de Conceptos           ³ Fecha Vencmto. ³ Monto Cuota º'  color n/w
 2388      @ 10, 00 say 'º       ³                                     ³                ³             º'
 2389      @ 11, 00 say 'º       ³                                     ³                ³             º'
 2390      @ 12, 00 say 'º       ³                                     ³                ³             º'
 2391      @ 13, 00 say 'º       ³                                     ³                ³             º'
 2392      @ 14, 00 say 'º       ³                                     ³                ³             º'
 2393      @ 15, 00 say 'º       ³                                     ³                ³             º'
 2394      @ 16, 00 say 'º       ³                                     ³                ³             º'
 2395      @ 17, 00 say 'º       ³                                     ³                ³             º'
 2396      @ 18, 00 say 'º       ³                                     ³                ³             º'
 2397      @ 19, 00 say 'º       ³                                     ³                ³             º'
 2398      @ 20, 00 say 'º       ³                                     ³                ³             º'
 2399      @ 21, 00 say 'ÇÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄ¶'
 2400      @ 22, 00 say 'º                                                              ³             º'
 2401      select 7
 2402      xlap = lapsomat
 2403      m.total_d = total_d - monto_p
 2404      ch1 = left(xlap, 2)
 2405      ch2 = alltrim(str(year(ctod('01/01/' + substr(xlap, 5,2)))))
 2406    ÚÄif lapsomat <> space(6)
 2407    ³    select 18
 2408    ³    use ad&xlap again alias nuevo order ced
 2409    ³    seek xcedula
 2410    ³    scatter memo memvar
 2411    ³    m.saldo = m.total_deud - m.monto_paga
 2412    ³  ÚÄif m.saldo = 0
 2413    ³  ³    release window deuda
 2414  <ÍÍÍÍÍÍÍÍÍreturn .f.
 2415    ³  ÀÄendif
 2416    ³    m.curso = cur
 2417    ³  ÕÍdo case
 2418    ³  ÆÍcase m.curso = '32012'
 2419    ³  ³    m.mencion = 'BASICA'
 2420    ³  ÆÍcase m.curso = '31022'
 2421    ³  ³    m.mencion = 'CIENCIAS'
 2422    ³  ÆÍcase m.curso = '31023'
 2423    ³  ³    m.mencion = 'HUMANIDADES'
 2424    ³  ÔÍendcase
 2425    ÃÄelse
 2426    ³    m.cur = space(5)
 2427    ³    m.curso = space(5)
 2428    ³    m.mencion = space(11)
 2429    ³    m.semestre = space(1)
 2430    ³    m.plancobro = space(5)
 2431    ³    m.ch1 = space(2)
 2432    ³    m.ch2 = space(4)
 2433    ³    m.turno = space(4)
 2434    ÀÄendif
 2435      select 1
 2436      @ 01, 08 get m.cedula picture '@!'
 2437      @ 01, 27 get m.nombres picture '@!'
 2438      @ 02, 38 get m.semestre picture '@!'
 2439      @ 02, 56 get m.plancobro picture '@!'
 2440      @ 02, 70 get ch1 picture '@!'
 2441      @ 02, 72 say '-'
 2442      @ 02, 73 get ch2 picture '@!'
 2443      @ 04, 26 get m.saldo picture '99,999,999.99'
 2444      @ 05, 26 get m.monto_p picture '99,999,999.99'
 2445      @ 06, 26 get m.saldo picture '99,999,999.99'
 2446      clear gets
 2447      release datos
 2448      dimension datos( 7, 4)
 2449      external array datos
 2450    ÖÄfor q = 1 to 7
 2451    º    datos( q, 1) = space(50)
 2452    º    datos( q, 2) = 0.00
 2453    º    datos( q, 3) = space(50)
 2454    º    datos( q, 4) = 0.00
 2455    ÓÄendfor
 2456      li = 10
 2457      w = 1
 2458      z = 1
 2459      mpagar = 0.00
 2460    ÚÄif m.cur <> space(5)
 2461    ³  ÖÄfor q = 1 to 12
 2462    ³  º    lq = ltrim(str(q))
 2463    ³  º    mpagar=cuota&lq-pagado&lq
 2464    ³  º  ÚÄif pagado&lq >= cuota&lq
 2465    ³  ^ÍÍÍÍÍÍÍloop
 2466    ³  º  ÀÄendif
 2467    ³  º    mcuota = q
 2468    ³  º    select 11
 2469    ³  º    locate for lapso = xlap  ;
 2470    ³  º        .and. codigo =  ;
 2471    ³  º        m.plancobro  ;
 2472    ³  º        .and. cuota = q
 2473    ³  º    xfec = fecha_ven
 2474    ³  º    xcon = concepto1
 2475    ³  º    select 12
 2476    ³  º  ÚÄif  .not. seek(xcon)
 2477    ³  º  ³    xdes = 'SIN DESCRIPCION'
 2478    ³  º  ÃÄelse
 2479    ³  º  ³    xdes = alltrim(descripcio)
 2480    ³  º  ÀÄendif
 2481    ³  º    select 18
 2482    ³  º    @ li, 02 say  ;
 2483    ³  º        ltrim(str(q)) picture  ;
 2484    ³  º        '99'
 2485    ³  º    @ li, 11 say xdes
 2486    ³  º    @ li, 51 say xfec  ;
 2487    ³  º        picture '@E'
 2488    ³  º    @ li, 65 say mpagar  ;
 2489    ³  º        picture  ;
 2490    ³  º        '99,999,999.99'
 2491    ³  º    li = li + 1
 2492    ³  º  ÚÄif w > 7
 2493    ³  º  ³    datos( z, 3) =  ;
 2494    ³  º  ³        xdes
 2495    ³  º  ³    datos( z, 4) =  ;
 2496    ³  º  ³        mpagar
 2497    ³  º  ³    z = z + 1
 2498    ³  º  ÃÄelse
 2499    ³  º  ³    datos( w, 1) =  ;
 2500    ³  º  ³        xdes
 2501    ³  º  ³    datos( w, 2) =  ;
 2502    ³  º  ³        mpagar
 2503    ³  º  ÀÄendif
 2504    ³  º    w = w + 1
 2505    ³  ÓÄendfor
 2506    ÃÄelse
 2507    ³  ÖÄfor jj = 1 to 5
 2508    ³  º    lj = ltrim(str(jj))
 2509    ³  º    datos(jj,1)=alltrim(concepto&lj)
 2510    ³  º    datos(jj,2)=monto&lj
 2511    ³  º    @ li, 02 say jj picture  ;
 2512    ³  º        '99'
 2513    ³  º    @li,11 say concepto&lj
 2514    ³  º    @li,65 say monto&lj pict '99,999,999.99'
 2515    ³  º    li = li + 1
 2516    ³  ÓÄendfor
 2517    ÀÄendif
 2518      @ 22, 65 say m.saldo picture  ;
 2519          '99,999,999.99'
 2520      m.fechap = date()
 2521      m.tipop = 'Efectivo'
 2522      m.nrode = space(20)
 2523      m.banco = space(2)
 2524      m.montop = 0.00
 2525      m.desban = space(20)
 2526      m.choice = 1
 2527      m.cobrador = space(2)
 2528      m.descuento = 0.00
 2529      save screen to ven
 2530    ÉÍdo while .t.
 2531    º    restore screen from ven
 2532    º    @ 04, 58 get m.fechap  ;
 2533    º        picture '@E'
 2534    º    @ 05, 58 get m.tipop default  ;
 2535    º        'Efectivo' picture  ;
 2536    º        '@!M Deposito,Cheque,Efectivo'
 2537    º    read
 2538    º  ÚÄif lastkey() = 27
 2539    º  ³    p = salida()
 2540    º  ³  ÚÄif p = 2
 2541    º  ³  ³    entra = .f.
 2542    º  ³  ³    release window  ;
 2543    º  ³  ³        deuda
 2544  <ÍÍÍÍÍÍÍÍÍÍÍÍreturn .f.
 2545    º  ³  ÀÄendif
 2546    ^ÍÍÍÍÍÍÍloop
 2547    º  ÀÄendif
 2548    º  ÚÄif m.tipop <> 'Efectivo'
 2549    º  ³    @ 06, 58 get m.nrode  ;
 2550    º  ³        picture '@!S15' valid  ;
 2551    º  ³        m.nrode <> space(20)  ;
 2552    º  ³        error  ;
 2553    º  ³        'El N£mero de la Transacci¢n esta en blanco'
 2554    º  ³    @ 07, 47 get m.banco  ;
 2555    º  ³        picture '@!' valid  ;
 2556    º  ³        mbancos(m.banco)
 2557    º  ³    read
 2558    º  ³    select 10
 2559    º  ³  ÚÄif  .not. seek(m.banco)
 2560    º  ³  ³    m.banco = boxfield('bancos', ;
 2561    º  ³  ³        'codigo')
 2562    º  ³  ÀÄendif
 2563    º  ³    select 9
 2564    º  ³    set order to bandepo
 2565    º  ³  ÚÄif seek(m.banco +  ;
 2566    º  ³  ³        m.nrode)
 2567    º  ³  ³  ÚÄif status <> 'D'
 2568    º  ³  ³  ³    = msgerro( ;
 2569    º  ³  ³  ³        'Ya existe un registro de pagos con este numero, verifique' ;
 2570    º  ³  ³  ³        )
 2571    ^ÍÍÍÍÍÍÍÍÍÍÍÍÍloop
 2572    º  ³  ³  ÀÄendif
 2573    º  ³  ÀÄendif
 2574    º  ³    select 10
 2575    º  ³    @ 07, 47 say m.banco  ;
 2576    º  ³        picture '@!' color w+/ ;
 2577    º  ³        w
 2578    º  ³    @ 07, col() + 2 say  ;
 2579    º  ³        left(descripcio, 25)
 2580    º  ÀÄendif
 2581    º  ÚÄif m.monto_p = 0
 2582    º  ³    @ 07, 26 get  ;
 2583    º  ³        m.descuento picture  ;
 2584    º  ³        '999' valid  ;
 2585    º  ³        m.descuento <= 100  ;
 2586    º  ³        error  ;
 2587    º  ³        'El Porcentaje de Descuento es invalido, verifique'
 2588    º  ³    read
 2589    º  ³  ÚÄif lastkey() = 27
 2590    º  ³  ³    p = salida()
 2591    º  ³  ³  ÚÄif p = 2
 2592    º  ³  ³  ³    entra = .f.
 2593    º  ³  ³  ³    release window  ;
 2594    º  ³  ³  ³        deuda
 2595  <ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍreturn .f.
 2596    º  ³  ³  ÀÄendif
 2597    ^ÍÍÍÍÍÍÍÍÍÍloop
 2598    º  ³  ÀÄendif
 2599    º  ³    m.porc = m.descuento /  ;
 2600    º  ³        100
 2601    º  ³    m.montop = m.saldo *  ;
 2602    º  ³        m.porc
 2603    º  ÀÄendif
 2604    º    @ 08, 26 get m.montop  ;
 2605    º        picture '99,999,999.99'
 2606    º    @ 08, 50 get m.cobrador  ;
 2607    º        picture '@!' valid  ;
 2608    º        mcobrad(m.cobrador)
 2609    º    read
 2610    º  ÚÄif lastkey() = 27
 2611    º  ³    p = salida()
 2612    º  ³  ÚÄif p = 2
 2613    º  ³  ³    entra = .f.
 2614    º  ³  ³    release window  ;
 2615    º  ³  ³        deuda
 2616  <ÍÍÍÍÍÍÍÍÍÍÍÍreturn .f.
 2617    º  ³  ÀÄendif
 2618    ^ÍÍÍÍÍÍÍloop
 2619    º  ÀÄendif
 2620    º  ÚÄif m.descuento > 0
 2621    º  ³    m.porc = m.descuento /  ;
 2622    º  ³        100
 2623    º  ³    nuevosaldo = m.saldo *  ;
 2624    º  ³        m.porc
 2625    º  ³  ÚÄif m.montop <= 0 .or.  ;
 2626    º  ³  ³        m.montop >  ;
 2627    º  ³  ³        nuevosaldo
 2628    º  ³  ³    = msgerro( ;
 2629    º  ³  ³        'El Monto a Pagar por Concepto de Mensualidad es invalido, verifique' ;
 2630    º  ³  ³        )
 2631    ^ÍÍÍÍÍÍÍÍÍÍloop
 2632    º  ³  ÀÄendif
 2633    º  ³  ÚÄif nuevosaldo >  ;
 2634    º  ³  ³        m.montop
 2635    º  ³  ³    = msgerro( ;
 2636    º  ³  ³        'El Monto a cancelar es invalido, no se permite abonos para esta modalidad' ;
 2637    º  ³  ³        )
 2638    ^ÍÍÍÍÍÍÍÍÍÍloop
 2639    º  ³  ÀÄendif
 2640    º  ÃÄelse
 2641    º  ³  ÚÄif m.montop = 0 .or.  ;
 2642    º  ³  ³        m.montop > m.saldo
 2643    º  ³  ³    = msgerro( ;
 2644    º  ³  ³        'El Monto a Pagar por Concepto de Mensualidad es invalido, verifique' ;
 2645    º  ³  ³        )
 2646    ^ÍÍÍÍÍÍÍÍÍÍloop
 2647    º  ³  ÀÄendif
 2648    º  ÀÄendif
 2649    º    select cobrador
 2650    º  ÚÄif  .not. seek(m.cobrador)
 2651    º  ³    m.cobrador = boxfield('cobrador', ;
 2652    º  ³        'codigo')
 2653    º  ÀÄendif
 2654    º    select 14
 2655    º    @ 08, 50 say m.cobrador  ;
 2656    º        picture '@!' color w+/w
 2657    º    @ 08, col() + 2 say  ;
 2658    º        left(nombres, 20)
 2659    º    mnomcob = alltrim(nombres)
 2660    º    opc = acepta( ;
 2661    º        'Esta correcto este Monto a Cancelar' ;
 2662    º        )
 2663    º  ÚÄif opc = 2
 2664    ^ÍÍÍÍÍÍÍloop
 2665    º  ÀÄendif
 2666    vÍÍÍÍexit
 2667    ÈÍenddo
 2668    ÚÄif m.descuento > 0
 2669    ³    m.porc = m.descuento / 100
 2670    ³    nuevosaldo = (m.saldo *  ;
 2671    ³        m.porc) -  ;
 2672    ³        m.montop
 2673    ÃÄelse
 2674    ³    nuevosaldo = m.saldo -  ;
 2675    ³        m.montop
 2676    ÀÄendif
 2677      opce = acepta( ;
 2678          'Proceso este Pago de Mensualidad' ;
 2679          )
 2680    ÚÄif opce = 2
 2681    ³    release window deuda
 2682  <ÍÍÍÍÍÍreturn .f.
 2683    ÀÄendif
 2684      mrecibo = 0
 2685      select 18
 2686      p = printer()
 2687    ÚÄif p = 2
 2688    ³    select 13
 2689    ³  ÉÍdo while .t.
 2690    ³  º  ÚÄif rlock()
 2691    ³  º  ³    replace recibo  ;
 2692    ³  º  ³        with  ;
 2693    ³  º  ³        recibo +  ;
 2694    ³  º  ³        1
 2695    ³  º  ³    mrecibo = recibo
 2696    ³  º  ³    unlock
 2697    ³  vÍÍÍÍÍÍÍexit
 2698    ³  º  ÀÄendif
 2699    ³  ÈÍenddo
 2700    ³    select 18
 2701    ³    wait window  ;
 2702    ³        'Nro. del Recibo Generado: ' +  ;
 2703    ³        ltrim(str(mrecibo)) +  ;
 2704    ³        chr(13) +  ;
 2705    ³        'Presione Cualquier Tecla para continuar..'
 2706    ÃÄelse
 2707    ³    select 13
 2708    ³  ÉÍdo while .t.
 2709    ³  º  ÚÄif rlock()
 2710    ³  º  ³    replace recibo  ;
 2711    ³  º  ³        with  ;
 2712    ³  º  ³        recibo +  ;
 2713    ³  º  ³        1
 2714    ³  º  ³    mrecibo = recibo
 2715    ³  º  ³    unlock
 2716    ³  vÍÍÍÍÍÍÍexit
 2717    ³  º  ÀÄendif
 2718    ³  ÈÍenddo
 2719    ³    select 18
 2720    ³    set device to printer
 2721    ³    @ 0, 1 say '  ' + chr(27) +  ;
 2722    ³        chr(67) + chr(33)
 2723    ³    @ 00, 00 say chr(18) +  ;
 2724    ³        chr(20)
 2725    ³    @ 00, 00 say chr(14) +  ;
 2726    ³        chr(15) + titulo + chr(18) +  ;
 2727    ³        chr(20) + ' '
 2728    ³    @ 01, 00 say  ;
 2729    ³        'RIF .                                                   RECIBO Nro.:          '
 2730    ³    @ 01, 04 say l_rif
 2731    ³    @ 01, 68 say chr(14) + ng +  ;
 2732    ³        ltrim(str(mrecibo)) + ngn
 2733    ³    @ 02, 00 say chr(15) + ' '
 2734    ³    @ 02, 00 say l_direccio
 2735    ³    @ 02, pcol() say chr(18) +  ;
 2736    ³        chr(20) + ' '
 2737    ³    @ 02, 00 say  ;
 2738    ³        '                                                        FECHA PAGO:          '
 2739    ³    @ 02, 68 say m.fechap  ;
 2740    ³        picture '@E'
 2741    ³    @ 03, 00 say  ;
 2742    ³        '                                                      '
 2743    ³    @ 03, 28 say chr(14) +  ;
 2744    ³        chr(15) + 'RECIBO DE PAGO' +  ;
 2745    ³        chr(18) + chr(20) + ' '
 2746    ³    @ 04, 00 say  ;
 2747    ³        '                                                      ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ» '
 2748    ³    @ 05, 00 say  ;
 2749    ³        'C.I.:                                                 º Bs.                º '
 2750    ³    @ 05, 61 say m.montop  ;
 2751    ³        picture '9,999,999.99'
 2752    ³    @ 05, 06 say m.cedula  ;
 2753    ³        picture '!-99999999'
 2754    ³    @ 06, 00 say  ;
 2755    ³        'ALUMNO:                                               ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼ '
 2756    ³    @ 06, 08 say m.nombres  ;
 2757    ³        picture '@!s45'
 2758    ³    xcantidad = letras(m.montop)
 2759    ³    xcantidad = alltrim(xcantidad)
 2760    ³    @ 08, 00 say  ;
 2761    ³        'Hemos recibido la cantidad de:'
 2762    ³    @ 10, 00 say xcantidad  ;
 2763    ³        picture '@!'
 2764    ³    li = 11
 2765    ³    @ li, 00 say  ;
 2766    ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ' +  ;
 2767    ³        ng
 2768    ³    li = li + 1
 2769    ³    @ li, 00 say  ;
 2770    ³        '  C O N C E P T O S                                          M O N T O       ' +  ;
 2771    ³        ngn
 2772    ³    li = li + 1
 2773    ³    @ li, 00 say  ;
 2774    ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ'
 2775    ³    li = li + 1
 2776    ³    suma = 0.00
 2777    ³    m.montop1 = 0.00
 2778    ³    m.montop1 = m.montop
 2779    ³  ÖÄfor s = 1 to 7
 2780    ³  º    ls = ltrim(str(s))
 2781    ³  º  ÚÄif datos(s,1) =  ;
 2782    ³  º  ³        space(60)
 2783    ³  ^ÍÍÍÍÍÍÍloop
 2784    ³  º  ÀÄendif
 2785    ³  º    @ li, 01 say datos(s,1)  ;
 2786    ³  º        picture '@!s50'
 2787    ³  º  ÚÄif datos(s,2) <=  ;
 2788    ³  º  ³        m.montop1
 2789    ³  º  ³  ÚÄif datos(s,2) =  ;
 2790    ³  º  ³  ³        0.00
 2791    ³  vÍÍÍÍÍÍÍÍÍÍexit
 2792    ³  º  ³  ÀÄendif
 2793    ³  º  ³    @ li, 60 say  ;
 2794    ³  º  ³        datos(s,2)  ;
 2795    ³  º  ³        picture  ;
 2796    ³  º  ³        '999,999.99'
 2797    ³  º  ÃÄelse
 2798    ³  º  ³    @ li, 60 say  ;
 2799    ³  º  ³        m.montop1  ;
 2800    ³  º  ³        picture  ;
 2801    ³  º  ³        '999,999.99'
 2802    ³  vÍÍÍÍÍÍÍexit
 2803    ³  º  ÀÄendif
 2804    ³  º    li = li + 1
 2805    ³  º    m.montop1 = m.montop1 -  ;
 2806    ³  º        datos(s,2)
 2807    ³  ÓÄendfor
 2808    ³    @ 21, 00 say  ;
 2809    ³        'ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»'
 2810    ³    @ 22, 00 say  ;
 2811    ³        'º            N O T A            º  EFECTIVO   [ ]   CHEQ/DEPOST [ ]           º'
 2812    ³  ÚÄif m.tipop <> 'Efectivo'
 2813    ³  ³    @ 22, 65 say 'X'
 2814    ³  ÃÄelse
 2815    ³  ³    @ 22, 47 say 'X'
 2816    ³  ÀÄendif
 2817    ³    @ 23, 00 say  ;
 2818    ³        'ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶  NRO. :                                     º'
 2819    ³    @ 23, 41 say m.nrode picture  ;
 2820    ³        '@!'
 2821    ³    @ 24, 00 say  ;
 2822    ³        'º                               º  BANCO:                                     º'
 2823    ³    @ 24, 41 say m.desban
 2824    ³    @ 25, 00 say  ;
 2825    ³        'º                               º                                             º'
 2826    ³    @ 26, 00 say  ;
 2827    ³        'º                               º                        ___________________  º'
 2828    ³    @ 27, 00 say  ;
 2829    ³        'º                               º                           RECIBIDO POR:     º'
 2830    ³    @ 28, 00 say  ;
 2831    ³        'ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼'
 2832    ³    @ 29, 00 say  ;
 2833    ³        ' NOTA: Los Pagos Realizados no estan sujetos a devoluciones'
 2834    ³    @ 30, 00 say ' '
 2835    ³    eject
 2836    ³    set device to screen
 2837    ÀÄendif
 2838      select 9
 2839    ÉÍdo while .t.
 2840    º  ÚÄif flock()
 2841    º  ³    append blank
 2842    º  ³    replace recibo with  ;
 2843    º  ³        mrecibo, cedula  ;
 2844    º  ³        with m.cedula
 2845    º  ³    replace curso with  ;
 2846    º  ³        m.curso,  ;
 2847    º  ³        plancobro with  ;
 2848    º  ³        m.plancobro
 2849    º  ³    replace seccion with  ;
 2850    º  ³        m.semestre,  ;
 2851    º  ³        fecha_pago with  ;
 2852    º  ³        m.fechap
 2853    º  ³    replace nrocuota with 0,  ;
 2854    º  ³        tipo_pago with  ;
 2855    º  ³        m.tipop,  ;
 2856    º  ³        nro_depo with  ;
 2857    º  ³        m.nrode
 2858    º  ³    replace cod_banco with  ;
 2859    º  ³        m.banco, monto  ;
 2860    º  ³        with m.montop,  ;
 2861    º  ³        transa with  ;
 2862    º  ³        'AT'
 2863    º  ³    replace cobrador with  ;
 2864    º  ³        m.cobrador
 2865    º  ³    replace lapso with  ;
 2866    º  ³        lapmat
 2867    º  ³    unlock
 2868    vÍÍÍÍÍÍÍexit
 2869    º  ÀÄendif
 2870    ÈÍenddo
 2871      select 7
 2872    ÉÍdo while .t.
 2873    º  ÚÄif rlock()
 2874    º  ³    replace monto_p with  ;
 2875    º  ³        monto_p +  ;
 2876    º  ³        m.montop
 2877    º  ³    replace descto with  ;
 2878    º  ³        m.descuento
 2879    º  ³    unlock
 2880    vÍÍÍÍÍÍÍexit
 2881    º  ÀÄendif
 2882    ÈÍenddo
 2883      select 18
 2884    ÉÍdo while .t.
 2885    º  ÚÄif rlock()
 2886    º  ³    mpagado = m.montop
 2887    º  ³    ii = 1
 2888    º  ³  ÖÄfor ii = 1 to 12
 2889    º  ³  º    lk = ltrim(str(ii))
 2890    º  ³  º  ÚÄif pagado&lk=cuota&lk
 2891    º  ³  º  ³    li = li + 1
 2892    º  ³  ^ÍÍÍÍÍÍÍloop
 2893    º  ³  º  ÀÄendif
 2894    º  ³  º  ÚÄif (mpagado+pagado&lk);
 2895    º  ³  º  ³        >= m.cuota&lk
 2896    º  ³  º  ³    mpagado=mpagado-(m.cuota&lk-pagado&lk)
 2897    º  ³  º  ³    replace ultimacuot  ;
 2898    º  ³  º  ³        with  ;
 2899    º  ³  º  ³        ultimacuot +  ;
 2900    º  ³  º  ³        1
 2901    º  ³  º  ³    x=(m.cuota&lk-pagado&lk)
 2902    º  ³  º  ³    replace monto_paga  ;
 2903    º  ³  º  ³        with  ;
 2904    º  ³  º  ³        monto_paga +  ;
 2905    º  ³  º  ³        x
 2906    º  ³  º  ³    repla pagado&lk with;
 2907    º  ³  º  ³        m.cuota&lk
 2908    º  ³  º  ³    replace nrorecibo  ;
 2909    º  ³  º  ³        with  ;
 2910    º  ³  º  ³        mrecibo
 2911    º  ³  º  ³    replace fecha_ultp  ;
 2912    º  ³  º  ³        with  ;
 2913    º  ³  º  ³        m.fechap
 2914    º  ³  º  ÃÄelse
 2915    º  ³  º  ³    repla pagado&lk with;
 2916    º  ³  º  ³        pagado&lk+mpagado
 2917    º  ³  º  ³    replace monto_paga  ;
 2918    º  ³  º  ³        with  ;
 2919    º  ³  º  ³        monto_paga +  ;
 2920    º  ³  º  ³        mpagado
 2921    º  ³  º  ³    replace nrorecibo  ;
 2922    º  ³  º  ³        with  ;
 2923    º  ³  º  ³        mrecibo
 2924    º  ³  º  ³    replace fecha_ultp  ;
 2925    º  ³  º  ³        with  ;
 2926    º  ³  º  ³        m.fechap
 2927    º  ³  vÍÍÍÍÍÍÍexit
 2928    º  ³  º  ÀÄendif
 2929    º  ³  ÓÄendfor
 2930    º  ³    unlock
 2931    vÍÍÍÍÍÍÍexit
 2932    º  ÀÄendif
 2933    ÈÍenddo
 2934      release window deuda
 2935      return iif(nuevosaldo = 0, .t.,  ;
 2936          .f.)
 2937      *
 2971  *!*****************************************************************************
 2972  *!
 2973  *!       Function: DEUDA_VEN3()
 2974  *!
 2975  *!      Called by: SCP20033.PRG                      
 2976  *!
 2977  *!          Calls: LEFT()             (function  in ?)
 2978  *!               : ALLTRIM()          (function  in ?)
 2979  *!               : STR()              (function  in ?)
 2980  *!               : YEAR()             (function  in ?)
 2981  *!               : CTOD()             (function  in ?)
 2982  *!               : SUBSTR()           (function  in ?)
 2983  *!               : SPACE()            (function  in ?)
 2984  *!               : LTRIM()            (function  in ?)
 2985  *!               : SEEK()             (function  in ?)
 2986  *!               : DATE()             (function  in ?)
 2987  *!               : LASTKEY()          (function  in ?)
 2988  *!               : SALIDA()           (function  in ?)
 2989  *!               : MBANCOS()          (function  in SCP20033.PRG)
 2990  *!               : BOXFIELD()         (function  in ?)
 2991  *!               : MSGERRO()          (function  in ?)
 2992  *!               : COL()              (function  in ?)
 2993  *!               : MCOBRAD()          (function  in SCP20033.PRG)
 2994  *!               : ACEPTA()           (function  in ?)
 2995  *!               : PRINTER()          (function  in ?)
 2996  *!               : RLOCK()            (function  in ?)
 2997  *!               : CHR()              (function  in ?)
 2998  *!               : PCOL()             (function  in ?)
 2999  *!               : LETRAS()           (function  in ?)
 3000  *!               : FLOCK()            (function  in ?)
 3001  *!               : IIF()              (function  in ?)
 3002  *!
 3003  *!*****************************************************************************
 2971      function deuda_ven3
 2972      define window deuda from 00, 00  ;
 2973          to 24, 79 shadow title  ;
 2974          'Registro de Control de Deuda Anterior'  ;
 2975          color scheme 5
 2976      activate window deuda
 2977      @ 00, 00 say 'ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»'
 2978      @ 01, 00 say 'º C.I. :            Alumno:                                                  º'
 2979      @ 02, 00 say 'º Menci¢n :                   Semestre    Plan de Cobro:       Lapso:        º'
 2980      @ 03, 00 say 'ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶'
 2981      @ 04, 00 say 'ºTot.Deuda Vencida Adic.:               Fecha de Pago    :                   º'
 2982      @ 05, 00 say 'º   Monto Pagado/Abonado:               Tipo Pago (E/D/C):                   º'
 2983      @ 06, 00 say 'º  Saldo Pendiente Pagar:               Nro. Dep./Cheq   :                   º'
 2984      @ 07, 00 say 'º            % Descuento:               Banco :                              º'
 2985      @ 08, 00 say 'º  Monto Cancelar/Abonar:               Cobrador :                           º'
 2986      @ 09, 00 say 'º  Nro. ³  Descripci¢n de Conceptos           ³ Fecha Vencmto. ³ Monto Cuota º'  color n/w
 2987      @ 10, 00 say 'º       ³                                     ³                ³             º'
 2988      @ 11, 00 say 'º       ³                                     ³                ³             º'
 2989      @ 12, 00 say 'º       ³                                     ³                ³             º'
 2990      @ 13, 00 say 'º       ³                                     ³                ³             º'
 2991      @ 14, 00 say 'º       ³                                     ³                ³             º'
 2992      @ 15, 00 say 'º       ³                                     ³                ³             º'
 2993      @ 16, 00 say 'º       ³                                     ³                ³             º'
 2994      @ 17, 00 say 'º       ³                                     ³                ³             º'
 2995      @ 18, 00 say 'º       ³                                     ³                ³             º'
 2996      @ 19, 00 say 'º       ³                                     ³                ³             º'
 2997      @ 20, 00 say 'º       ³                                     ³                ³             º'
 2998      @ 21, 00 say 'ÇÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄ¶'
 2999      @ 22, 00 say 'º                                                              ³             º'
 3000      select 7
 3001      xlap = lapsomat
 3002      m.total_d = total_d - monto_p
 3003      ch1 = left(xlap, 2)
 3004      ch2 = alltrim(str(year(ctod('01/01/' + substr(xlap, 5, 2)))))
 3005      m.cur = space(5)
 3006      m.curso = space(5)
 3007      m.mencion = space(11)
 3008      m.semestre = space(1)
 3009      m.plancobro = space(5)
 3010      m.ch1 = space(2)
 3011      m.ch2 = space(4)
 3012      m.turno = space(4)
 3013      select 1
 3014      @ 01, 08 get m.cedula picture '@!'
 3015      @ 01, 27 get m.nombres picture '@!'
 3016      @ 02, 38 get m.semestre picture '@!'
 3017      @ 02, 56 get m.plancobro picture '@!'
 3018      @ 02, 70 get ch1 picture '@!'
 3019      @ 02, 72 say '-'
 3020      @ 02, 73 get ch2 picture '@!'
 3021      @ 04, 26 get m.saldo picture '99,999,999.99'
 3022      @ 05, 26 get m.monto_p picture '99,999,999.99'
 3023      @ 06, 26 get m.saldo picture '99,999,999.99'
 3024      clear gets
 3025      release datos
 3026      dimension datos( 7, 4)
 3027      external array datos
 3028    ÖÄfor q = 1 to 7
 3029    º    datos( q, 1) = space(50)
 3030    º    datos( q, 2) = 0.00
 3031    º    datos( q, 3) = space(50)
 3032    º    datos( q, 4) = 0.00
 3033    ÓÄendfor
 3034      li = 10
 3035      w = 1
 3036      z = 1
 3037      mpagar = 0.00
 3038    ÚÄif m.cur <> space(5)
 3039    ³  ÖÄfor q = 1 to 12
 3040    ³  º    lq = ltrim(str(q))
 3041    ³  º    mpagar=cuota&lq-pagado&lq
 3042    ³  º  ÚÄif pagado&lq >= cuota&lq
 3043    ³  ^ÍÍÍÍÍÍÍloop
 3044    ³  º  ÀÄendif
 3045    ³  º    mcuota = q
 3046    ³  º    select 11
 3047    ³  º    locate for lapso = xlap .and. codigo =  m.plancobro  .and. cuota = q
 3048    ³  º    xfec = fecha_ven
 3049    ³  º    xcon = concepto1
 3050    ³  º    select 12
 3051    ³  º  ÚÄif  .not. seek(xcon)
 3052    ³  º  ³    xdes = 'SIN DESCRIPCION'
 3053    ³  º  ÃÄelse
 3054    ³  º  ³    xdes = alltrim(descripcio)
 3055    ³  º  ÀÄendif
 3056    ³  º    select 18
 3057    ³  º    @ li, 02 say ltrim(str(q)) picture '99'
 3058    ³  º    @ li, 11 say xdes
 3059    ³  º    @ li, 51 say xfec picture '@E'
 3060    ³  º    @ li, 65 say mpagar picture '99,999,999.99'
 3061    ³  º    li = li + 1
 3062    ³  º  ÚÄif w > 7
 3063    ³  º  ³    datos( z, 3) =  xdes
 3064    ³  º  ³    datos( z, 4) =  mpagar
 3065    ³  º  ³    z = z + 1
 3066    ³  º  ÃÄelse
 3067    ³  º  ³    datos( w, 1) = xdes
 3068    ³  º  ³    datos( w, 2) = mpagar
 3069    ³  º  ÀÄendif
 3070    ³  º    w = w + 1
 3071    ³  ÓÄendfor
 3072    ÃÄelse
 3073    ³  ÖÄfor jj = 1 to 5
 3074    ³  º    lj = ltrim(str(jj))
 3075    ³  º    datos(jj,1)=alltrim(concepto&lj)
 3076    ³  º    datos(jj,2)=monto&lj
 3077    ³  º    @ li, 02 say jj picture '99'
 3078    ³  º    @li,11 say concepto&lj
 3079    ³  º    @li,65 say monto&lj pict '99,999,999.99'
 3080    ³  º    li = li + 1
 3081    ³  ÓÄendfor
 3082    ÀÄendif
 3083      @ 22, 65 say m.saldo picture '99,999,999.99'
 3084      m.fechap = date()
 3085      m.tipop = 'Efectivo'
 3086      m.nrode = space(20)
 3087      m.banco = space(2)
 3088      m.montop = 0.00
 3089      m.desban = space(20)
 3090      m.choice = 1
 3091      m.cobrador = space(2)
 3092      m.descuento = 0.00
 3093      save screen to ven
 3094    ÉÍdo while .t.
 3095    º    restore screen from ven
 3096    º    @ 04, 58 get m.fechap picture '@E'
 3097    º    @ 05, 58 get m.tipop default 'Efectivo' picture '@!M Deposito,Cheque,Efectivo'
 3098    º    read
 3099    º  ÚÄif lastkey() = 27
 3100    º  ³    p = salida()
 3101    º  ³  ÚÄif p = 2
 3102    º  ³  ³    entra = .f.
 3103    º  ³  ³    release window deuda
 3104  <ÍÍÍÍÍÍÍÍÍÍÍÍreturn .f.
 3105    º  ³  ÀÄendif
 3106    ^ÍÍÍÍÍÍÍloop
 3107    º  ÀÄendif
 3108    º  ÚÄif m.tipop <> 'Efectivo'
 3109    º  ³    @ 06, 58 get m.nrode picture '@!S15' valid m.nrode <> space(20) error  'El N£mero de la Transacci¢n esta en blanco'
 3110    º  ³    @ 07, 47 get m.banco picture '@!' valid mbancos(m.banco)
 3111    º  ³    read
 3112    º  ³    select 10
 3113    º  ³  ÚÄif  .not. seek(m.banco)
 3114    º  ³  ³    m.banco = boxfield('bancos','codigo')
 3115    º  ³  ÀÄendif
 3116    º  ³    select 9
 3117    º  ³    set order to bandepo
 3118    º  ³  ÚÄif seek(m.banco + m.nrode)
 3119    º  ³  ³  ÚÄif status <> 'D'
 3120    º  ³  ³  ³    = msgerro('Ya existe un registro de pagos con este numero, verifique')
 3121    ^ÍÍÍÍÍÍÍÍÍÍÍÍÍloop
 3122    º  ³  ³  ÀÄendif
 3123    º  ³  ÀÄendif
 3124    º  ³    select 10
 3125    º  ³    @ 07, 47 say m.banco picture '@!' color w+/w
 3126    º  ³    @ 07, col() + 2 say left(descripcio, 25)
 3127    º  ÀÄendif
 3128    º  ÚÄif m.monto_p = 0
 3129    º  ³    @ 07, 26 get m.descuento picture '999' valid m.descuento <= 100 error 'El Porcentaje de Descuento es invalido, verifique'
 3130    º  ³    read
 3131    º  ³  ÚÄif lastkey() = 27
 3132    º  ³  ³    p = salida()
 3133    º  ³  ³  ÚÄif p = 2
 3134    º  ³  ³  ³    entra = .f.
 3135    º  ³  ³  ³    release window deuda
 3136  <ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍreturn .f.
 3137    º  ³  ³  ÀÄendif
 3138    ^ÍÍÍÍÍÍÍÍÍÍloop
 3139    º  ³  ÀÄendif
 3140    º  ³    m.porc = m.descuento /100
 3141    º  ³    m.montop = m.saldo * m.porc
 3142    º  ÀÄendif
 3143    º    @ 08, 26 get m.montop picture '99,999,999.99'
 3144    º    @ 08, 50 get m.cobrador picture '@!' valid mcobrad(m.cobrador)
 3145    º    read
 3146    º  ÚÄif lastkey() = 27
 3147    º  ³    p = salida()
 3148    º  ³  ÚÄif p = 2
 3149    º  ³  ³    entra = .f.
 3150    º  ³  ³    release window deuda
 3151  <ÍÍÍÍÍÍÍÍÍÍÍÍreturn .f.
 3152    º  ³  ÀÄendif
 3153    ^ÍÍÍÍÍÍÍloop
 3154    º  ÀÄendif
 3155    º  ÚÄif m.descuento > 0
 3156    º  ³    m.porc = m.descuento /100
 3157    º  ³    nuevosaldo = m.saldo * m.porc
 3158    º  ³  ÚÄif m.montop <= 0 .or. m.montop > nuevosaldo
 3159    º  ³  ³    = msgerro('El Monto a Pagar por Concepto de Mensualidad es invalido, verifique')
 3160    ^ÍÍÍÍÍÍÍÍÍÍloop
 3161    º  ³  ÀÄendif
 3162    º  ³  ÚÄif nuevosaldo > m.montop
 3163    º  ³  ³    = msgerro('El Monto a cancelar es invalido, no se permite abonos para esta modalidad')
 3164    ^ÍÍÍÍÍÍÍÍÍÍloop
 3165    º  ³  ÀÄendif
 3166    º  ÃÄelse
 3167    º  ³  ÚÄif m.montop = 0 .or. m.montop > m.saldo
 3168    º  ³  ³    = msgerro('El Monto a Pagar por Concepto de Mensualidad es invalido, verifique')
 3169    ^ÍÍÍÍÍÍÍÍÍÍloop
 3170    º  ³  ÀÄendif
 3171    º  ÀÄendif
 3172    º    select cobrador
 3173    º  ÚÄif  .not. seek(m.cobrador)
 3174    º  ³    m.cobrador = boxfield('cobrador','codigo')
 3175    º  ÀÄendif
 3176    º    select 14
 3177    º    @ 08, 50 say m.cobrador picture '@!' color w+/w
 3178    º    @ 08, col() + 2 say left(nombres, 20)
 3179    º    mnomcob = alltrim(nombres)
 3180    º    opc = acepta('Esta correcto este Monto a Cancelar')
 3181    º  ÚÄif opc = 2
 3182    ^ÍÍÍÍÍÍÍloop
 3183    º  ÀÄendif
 3184    vÍÍÍÍexit
 3185    ÈÍenddo
 3186    ÚÄif m.descuento > 0
 3187    ³    m.porc = m.descuento / 100
 3188    ³    nuevosaldo = (m.saldo * m.porc) - m.montop
 3189    ÃÄelse
 3190    ³    nuevosaldo = m.saldo - m.montop
 3191    ÀÄendif
 3192      opce = acepta('Proceso este Pago de Mensualidad')
 3193    ÚÄif opce = 2
 3194    ³    release window deuda
 3195  <ÍÍÍÍÍÍreturn .f.
 3196    ÀÄendif
 3197      mrecibo = 0
 3198      select 18
 3199      p = printer()
 3200    ÚÄif p = 2
 3201    ³    select 13
 3202    ³  ÉÍdo while .t.
 3203    ³  º  ÚÄif rlock()
 3204    ³  º  ³    replace recibo with recibo + 1
 3205    ³  º  ³    mrecibo = recibo
 3206    ³  º  ³    unlock
 3207    ³  vÍÍÍÍÍÍÍexit
 3208    ³  º  ÀÄendif
 3209    ³  ÈÍenddo
 3210    ³    select 18
 3211    ³    wait window 'Nro. del Recibo Generado: ' + ltrim(str(mrecibo)) + chr(13) + 'Presione Cualquier Tecla para continuar..'
 3212    ÃÄelse
 3213    ³    select 13
 3214    ³  ÉÍdo while .t.
 3215    ³  º  ÚÄif rlock()
 3216    ³  º  ³    replace recibo with recibo + 1
 3217    ³  º  ³    mrecibo = recibo
 3218    ³  º  ³    unlock
 3219    ³  vÍÍÍÍÍÍÍexit
 3220    ³  º  ÀÄendif
 3221    ³  ÈÍenddo
 3222    ³    select 18
 3223    ³    set device to printer
 3224    ³    @ 0, 1 say '  ' + chr(27) + chr(67) + chr(33)
 3225    ³    @ 00, 00 say chr(18) + chr(20)
 3226    ³    @ 00, 00 say chr(14) + chr(15) + titulo + chr(18) + chr(20) + ' '
 3227    ³    @ 01, 00 say 'RIF .                                                   RECIBO Nro.:          '
 3228    ³    @ 01, 04 say l_rif
 3229    ³    @ 01, 68 say chr(14) + ng +  ;
 3230    ³        ltrim(str(mrecibo)) + ngn
 3231    ³    @ 02, 00 say chr(15) + ' '
 3232    ³    @ 02, 00 say l_direccio
 3233    ³    @ 02, pcol() say chr(18) +  ;
 3234    ³        chr(20) + ' '
 3235    ³    @ 02, 00 say  ;
 3236    ³        '                                                        FECHA PAGO:          '
 3237    ³    @ 02, 68 say m.fechap  ;
 3238    ³        picture '@E'
 3239    ³    @ 03, 00 say  ;
 3240    ³        '                                                      '
 3241    ³    @ 03, 28 say chr(14) +  ;
 3242    ³        chr(15) + 'RECIBO DE PAGO' +  ;
 3243    ³        chr(18) + chr(20) + ' '
 3244    ³    @ 04, 00 say  ;
 3245    ³        '                                                      ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ» '
 3246    ³    @ 05, 00 say  ;
 3247    ³        'C.I.:                                                 º Bs.                º '
 3248    ³    @ 05, 61 say m.montop  ;
 3249    ³        picture '9,999,999.99'
 3250    ³    @ 05, 06 say m.cedula  ;
 3251    ³        picture '!-99999999'
 3252    ³    @ 06, 00 say  ;
 3253    ³        'ALUMNO:                                               ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼ '
 3254    ³    @ 06, 08 say m.nombres  ;
 3255    ³        picture '@!s45'
 3256    ³    xcantidad = letras(m.montop)
 3257    ³    xcantidad = alltrim(xcantidad)
 3258    ³    @ 08, 00 say  ;
 3259    ³        'Hemos recibido la cantidad de:'
 3260    ³    @ 10, 00 say xcantidad  ;
 3261    ³        picture '@!'
 3262    ³    li = 11
 3263    ³    @ li, 00 say  ;
 3264    ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ' +  ;
 3265    ³        ng
 3266    ³    li = li + 1
 3267    ³    @ li, 00 say  ;
 3268    ³        '  C O N C E P T O S                                          M O N T O       ' +  ;
 3269    ³        ngn
 3270    ³    li = li + 1
 3271    ³    @ li, 00 say  ;
 3272    ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ'
 3273    ³    li = li + 1
 3274    ³    select 7
 3275    ³    set order to cedula
 3276    ³    seek (m.cedula)
 3277    ³    @ li, 00 say concepto1
 3278    ³    li = li + 1
 3279    ³    @ li, 00 say concepto2
 3280    ³    li = li + 1
 3281    ³    @ li, 00 say concepto3
 3282    ³    li = li + 1
 3283    ³    @ li, 00 say concepto4
 3284    ³    li = li + 1
 3285    ³    @ li, 00 say concepto5
 3286    ³    li = li + 1
 3287    ³    @ 21, 00 say  ;
 3288    ³        'ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»'
 3289    ³    @ 22, 00 say  ;
 3290    ³        'º            N O T A            º  EFECTIVO   [ ]   CHEQ/DEPOST [ ]           º'
 3291    ³  ÚÄif m.tipop <> 'Efectivo'
 3292    ³  ³    @ 22, 65 say 'X'
 3293    ³  ÃÄelse
 3294    ³  ³    @ 22, 47 say 'X'
 3295    ³  ÀÄendif
 3296    ³    @ 23, 00 say  ;
 3297    ³        'ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶  NRO. :                                     º'
 3298    ³    @ 23, 41 say m.nrode picture  ;
 3299    ³        '@!'
 3300    ³    @ 24, 00 say  ;
 3301    ³        'º                               º  BANCO:                                     º'
 3302    ³    @ 24, 41 say m.desban
 3303    ³    @ 25, 00 say  ;
 3304    ³        'º                               º                                             º'
 3305    ³    @ 26, 00 say  ;
 3306    ³        'º                               º                        ___________________  º'
 3307    ³    @ 27, 00 say  ;
 3308    ³        'º                               º                           RECIBIDO POR:     º'
 3309    ³    @ 28, 00 say  ;
 3310    ³        'ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼'
 3311    ³    @ 29, 00 say  ;
 3312    ³        ' NOTA: Los Pagos Realizados no estan sujetos a devoluciones'
 3313    ³    @ 30, 00 say ' '
 3314    ³    eject
 3315    ³    set device to screen
 3316    ÀÄendif
 3317      select 9
 3318    ÉÍdo while .t.
 3319    º  ÚÄif flock()
 3320    º  ³    append blank
 3321    º  ³    replace recibo with  ;
 3322    º  ³        mrecibo, cedula  ;
 3323    º  ³        with m.cedula
 3324    º  ³    replace curso with  ;
 3325    º  ³        m.curso,  ;
 3326    º  ³        plancobro with  ;
 3327    º  ³        m.plancobro
 3328    º  ³    replace seccion with  ;
 3329    º  ³        m.semestre,  ;
 3330    º  ³        fecha_pago with  ;
 3331    º  ³        m.fechap
 3332    º  ³    replace nrocuota with 0,  ;
 3333    º  ³        tipo_pago with  ;
 3334    º  ³        m.tipop,  ;
 3335    º  ³        nro_depo with  ;
 3336    º  ³        m.nrode
 3337    º  ³    replace cod_banco with  ;
 3338    º  ³        m.banco, monto  ;
 3339    º  ³        with m.montop,  ;
 3340    º  ³        transa with  ;
 3341    º  ³        'AT'
 3342    º  ³    replace cobrador with  ;
 3343    º  ³        m.cobrador
 3344    º  ³    replace lapso with  ;
 3345    º  ³        lapmat
 3346    º  ³    unlock
 3347    vÍÍÍÍÍÍÍexit
 3348    º  ÀÄendif
 3349    ÈÍenddo
 3350      select 7
 3351    ÉÍdo while .t.
 3352    º  ÚÄif rlock()
 3353    º  ³    replace monto_p with  ;
 3354    º  ³        monto_p +  ;
 3355    º  ³        m.montop
 3356    º  ³    replace descto with  ;
 3357    º  ³        m.descuento
 3358    º  ³    unlock
 3359    vÍÍÍÍÍÍÍexit
 3360    º  ÀÄendif
 3361    ÈÍenddo
 3362      release window deuda
 3363      return iif(nuevosaldo = 0, .t.,  ;
 3364          .f.)
 3365      *
 3382  *!*****************************************************************************
 3383  *!
 3384  *!      Procedure: REPITE_REC
 3385  *!
 3386  *!          Calls: PRINTER()          (function  in ?)
 3387  *!               : RLOCK()            (function  in ?)
 3388  *!               : LTRIM()            (function  in ?)
 3389  *!               : STR()              (function  in ?)
 3390  *!               : CHR()              (function  in ?)
 3391  *!               : PCOL()             (function  in ?)
 3392  *!               : LETRAS()           (function  in ?)
 3393  *!               : ALLTRIM()          (function  in ?)
 3394  *!               : SPACE()            (function  in ?)
 3395  *!               : SEEK()             (function  in ?)
 3396  *!
 3397  *!*****************************************************************************
 3382      procedure repite_rec
 3383      set device to screen
 3384      mrecibo = 0
 3385      lin1 = 0
 3386      lin2 = 0
 3387      lin3 = 0
 3388      tu = 0
 3389      select 2
 3390      p = printer()
 3391    ÚÄif p = 2
 3392    ³    select 13
 3393    ³  ÉÍdo while .t.
 3394    ³  º  ÚÄif rlock()
 3395    ³  º  ³    mrecibo = recibo
 3396    ³  º  ³    unlock
 3397    ³  vÍÍÍÍÍÍÍexit
 3398    ³  º  ÀÄendif
 3399    ³  ÈÍenddo
 3400    ³    select 2
 3401    ³    wait window  ;
 3402    ³        'Nro. del Recibo Generado: ' +  ;
 3403    ³        ltrim(str(mrecibo)) +  ;
 3404    ³        chr(13) +  ;
 3405    ³        'Presione Cualquier Tecla para continuar..'
 3406    ÃÄelse
 3407    ³    select 13
 3408    ³  ÉÍdo while .t.
 3409    ³  º  ÚÄif rlock()
 3410    ³  º  ³    mrecibo = recibo
 3411    ³  º  ³    unlock
 3412    ³  vÍÍÍÍÍÍÍexit
 3413    ³  º  ÀÄendif
 3414    ³  ÈÍenddo
 3415    ³    select 2
 3416    ³    set device to printer
 3417    ³    @ 0, 1 say '  ' + chr(27) +  ;
 3418    ³        chr(67) + chr(33)
 3419    ³    @ 00, 00 say chr(18) +  ;
 3420    ³        chr(20)
 3421    ³    @ 00, 00 say chr(14) +  ;
 3422    ³        chr(15) + titulo + chr(18) +  ;
 3423    ³        chr(20) + ' '
 3424    ³    @ 01, 00 say  ;
 3425    ³        'RIF                                                     RECIBO Nro.:          '
 3426    ³    @ 01, 04 say l_rif
 3427    ³    @ 01, 68 say chr(14) + ng +  ;
 3428    ³        ltrim(str(mrecibo)) + ngn
 3429    ³    @ 02, 00 say chr(15) + ' '
 3430    ³    @ 02, 00 say l_direccio
 3431    ³    @ 02, pcol() say chr(18) +  ;
 3432    ³        chr(20) + ' '
 3433    ³    @ 02, 00 say  ;
 3434    ³        '                                                        FECHA PAGO :          '
 3435    ³    @ 02, 68 say mfechap picture  ;
 3436    ³        '@E'
 3437    ³    @ 03, 00 say  ;
 3438    ³        '                                                      '
 3439    ³    @ 03, 28 say chr(14) +  ;
 3440    ³        chr(15) + 'RECIBO DE PAGO' +  ;
 3441    ³        chr(18) + chr(20) + ' '
 3442    ³    @ 04, 00 say  ;
 3443    ³        '                                                      ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ» '
 3444    ³    @ 05, 00 say  ;
 3445    ³        'C.I.:                                                 º Bs.                º '
 3446    ³    @ 05, 61 say mmontop picture  ;
 3447    ³        '9,999,999.99'
 3448    ³    @ 05, 06 say m.cedula  ;
 3449    ³        picture '!-99999999'
 3450    ³    @ 06, 00 say  ;
 3451    ³        'ALUMNO:                                               ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼ '
 3452    ³    @ 06, 08 say m.nombres  ;
 3453    ³        picture '@!s45'
 3454    ³    @ 07, 00 say 'SEMESTRE: ' +  ;
 3455    ³        m.semestre
 3456    ³    @ 08, 00 say 'TURNO   : ' +  ;
 3457    ³        m.turno
 3458    ³    xcantidad = letras(mmontop)
 3459    ³    xcantidad = alltrim(xcantidad)
 3460    ³    @ 09, 00 say  ;
 3461    ³        'Hemos recibido la cantidad de:'
 3462    ³    @ 10, 00 say xcantidad  ;
 3463    ³        picture '@!'
 3464    ³    li = 11
 3465    ³    @ li, 00 say  ;
 3466    ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ' +  ;
 3467    ³        ng
 3468    ³    li = li + 1
 3469    ³    @ li, 00 say  ;
 3470    ³        '  C O N C E P T O S                   S A L D O              M O N T O       ' +  ;
 3471    ³        ngn
 3472    ³    li = li + 1
 3473    ³    @ li, 00 say  ;
 3474    ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ'
 3475    ³    mpagado = mmontop
 3476    ³    ii = 1
 3477    ³    li = li + 1
 3478    ³    xsaldo = 0
 3479    ³  ÖÄfor ii = 1 to 12
 3480    ³  º    lk = ltrim(str(ii))
 3481    ³  º  ÚÄif pagado&lk=cuota&lk
 3482    ³  ^ÍÍÍÍÍÍÍloop
 3483    ³  º  ÀÄendif
 3484    ³  º  ÚÄif (mpagado+pagado&lk) >= m.cuota&lk
 3485    ³  º  ³    select 11
 3486    ³  º  ³    set order to codcuota
 3487    ³  º  ³    locate for lapso =  ;
 3488    ³  º  ³        lapmat  ;
 3489    ³  º  ³        .and.  ;
 3490    ³  º  ³        codigo =  ;
 3491    ³  º  ³        m.plancobro  ;
 3492    ³  º  ³        .and. cuota =  ;
 3493    ³  º  ³        ii
 3494    ³  º  ³    xpagado=(m.cuota&lk-pagado&lk)
 3495    ³  º  ³    mpagado=mpagado-(m.cuota&lk-pagado&lk)
 3496    ³  º  ³  ÖÄfor ww = 1 to 10
 3497    ³  º  ³  º    lw = ltrim(str(ww))
 3498    ³  º  ³  º    select 11
 3499    ³  º  ³  º  ÚÄif concepto&lw=space(2)
 3500    ³  º  ³  ^ÍÍÍÍÍÍÍloop
 3501    ³  º  ³  º  ÀÄendif
 3502    ³  º  ³  º    mcon=concepto&lw
 3503    ³  º  ³  º    mmon=monto&lw
 3504    ³  º  ³  º    select 12
 3505    ³  º  ³  º  ÚÄif  .not.  ;
 3506    ³  º  ³  º  ³        seek(mcon)
 3507    ³  º  ³  º  ³    mds = 'SIN DESCRIPCION'
 3508    ³  º  ³  º  ÃÄelse
 3509    ³  º  ³  º  ³    mds = alltrim(descripcio)
 3510    ³  º  ³  º  ÀÄendif
 3511    ³  º  ³  º  ÚÄif mdec1 >= 1  ;
 3512    ³  º  ³  º  ³        .and. lin1 =  ;
 3513    ³  º  ³  º  ³        0 .and. ww =  ;
 3514    ³  º  ³  º  ³        1
 3515    ³  º  ³  º  ³    @ li, 00  ;
 3516    ³  º  ³  º  ³        say  ;
 3517    ³  º  ³  º  ³        'CANCELACION MENSUALIDAD:'
 3518    ³  º  ³  º  ³    lin1 = 1
 3519    ³  º  ³  º  ³    li = li +  ;
 3520    ³  º  ³  º  ³        1
 3521    ³  º  ³  º  ÀÄendif
 3522    ³  º  ³  º  ÚÄif mdec1 >= 1  ;
 3523    ³  º  ³  º  ³        .and.  ;
 3524    ³  º  ³  º  ³        mdec2 >= 1  ;
 3525    ³  º  ³  º  ³        .and. lin2 =  ;
 3526    ³  º  ³  º  ³        1 .and. ww =  ;
 3527    ³  º  ³  º  ³        1
 3528    ³  º  ³  º  ³    @ li, 00  ;
 3529    ³  º  ³  º  ³        say  ;
 3530    ³  º  ³  º  ³        'ABONO MENSUALIDAD:'
 3531    ³  º  ³  º  ³    lin2 = 0
 3532    ³  º  ³  º  ³    li = li +  ;
 3533    ³  º  ³  º  ³        1
 3534    ³  º  ³  º  ÀÄendif
 3535    ³  º  ³  º  ÚÄif mdec1 = 0  ;
 3536    ³  º  ³  º  ³        .and.  ;
 3537    ³  º  ³  º  ³        mdec2 >= 1  ;
 3538    ³  º  ³  º  ³        .and. lin3 =  ;
 3539    ³  º  ³  º  ³        0 .and. ww =  ;
 3540    ³  º  ³  º  ³        1
 3541    ³  º  ³  º  ³    @ li, 00  ;
 3542    ³  º  ³  º  ³        say  ;
 3543    ³  º  ³  º  ³        'ABONO MENSUALIDAD:'
 3544    ³  º  ³  º  ³    li = li +  ;
 3545    ³  º  ³  º  ³        1
 3546    ³  º  ³  º  ³    lin3 = 1
 3547    ³  º  ³  º  ÀÄendif
 3548    ³  º  ³  º  ÚÄif ww = 1
 3549    ³  º  ³  º  ³    @ li, 02  ;
 3550    ³  º  ³  º  ³        say  ;
 3551    ³  º  ³  º  ³        mds  ;
 3552    ³  º  ³  º  ³        picture  ;
 3553    ³  º  ³  º  ³        '@!S32'
 3554    ³  º  ³  º  ³    tu = tu +  ;
 3555    ³  º  ³  º  ³        1
 3556    ³  º  ³  º  ÃÄelse
 3557    ³  º  ³  º  ³    @ li, 05  ;
 3558    ³  º  ³  º  ³        say  ;
 3559    ³  º  ³  º  ³        mds  ;
 3560    ³  º  ³  º  ³        picture  ;
 3561    ³  º  ³  º  ³        '@!S29'
 3562    ³  º  ³  º  ÀÄendif
 3563    ³  º  ³  º  ÚÄif mpsaldo&lk > 0;
 3564    ³  º  ³  º  ³        and ww=1
 3565    ³  º  ³  º  ³    @ li, 36  ;
 3566    ³  º  ³  º  ³        say  ;
 3567    ³  º  ³  º  ³        '('
 3568    ³  º  ³  º  ³    @li,38 say mpsaldo&lk;
 3569    ³  º  ³  º  ³        pict '9,999,999.99'
 3570    ³  º  ³  º  ³    @ li, 51  ;
 3571    ³  º  ³  º  ³        say  ;
 3572    ³  º  ³  º  ³        ')'
 3573    ³  º  ³  º  ÀÄendif
 3574    ³  º  ³  º  ÚÄif ww = 1
 3575    ³  º  ³  º  ³    select 2
 3576    ³  º  ³  º  ³    @li,58 say mpagrec&lk;
 3577    ³  º  ³  º  ³        pict '9,999,999.99'
 3578    ³  º  ³  º  ³    imp&lk=1
 3579    ³  º  ³  º  ÀÄendif
 3580    ³  º  ³  º  ÚÄif mdec2 >= 1  ;
 3581    ³  º  ³  º  ³        .and. tu =  ;
 3582    ³  º  ³  º  ³        mdec1  ;
 3583    ³  º  ³  º  ³        .and. ww =  ;
 3584    ³  º  ³  º  ³        1
 3585    ³  º  ³  º  ³    lin2 = 1
 3586    ³  º  ³  º  ÀÄendif
 3587    ³  º  ³  º    li = li + 1
 3588    ³  º  ³  º  ÚÄif li > 20
 3589    ³  º  ³  º  ³    @ 22, 00  ;
 3590    ³  º  ³  º  ³        say  ;
 3591    ³  º  ³  º  ³        'ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»'
 3592    ³  º  ³  º  ³    @ 23, 00  ;
 3593    ³  º  ³  º  ³        say  ;
 3594    ³  º  ³  º  ³        'º            N O T A            º  EFECTIVO   [ ]   CHEQ/DEPOST [ ]           º'
 3595    ³  º  ³  º  ³  ÚÄif mtipop <>  ;
 3596    ³  º  ³  º  ³  ³        'Efectivo'
 3597    ³  º  ³  º  ³  ³    @ 23,  ;
 3598    ³  º  ³  º  ³  ³        65  ;
 3599    ³  º  ³  º  ³  ³        say  ;
 3600    ³  º  ³  º  ³  ³        'X'
 3601    ³  º  ³  º  ³  ÃÄelse
 3602    ³  º  ³  º  ³  ³    @ 23,  ;
 3603    ³  º  ³  º  ³  ³        47  ;
 3604    ³  º  ³  º  ³  ³        say  ;
 3605    ³  º  ³  º  ³  ³        'X'
 3606    ³  º  ³  º  ³  ÀÄendif
 3607    ³  º  ³  º  ³    @ 24, 00  ;
 3608    ³  º  ³  º  ³        say  ;
 3609    ³  º  ³  º  ³        'ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶  NRO. :                                     º'
 3610    ³  º  ³  º  ³    @ 24, 41  ;
 3611    ³  º  ³  º  ³        say  ;
 3612    ³  º  ³  º  ³        mnrode  ;
 3613    ³  º  ³  º  ³        picture  ;
 3614    ³  º  ³  º  ³        '@!'
 3615    ³  º  ³  º  ³    @ 25, 00  ;
 3616    ³  º  ³  º  ³        say  ;
 3617    ³  º  ³  º  ³        'º                               º  BANCO:                                     º'
 3618    ³  º  ³  º  ³    @ 25, 41  ;
 3619    ³  º  ³  º  ³        say  ;
 3620    ³  º  ³  º  ³        mbandes
 3621    ³  º  ³  º  ³    @ 26, 00  ;
 3622    ³  º  ³  º  ³        say  ;
 3623    ³  º  ³  º  ³        'º                               º                                             º'
 3624    ³  º  ³  º  ³    @ 26, 05  ;
 3625    ³  º  ³  º  ³        say  ;
 3626    ³  º  ³  º  ³        'CONTINUA ....'
 3627    ³  º  ³  º  ³    @ 27, 00  ;
 3628    ³  º  ³  º  ³        say  ;
 3629    ³  º  ³  º  ³        'º                               º                        ___________________  º'
 3630    ³  º  ³  º  ³    @ 28, 00  ;
 3631    ³  º  ³  º  ³        say  ;
 3632    ³  º  ³  º  ³        'º                               º                           RECIBIDO POR:     º'
 3633    ³  º  ³  º  ³    @ 29, 00  ;
 3634    ³  º  ³  º  ³        say  ;
 3635    ³  º  ³  º  ³        'ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼'
 3636    ³  º  ³  º  ³    @ 30, 00  ;
 3637    ³  º  ³  º  ³        say  ;
 3638    ³  º  ³  º  ³        ' NOTA: Los Pagos Realizados no estan sujetos a devoluciones'
 3639    ³  º  ³  º  ³    select 9
 3640    ³  º  ³  º  ³    @ 0, 1  ;
 3641    ³  º  ³  º  ³        say  ;
 3642    ³  º  ³  º  ³        '  ' +  ;
 3643    ³  º  ³  º  ³        chr(27) +  ;
 3644    ³  º  ³  º  ³        chr(67) +  ;
 3645    ³  º  ³  º  ³        chr(33)
 3646    ³  º  ³  º  ³    @ 00, 00  ;
 3647    ³  º  ³  º  ³        say  ;
 3648    ³  º  ³  º  ³        chr(18) +  ;
 3649    ³  º  ³  º  ³        chr(20)
 3650    ³  º  ³  º  ³    @ 00, 00  ;
 3651    ³  º  ³  º  ³        say  ;
 3652    ³  º  ³  º  ³        chr(14) +  ;
 3653    ³  º  ³  º  ³        chr(15) +  ;
 3654    ³  º  ³  º  ³        titulo +  ;
 3655    ³  º  ³  º  ³        chr(18) +  ;
 3656    ³  º  ³  º  ³        chr(20) +  ;
 3657    ³  º  ³  º  ³        ' '
 3658    ³  º  ³  º  ³    @ 01, 00  ;
 3659    ³  º  ³  º  ³        say  ;
 3660    ³  º  ³  º  ³        'RIF .                                                   RECIBO Nro.:          '
 3661    ³  º  ³  º  ³    @ 01, 04  ;
 3662    ³  º  ³  º  ³        say  ;
 3663    ³  º  ³  º  ³        l_rif
 3664    ³  º  ³  º  ³    @ 01, 68  ;
 3665    ³  º  ³  º  ³        say  ;
 3666    ³  º  ³  º  ³        chr(14) +  ;
 3667    ³  º  ³  º  ³        ng +  ;
 3668    ³  º  ³  º  ³        ltrim(str(mrecibo)) +  ;
 3669    ³  º  ³  º  ³        ngn
 3670    ³  º  ³  º  ³    @ 02, 00  ;
 3671    ³  º  ³  º  ³        say  ;
 3672    ³  º  ³  º  ³        chr(15) +  ;
 3673    ³  º  ³  º  ³        ' '
 3674    ³  º  ³  º  ³    @ 02, 00  ;
 3675    ³  º  ³  º  ³        say  ;
 3676    ³  º  ³  º  ³        l_direccio
 3677    ³  º  ³  º  ³    @ 02,  ;
 3678    ³  º  ³  º  ³        pcol()  ;
 3679    ³  º  ³  º  ³        say  ;
 3680    ³  º  ³  º  ³        chr(18) +  ;
 3681    ³  º  ³  º  ³        chr(20) +  ;
 3682    ³  º  ³  º  ³        ' '
 3683    ³  º  ³  º  ³    @ 02, 00  ;
 3684    ³  º  ³  º  ³        say  ;
 3685    ³  º  ³  º  ³        '                                                        FECHA PAGO:          '
 3686    ³  º  ³  º  ³    @ 02, 68  ;
 3687    ³  º  ³  º  ³        say  ;
 3688    ³  º  ³  º  ³        mfechap  ;
 3689    ³  º  ³  º  ³        picture  ;
 3690    ³  º  ³  º  ³        '@E'
 3691    ³  º  ³  º  ³    @ 03, 00  ;
 3692    ³  º  ³  º  ³        say  ;
 3693    ³  º  ³  º  ³        '                                                      '
 3694    ³  º  ³  º  ³    @ 03, 28  ;
 3695    ³  º  ³  º  ³        say  ;
 3696    ³  º  ³  º  ³        chr(14) +  ;
 3697    ³  º  ³  º  ³        chr(15) +  ;
 3698    ³  º  ³  º  ³        'RECIBO DE PAGO' +  ;
 3699    ³  º  ³  º  ³        chr(18) +  ;
 3700    ³  º  ³  º  ³        chr(20) +  ;
 3701    ³  º  ³  º  ³        ' '
 3702    ³  º  ³  º  ³    @ 04, 00  ;
 3703    ³  º  ³  º  ³        say  ;
 3704    ³  º  ³  º  ³        '                                                      ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ» '
 3705    ³  º  ³  º  ³    @ 05, 00  ;
 3706    ³  º  ³  º  ³        say  ;
 3707    ³  º  ³  º  ³        'C.I.:                                                 º Bs.                º '
 3708    ³  º  ³  º  ³    @ 05, 61  ;
 3709    ³  º  ³  º  ³        say  ;
 3710    ³  º  ³  º  ³        mmontop  ;
 3711    ³  º  ³  º  ³        picture  ;
 3712    ³  º  ³  º  ³        '9,999,999.99'
 3713    ³  º  ³  º  ³    @ 05, 06  ;
 3714    ³  º  ³  º  ³        say  ;
 3715    ³  º  ³  º  ³        m.cedula  ;
 3716    ³  º  ³  º  ³        picture  ;
 3717    ³  º  ³  º  ³        '!-99999999'
 3718    ³  º  ³  º  ³    @ 06, 00  ;
 3719    ³  º  ³  º  ³        say  ;
 3720    ³  º  ³  º  ³        'ALUMNO:                                               ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼ '
 3721    ³  º  ³  º  ³    @ 06, 08  ;
 3722    ³  º  ³  º  ³        say  ;
 3723    ³  º  ³  º  ³        m.nombres  ;
 3724    ³  º  ³  º  ³        picture  ;
 3725    ³  º  ³  º  ³        '@!s45'
 3726    ³  º  ³  º  ³    @ 07, 00  ;
 3727    ³  º  ³  º  ³        say  ;
 3728    ³  º  ³  º  ³        'SEMESTRE: ' +  ;
 3729    ³  º  ³  º  ³        m.semestre
 3730    ³  º  ³  º  ³    @ 08, 00  ;
 3731    ³  º  ³  º  ³        say  ;
 3732    ³  º  ³  º  ³        'TURNO   : ' +  ;
 3733    ³  º  ³  º  ³        m.turno
 3734    ³  º  ³  º  ³    xcantidad =  ;
 3735    ³  º  ³  º  ³        letras(mmontop)
 3736    ³  º  ³  º  ³    xcantidad =  ;
 3737    ³  º  ³  º  ³        alltrim(xcantidad)
 3738    ³  º  ³  º  ³    @ 09, 00  ;
 3739    ³  º  ³  º  ³        say  ;
 3740    ³  º  ³  º  ³        'Hemos recibido la cantidad de:'
 3741    ³  º  ³  º  ³    @ 10, 00  ;
 3742    ³  º  ³  º  ³        say  ;
 3743    ³  º  ³  º  ³        xcantidad  ;
 3744    ³  º  ³  º  ³        picture  ;
 3745    ³  º  ³  º  ³        '@!'
 3746    ³  º  ³  º  ³    li = 11
 3747    ³  º  ³  º  ³    @ li, 00  ;
 3748    ³  º  ³  º  ³        say  ;
 3749    ³  º  ³  º  ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ' +  ;
 3750    ³  º  ³  º  ³        ng
 3751    ³  º  ³  º  ³    li = li +  ;
 3752    ³  º  ³  º  ³        1
 3753    ³  º  ³  º  ³    @ li, 00  ;
 3754    ³  º  ³  º  ³        say  ;
 3755    ³  º  ³  º  ³        '  C O N C E P T O S                   S A L D O              M O N T O       ' +  ;
 3756    ³  º  ³  º  ³        ngn
 3757    ³  º  ³  º  ³    li = li +  ;
 3758    ³  º  ³  º  ³        1
 3759    ³  º  ³  º  ³    @ li, 00  ;
 3760    ³  º  ³  º  ³        say  ;
 3761    ³  º  ³  º  ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ'
 3762    ³  º  ³  º  ³    li = li +  ;
 3763    ³  º  ³  º  ³        1
 3764    ³  º  ³  º  ÀÄendif
 3765    ³  º  ³  ÓÄendfor
 3766    ³  º  ÃÄelse
 3767    ³  º  ³  ÚÄif mpagado > 0
 3768    ³  º  ³  ³    select 11
 3769    ³  º  ³  ³    set order to codcuota
 3770    ³  º  ³  ³    locate for  ;
 3771    ³  º  ³  ³        lapso =  ;
 3772    ³  º  ³  ³        lapmat  ;
 3773    ³  º  ³  ³        .and.  ;
 3774    ³  º  ³  ³        codigo =  ;
 3775    ³  º  ³  ³        m.plancobro  ;
 3776    ³  º  ³  ³        .and.  ;
 3777    ³  º  ³  ³        cuota =  ;
 3778    ³  º  ³  ³        ii
 3779    ³  º  ³  ³    xpagado=pagado&lk+mpagado
 3780    ³  º  ³  ³  ÖÄfor ww = 1 to  ;
 3781    ³  º  ³  ³  º        10
 3782    ³  º  ³  ³  º    lw = ltrim(str(ww))
 3783    ³  º  ³  ³  º    select 11
 3784    ³  º  ³  ³  º  ÚÄif concepto&lw=space(2)
 3785    ³  º  ³  ³  ^ÍÍÍÍÍÍÍloop
 3786    ³  º  ³  ³  º  ÀÄendif
 3787    ³  º  ³  ³  º    mcon=concepto&lw
 3788    ³  º  ³  ³  º    mmon=monto&lw
 3789    ³  º  ³  ³  º    select 12
 3790    ³  º  ³  ³  º  ÚÄif  .not.  ;
 3791    ³  º  ³  ³  º  ³        seek(mcon)
 3792    ³  º  ³  ³  º  ³    mds =  ;
 3793    ³  º  ³  ³  º  ³        'SIN DESCRIPCION'
 3794    ³  º  ³  ³  º  ÃÄelse
 3795    ³  º  ³  ³  º  ³    mds =  ;
 3796    ³  º  ³  ³  º  ³        alltrim(descripcio)
 3797    ³  º  ³  ³  º  ÀÄendif
 3798    ³  º  ³  ³  º  ÚÄif mdec1 >=  ;
 3799    ³  º  ³  ³  º  ³        1  ;
 3800    ³  º  ³  ³  º  ³        .and.  ;
 3801    ³  º  ³  ³  º  ³        lin1 =  ;
 3802    ³  º  ³  ³  º  ³        0  ;
 3803    ³  º  ³  ³  º  ³        .and.  ;
 3804    ³  º  ³  ³  º  ³        ww =  ;
 3805    ³  º  ³  ³  º  ³        1
 3806    ³  º  ³  ³  º  ³    @ li,  ;
 3807    ³  º  ³  ³  º  ³        00  ;
 3808    ³  º  ³  ³  º  ³        say  ;
 3809    ³  º  ³  ³  º  ³        'CANCELACION MENSUALIDAD:'
 3810    ³  º  ³  ³  º  ³    lin1 =  ;
 3811    ³  º  ³  ³  º  ³        1
 3812    ³  º  ³  ³  º  ³    li =  ;
 3813    ³  º  ³  ³  º  ³        li +  ;
 3814    ³  º  ³  ³  º  ³        1
 3815    ³  º  ³  ³  º  ÀÄendif
 3816    ³  º  ³  ³  º  ÚÄif mdec1 >=  ;
 3817    ³  º  ³  ³  º  ³        1  ;
 3818    ³  º  ³  ³  º  ³        .and.  ;
 3819    ³  º  ³  ³  º  ³        mdec2 >=  ;
 3820    ³  º  ³  ³  º  ³        1  ;
 3821    ³  º  ³  ³  º  ³        .and.  ;
 3822    ³  º  ³  ³  º  ³        lin2 =  ;
 3823    ³  º  ³  ³  º  ³        1  ;
 3824    ³  º  ³  ³  º  ³        .and.  ;
 3825    ³  º  ³  ³  º  ³        ww =  ;
 3826    ³  º  ³  ³  º  ³        1
 3827    ³  º  ³  ³  º  ³    @ li,  ;
 3828    ³  º  ³  ³  º  ³        00  ;
 3829    ³  º  ³  ³  º  ³        say  ;
 3830    ³  º  ³  ³  º  ³        'ABONO MENSUALIDAD:'
 3831    ³  º  ³  ³  º  ³    lin2 =  ;
 3832    ³  º  ³  ³  º  ³        0
 3833    ³  º  ³  ³  º  ³    li =  ;
 3834    ³  º  ³  ³  º  ³        li +  ;
 3835    ³  º  ³  ³  º  ³        1
 3836    ³  º  ³  ³  º  ÀÄendif
 3837    ³  º  ³  ³  º  ÚÄif mdec1 =  ;
 3838    ³  º  ³  ³  º  ³        0  ;
 3839    ³  º  ³  ³  º  ³        .and.  ;
 3840    ³  º  ³  ³  º  ³        mdec2 >=  ;
 3841    ³  º  ³  ³  º  ³        1  ;
 3842    ³  º  ³  ³  º  ³        .and.  ;
 3843    ³  º  ³  ³  º  ³        lin3 =  ;
 3844    ³  º  ³  ³  º  ³        0  ;
 3845    ³  º  ³  ³  º  ³        .and.  ;
 3846    ³  º  ³  ³  º  ³        ww =  ;
 3847    ³  º  ³  ³  º  ³        1
 3848    ³  º  ³  ³  º  ³    @ li,  ;
 3849    ³  º  ³  ³  º  ³        00  ;
 3850    ³  º  ³  ³  º  ³        say  ;
 3851    ³  º  ³  ³  º  ³        'ABONO MENSUALIDAD:'
 3852    ³  º  ³  ³  º  ³    li =  ;
 3853    ³  º  ³  ³  º  ³        li +  ;
 3854    ³  º  ³  ³  º  ³        1
 3855    ³  º  ³  ³  º  ³    lin3 =  ;
 3856    ³  º  ³  ³  º  ³        1
 3857    ³  º  ³  ³  º  ÀÄendif
 3858    ³  º  ³  ³  º  ÚÄif ww =  ;
 3859    ³  º  ³  ³  º  ³        1
 3860    ³  º  ³  ³  º  ³    @ li,  ;
 3861    ³  º  ³  ³  º  ³        02  ;
 3862    ³  º  ³  ³  º  ³        say  ;
 3863    ³  º  ³  ³  º  ³        mds  ;
 3864    ³  º  ³  ³  º  ³        picture  ;
 3865    ³  º  ³  ³  º  ³        '@!S32'
 3866    ³  º  ³  ³  º  ³    tu =  ;
 3867    ³  º  ³  ³  º  ³        tu +  ;
 3868    ³  º  ³  ³  º  ³        1
 3869    ³  º  ³  ³  º  ÃÄelse
 3870    ³  º  ³  ³  º  ³    @ li,  ;
 3871    ³  º  ³  ³  º  ³        05  ;
 3872    ³  º  ³  ³  º  ³        say  ;
 3873    ³  º  ³  ³  º  ³        mds  ;
 3874    ³  º  ³  ³  º  ³        picture  ;
 3875    ³  º  ³  ³  º  ³        '@!S29'
 3876    ³  º  ³  ³  º  ÀÄendif
 3877    ³  º  ³  ³  º    select 2
 3878    ³  º  ³  ³  º  ÚÄif mpsaldo&lk;
 3879    ³  º  ³  ³  º  ³        > 0 and ww=1
 3880    ³  º  ³  ³  º  ³    @ li,  ;
 3881    ³  º  ³  ³  º  ³        36  ;
 3882    ³  º  ³  ³  º  ³        say  ;
 3883    ³  º  ³  ³  º  ³        '('
 3884    ³  º  ³  ³  º  ³    @li,38 say;
 3885    ³  º  ³  ³  º  ³        mpsaldo&lk pict '9,999,999.99'
 3886    ³  º  ³  ³  º  ³    @ li,  ;
 3887    ³  º  ³  ³  º  ³        51  ;
 3888    ³  º  ³  ³  º  ³        say  ;
 3889    ³  º  ³  ³  º  ³        ')'
 3890    ³  º  ³  ³  º  ÀÄendif
 3891    ³  º  ³  ³  º  ÚÄif ww =  ;
 3892    ³  º  ³  ³  º  ³        1
 3893    ³  º  ³  ³  º  ³    @li,58 say;
 3894    ³  º  ³  ³  º  ³        mpagrec&lk pict '9,999,999.99'
 3895    ³  º  ³  ³  º  ÀÄendif
 3896    ³  º  ³  ³  º  ÚÄif mdec2 >=  ;
 3897    ³  º  ³  ³  º  ³        1  ;
 3898    ³  º  ³  ³  º  ³        .and.  ;
 3899    ³  º  ³  ³  º  ³        tu =  ;
 3900    ³  º  ³  ³  º  ³        mdec1  ;
 3901    ³  º  ³  ³  º  ³        .and.  ;
 3902    ³  º  ³  ³  º  ³        ww =  ;
 3903    ³  º  ³  ³  º  ³        1
 3904    ³  º  ³  ³  º  ³    lin2 =  ;
 3905    ³  º  ³  ³  º  ³        1
 3906    ³  º  ³  ³  º  ÀÄendif
 3907    ³  º  ³  ³  º    li = li +  ;
 3908    ³  º  ³  ³  º        1
 3909    ³  º  ³  ³  º  ÚÄif li >  ;
 3910    ³  º  ³  ³  º  ³        20
 3911    ³  º  ³  ³  º  ³    @ 22,  ;
 3912    ³  º  ³  ³  º  ³        00  ;
 3913    ³  º  ³  ³  º  ³        say  ;
 3914    ³  º  ³  ³  º  ³        'ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»'
 3915    ³  º  ³  ³  º  ³    @ 23,  ;
 3916    ³  º  ³  ³  º  ³        00  ;
 3917    ³  º  ³  ³  º  ³        say  ;
 3918    ³  º  ³  ³  º  ³        'º            N O T A            º  EFECTIVO   [ ]   CHEQ/DEPOST [ ]           º'
 3919    ³  º  ³  ³  º  ³  ÚÄif mtipop <>  ;
 3920    ³  º  ³  ³  º  ³  ³        'Efectivo'
 3921    ³  º  ³  ³  º  ³  ³    @ 23, 65 say 'X'
 3922    ³  º  ³  ³  º  ³  ÃÄelse
 3923    ³  º  ³  ³  º  ³  ³    @ 23, 47 say 'X'
 3924    ³  º  ³  ³  º  ³  ÀÄendif
 3925    ³  º  ³  ³  º  ³    @ 24,  ;
 3926    ³  º  ³  ³  º  ³        00  ;
 3927    ³  º  ³  ³  º  ³        say  ;
 3928    ³  º  ³  ³  º  ³        'ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶  NRO. :                                     º'
 3929    ³  º  ³  ³  º  ³    @ 24,  ;
 3930    ³  º  ³  ³  º  ³        41  ;
 3931    ³  º  ³  ³  º  ³        say  ;
 3932    ³  º  ³  ³  º  ³        mnrode  ;
 3933    ³  º  ³  ³  º  ³        picture  ;
 3934    ³  º  ³  ³  º  ³        '@!'
 3935    ³  º  ³  ³  º  ³    @ 25,  ;
 3936    ³  º  ³  ³  º  ³        00  ;
 3937    ³  º  ³  ³  º  ³        say  ;
 3938    ³  º  ³  ³  º  ³        'º                               º  BANCO:                                     º'
 3939    ³  º  ³  ³  º  ³    @ 25,  ;
 3940    ³  º  ³  ³  º  ³        41  ;
 3941    ³  º  ³  ³  º  ³        say  ;
 3942    ³  º  ³  ³  º  ³        mbandes
 3943    ³  º  ³  ³  º  ³    @ 26,  ;
 3944    ³  º  ³  ³  º  ³        00  ;
 3945    ³  º  ³  ³  º  ³        say  ;
 3946    ³  º  ³  ³  º  ³        'º                               º                                             º'
 3947    ³  º  ³  ³  º  ³    @ 26,  ;
 3948    ³  º  ³  ³  º  ³        05  ;
 3949    ³  º  ³  ³  º  ³        say  ;
 3950    ³  º  ³  ³  º  ³        'CONTINUA ....'
 3951    ³  º  ³  ³  º  ³    @ 27,  ;
 3952    ³  º  ³  ³  º  ³        00  ;
 3953    ³  º  ³  ³  º  ³        say  ;
 3954    ³  º  ³  ³  º  ³        'º                               º                        ___________________  º'
 3955    ³  º  ³  ³  º  ³    @ 28,  ;
 3956    ³  º  ³  ³  º  ³        00  ;
 3957    ³  º  ³  ³  º  ³        say  ;
 3958    ³  º  ³  ³  º  ³        'º                               º                           RECIBIDO POR:     º'
 3959    ³  º  ³  ³  º  ³    @ 29,  ;
 3960    ³  º  ³  ³  º  ³        00  ;
 3961    ³  º  ³  ³  º  ³        say  ;
 3962    ³  º  ³  ³  º  ³        'ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼'
 3963    ³  º  ³  ³  º  ³    @ 30,  ;
 3964    ³  º  ³  ³  º  ³        00  ;
 3965    ³  º  ³  ³  º  ³        say  ;
 3966    ³  º  ³  ³  º  ³        ' NOTA: Los Pagos Realizados no estan sujetos a devoluciones'
 3967    ³  º  ³  ³  º  ³    select  ;
 3968    ³  º  ³  ³  º  ³        9
 3969    ³  º  ³  ³  º  ³    @ 0,  ;
 3970    ³  º  ³  ³  º  ³        1  ;
 3971    ³  º  ³  ³  º  ³        say  ;
 3972    ³  º  ³  ³  º  ³        '  ' +  ;
 3973    ³  º  ³  ³  º  ³        chr(27) +  ;
 3974    ³  º  ³  ³  º  ³        chr(67) +  ;
 3975    ³  º  ³  ³  º  ³        chr(33)
 3976    ³  º  ³  ³  º  ³    @ 00,  ;
 3977    ³  º  ³  ³  º  ³        00  ;
 3978    ³  º  ³  ³  º  ³        say  ;
 3979    ³  º  ³  ³  º  ³        chr(18) +  ;
 3980    ³  º  ³  ³  º  ³        chr(20)
 3981    ³  º  ³  ³  º  ³    @ 00,  ;
 3982    ³  º  ³  ³  º  ³        00  ;
 3983    ³  º  ³  ³  º  ³        say  ;
 3984    ³  º  ³  ³  º  ³        chr(14) +  ;
 3985    ³  º  ³  ³  º  ³        chr(15) +  ;
 3986    ³  º  ³  ³  º  ³        titulo +  ;
 3987    ³  º  ³  ³  º  ³        chr(18) +  ;
 3988    ³  º  ³  ³  º  ³        chr(20) +  ;
 3989    ³  º  ³  ³  º  ³        ' '
 3990    ³  º  ³  ³  º  ³    @ 01,  ;
 3991    ³  º  ³  ³  º  ³        00  ;
 3992    ³  º  ³  ³  º  ³        say  ;
 3993    ³  º  ³  ³  º  ³        'RIF .                                                   RECIBO Nro.:          '
 3994    ³  º  ³  ³  º  ³    @ 01,  ;
 3995    ³  º  ³  ³  º  ³        04  ;
 3996    ³  º  ³  ³  º  ³        say  ;
 3997    ³  º  ³  ³  º  ³        l_rif
 3998    ³  º  ³  ³  º  ³    @ 01,  ;
 3999    ³  º  ³  ³  º  ³        68  ;
 4000    ³  º  ³  ³  º  ³        say  ;
 4001    ³  º  ³  ³  º  ³        chr(14) +  ;
 4002    ³  º  ³  ³  º  ³        ng +  ;
 4003    ³  º  ³  ³  º  ³        ltrim(str(mrecibo)) +  ;
 4004    ³  º  ³  ³  º  ³        ngn
 4005    ³  º  ³  ³  º  ³    @ 02,  ;
 4006    ³  º  ³  ³  º  ³        00  ;
 4007    ³  º  ³  ³  º  ³        say  ;
 4008    ³  º  ³  ³  º  ³        chr(15) +  ;
 4009    ³  º  ³  ³  º  ³        ' '
 4010    ³  º  ³  ³  º  ³    @ 02,  ;
 4011    ³  º  ³  ³  º  ³        00  ;
 4012    ³  º  ³  ³  º  ³        say  ;
 4013    ³  º  ³  ³  º  ³        l_direccio
 4014    ³  º  ³  ³  º  ³    @ 02,  ;
 4015    ³  º  ³  ³  º  ³        pcol()  ;
 4016    ³  º  ³  ³  º  ³        say  ;
 4017    ³  º  ³  ³  º  ³        chr(18) +  ;
 4018    ³  º  ³  ³  º  ³        chr(20) +  ;
 4019    ³  º  ³  ³  º  ³        ' '
 4020    ³  º  ³  ³  º  ³    @ 02,  ;
 4021    ³  º  ³  ³  º  ³        00  ;
 4022    ³  º  ³  ³  º  ³        say  ;
 4023    ³  º  ³  ³  º  ³        '                                                        FECHA PAGO:          '
 4024    ³  º  ³  ³  º  ³    @ 02,  ;
 4025    ³  º  ³  ³  º  ³        68  ;
 4026    ³  º  ³  ³  º  ³        say  ;
 4027    ³  º  ³  ³  º  ³        mfechap  ;
 4028    ³  º  ³  ³  º  ³        picture  ;
 4029    ³  º  ³  ³  º  ³        '@E'
 4030    ³  º  ³  ³  º  ³    @ 03,  ;
 4031    ³  º  ³  ³  º  ³        00  ;
 4032    ³  º  ³  ³  º  ³        say  ;
 4033    ³  º  ³  ³  º  ³        '                                                      '
 4034    ³  º  ³  ³  º  ³    @ 03,  ;
 4035    ³  º  ³  ³  º  ³        28  ;
 4036    ³  º  ³  ³  º  ³        say  ;
 4037    ³  º  ³  ³  º  ³        chr(14) +  ;
 4038    ³  º  ³  ³  º  ³        chr(15) +  ;
 4039    ³  º  ³  ³  º  ³        'RECIBO DE PAGO' +  ;
 4040    ³  º  ³  ³  º  ³        chr(18) +  ;
 4041    ³  º  ³  ³  º  ³        chr(20) +  ;
 4042    ³  º  ³  ³  º  ³        ' '
 4043    ³  º  ³  ³  º  ³    @ 04,  ;
 4044    ³  º  ³  ³  º  ³        00  ;
 4045    ³  º  ³  ³  º  ³        say  ;
 4046    ³  º  ³  ³  º  ³        '                                                      ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ» '
 4047    ³  º  ³  ³  º  ³    @ 05,  ;
 4048    ³  º  ³  ³  º  ³        00  ;
 4049    ³  º  ³  ³  º  ³        say  ;
 4050    ³  º  ³  ³  º  ³        'C.I.:                                                 º Bs.                º '
 4051    ³  º  ³  ³  º  ³    @ 05,  ;
 4052    ³  º  ³  ³  º  ³        61  ;
 4053    ³  º  ³  ³  º  ³        say  ;
 4054    ³  º  ³  ³  º  ³        mmontop  ;
 4055    ³  º  ³  ³  º  ³        picture  ;
 4056    ³  º  ³  ³  º  ³        '9,999,999.99'
 4057    ³  º  ³  ³  º  ³    @ 05,  ;
 4058    ³  º  ³  ³  º  ³        06  ;
 4059    ³  º  ³  ³  º  ³        say  ;
 4060    ³  º  ³  ³  º  ³        m.cedula  ;
 4061    ³  º  ³  ³  º  ³        picture  ;
 4062    ³  º  ³  ³  º  ³        '!-99999999'
 4063    ³  º  ³  ³  º  ³    @ 06,  ;
 4064    ³  º  ³  ³  º  ³        00  ;
 4065    ³  º  ³  ³  º  ³        say  ;
 4066    ³  º  ³  ³  º  ³        'ALUMNO:                                               ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼ '
 4067    ³  º  ³  ³  º  ³    @ 06,  ;
 4068    ³  º  ³  ³  º  ³        08  ;
 4069    ³  º  ³  ³  º  ³        say  ;
 4070    ³  º  ³  ³  º  ³        m.nombres  ;
 4071    ³  º  ³  ³  º  ³        picture  ;
 4072    ³  º  ³  ³  º  ³        '@!s45'
 4073    ³  º  ³  ³  º  ³    @ 07,  ;
 4074    ³  º  ³  ³  º  ³        00  ;
 4075    ³  º  ³  ³  º  ³        say  ;
 4076    ³  º  ³  ³  º  ³        'SEMESTRE: ' +  ;
 4077    ³  º  ³  ³  º  ³        m.semestre
 4078    ³  º  ³  ³  º  ³    @ 08,  ;
 4079    ³  º  ³  ³  º  ³        00  ;
 4080    ³  º  ³  ³  º  ³        say  ;
 4081    ³  º  ³  ³  º  ³        'TURNO   : ' +  ;
 4082    ³  º  ³  ³  º  ³        m.turno
 4083    ³  º  ³  ³  º  ³    @ 08,  ;
 4084    ³  º  ³  ³  º  ³        pcol() +  ;
 4085    ³  º  ³  ³  º  ³        2  ;
 4086    ³  º  ³  ³  º  ³        say  ;
 4087    ³  º  ³  ³  º  ³        m.representa  ;
 4088    ³  º  ³  ³  º  ³        picture  ;
 4089    ³  º  ³  ³  º  ³        '@!'
 4090    ³  º  ³  ³  º  ³    xcantidad =  ;
 4091    ³  º  ³  ³  º  ³        letras(mmontop)
 4092    ³  º  ³  ³  º  ³    xcantidad =  ;
 4093    ³  º  ³  ³  º  ³        alltrim(xcantidad)
 4094    ³  º  ³  ³  º  ³    @ 09,  ;
 4095    ³  º  ³  ³  º  ³        00  ;
 4096    ³  º  ³  ³  º  ³        say  ;
 4097    ³  º  ³  ³  º  ³        'Hemos recibido la cantidad de:'
 4098    ³  º  ³  ³  º  ³    @ 10,  ;
 4099    ³  º  ³  ³  º  ³        00  ;
 4100    ³  º  ³  ³  º  ³        say  ;
 4101    ³  º  ³  ³  º  ³        xcantidad  ;
 4102    ³  º  ³  ³  º  ³        picture  ;
 4103    ³  º  ³  ³  º  ³        '@!'
 4104    ³  º  ³  ³  º  ³    li =  ;
 4105    ³  º  ³  ³  º  ³        11
 4106    ³  º  ³  ³  º  ³    @ li,  ;
 4107    ³  º  ³  ³  º  ³        00  ;
 4108    ³  º  ³  ³  º  ³        say  ;
 4109    ³  º  ³  ³  º  ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ' +  ;
 4110    ³  º  ³  ³  º  ³        ng
 4111    ³  º  ³  ³  º  ³    li =  ;
 4112    ³  º  ³  ³  º  ³        li +  ;
 4113    ³  º  ³  ³  º  ³        1
 4114    ³  º  ³  ³  º  ³    @ li,  ;
 4115    ³  º  ³  ³  º  ³        00  ;
 4116    ³  º  ³  ³  º  ³        say  ;
 4117    ³  º  ³  ³  º  ³        '  C O N C E P T O S                                          M O N T O       ' +  ;
 4118    ³  º  ³  ³  º  ³        ngn
 4119    ³  º  ³  ³  º  ³    li =  ;
 4120    ³  º  ³  ³  º  ³        li +  ;
 4121    ³  º  ³  ³  º  ³        1
 4122    ³  º  ³  ³  º  ³    @ li,  ;
 4123    ³  º  ³  ³  º  ³        00  ;
 4124    ³  º  ³  ³  º  ³        say  ;
 4125    ³  º  ³  ³  º  ³        'ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ'
 4126    ³  º  ³  ³  º  ³    li =  ;
 4127    ³  º  ³  ³  º  ³        li +  ;
 4128    ³  º  ³  ³  º  ³        1
 4129    ³  º  ³  ³  º  ÀÄendif
 4130    ³  º  ³  ³  ÓÄendfor
 4131    ³  º  ³  ÀÄendif
 4132    ³  vÍÍÍÍÍÍÍexit
 4133    ³  º  ÀÄendif
 4134    ³  ÓÄendfor
 4135    ³    @ 22, 00 say  ;
 4136    ³        'ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»'
 4137    ³    @ 23, 00 say  ;
 4138    ³        'º            N O T A            º  EFECTIVO   [ ]   CHEQ/DEPOST [ ]           º'
 4139    ³  ÚÄif mtipop <> 'Efectivo'
 4140    ³  ³    @ 23, 65 say 'X'
 4141    ³  ÃÄelse
 4142    ³  ³    @ 23, 47 say 'X'
 4143    ³  ÀÄendif
 4144    ³    @ 24, 00 say  ;
 4145    ³        'ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶  NRO. :                                     º'
 4146    ³    @ 24, 41 say mnrode picture  ;
 4147    ³        '@!'
 4148    ³    @ 25, 00 say  ;
 4149    ³        'º                               º  BANCO:                                     º'
 4150    ³    @ 25, 41 say mbandes
 4151    ³    @ 26, 00 say  ;
 4152    ³        'º                               º                                             º'
 4153    ³    @ 27, 00 say  ;
 4154    ³        'º                               º                        ___________________  º'
 4155    ³    @ 28, 00 say  ;
 4156    ³        'º                               º                           RECIBIDO POR:     º'
 4157    ³    @ 29, 00 say  ;
 4158    ³        'ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼'
 4159    ³    @ 30, 00 say  ;
 4160    ³        ' NOTA: Los Pagos Realizados no estan sujetos a devoluciones'
 4161    ³    eject
 4162    ÀÄendif
 4163      return
 4164      *
 4165      *: EOF: SCP20033.ACT
